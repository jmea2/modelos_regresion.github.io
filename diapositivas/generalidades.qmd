---
title: "Generalidades sobre Modelos de Regresión en Epidemiologia"
author: "Jorge Mario Estrada Alvarez PhD. MSc. FETP"
footer:  "[Bioestadistica III]"
#logo: "images/imagen-cursoR.png"
editor: source
format: 
  revealjs: 
    theme: slides.scss
    transition: fade
    slide-number: true
    chalkboard: true
execute:
  echo: false
  output: asis
  freeze: auto
cache: true
---

```{r}
library(rio)
library(tidyverse)
coronary <- import("datasets/coronary.rds")
```

# Motivación: ¿Por qué usar modelos de regresión en epidemiología?

# Modelos de Regresión

-   No es un paso mas o final en el análisis estadístico

-   No debería ser una receta metodológica

-   All models are wrong, but some are useful!. **George E. P. Box**

------------------------------------------------------------------------

## Utilidad: **Propósitos Primarios de los Modelos en Epidemiología:**

La regresión puede ser una herramienta poderosa para direccionar tres preguntas relevantes:

1.  Predicción (En la era de la IA)
2.  Aislar el efecto de una exposición/covariable
3.  Comprender la relaciones de múltiples exposiciones hacia un efecto (confusión - interacción - mediación)

## Modelos de Predicción

-   Los modelos de predicción se emplean para estimar el riesgo o efecto (o alguna otra medida epidemiológica).

-   Esta estimación se basa en la información proporcionada por los predictores o covariables.

**Ejemplo:** Una ecuación puede estimar el riesgo de un ataque cardíaco durante un período de 10 años, basándose en la combinación de predictores como edad, sexo, historial familiar, presión arterial, historial de tabaquismo, peso, altura, hábitos de ejercicio e historial médico.

## Modelos de Explicación

-   Estimar efecto (fuerza de asociación) de consumo cigarrillo con el cáncer gástrico bajo diferentes niveles de exposición al consumo de embutidos. En esta relación podría el consumo de embutidos actuar como confusor o modificador de efecto (Interacción).

**Diagramas DAG**

### Estimaciones (Descriptivas) en sub-poblaciones (Mas eficientemente)

-   Aplicación de Estimación de prevalencias ajustadas en subpoblaciones (VIH)

## Modelos de Regresión clasicos

-   Una variable dependiente (Nivel de medición)

-   Una o más variables independientes (Continua, categorica dicotomica, cateogica politomica)

## Modelos según la variable dependiente

| Tipo de variable dependiente | Modelo estadístico |
|----|----|
| Continua | **Regresión lineal** |
| Binaria (sí/no) | **Regresión logística** |
| Conteo (número de eventos) | **Regresión de Poisson** / Binomial Negativa |
| Tiempo hasta evento | **Modelos de supervivencia** (Cox, paramétricos) |
| Ordinal (categorías ordenadas) | **Regresión logística ordinal** |
| Nominal (categorías no ordenadas) | **Regresión logística multinomial** |

## Ejemplos en Epidemiología

::: smaller
| Tipo de variable dependiente | Modelo | Ejemplo aplicado |
|----|----|----|
| Continua | Regresión lineal | Relación entre presión arterial sistólica y edad en adultos |
| Binaria | Regresión logística | Probabilidad de tener tuberculosis según contacto previo |
| Conteo | Regresión de Poisson / Binomial Negativa | Número de casos de dengue por barrio en un mes |
| Tiempo hasta evento | Modelos de supervivencia (Cox, Weibull, etc.) | Tiempo hasta la recaída de pacientes con malaria tras el tratamiento |
| Ordinal | Regresión logística ordinal | Grado de severidad de la desnutrición infantil (leve, moderada, severa) en función de variables socioeconómicas |
| Nominal | Regresión logística multinomial | Tipo de desenlace obstétrico (parto eutócico, cesárea, parto instrumental) según factores maternos |
:::

## Los modelos como representaciones de la realidad

-   Un su forma mas simple un **modelo estadístico** es una representación matemática simplificada de un fenómeno real.\
-   El **Modelo Lineal Generalizado (GLM)** se basa en expresar la variable dependiente como función lineal de las variables independientes.\
-   La idea central es que la relación entre la variable dependiente y los predictores se asume **lineal** en los parámetros.

## Expresión matemática

Modelo Lineal generalizado simple

$$ E(Y \mid X_1, X_2, \ldots, X_i) = \beta_0 + \beta_1 X_1$$

Donde:\
- $E(Y \mid X)$: valor esperado de $Y$ dado los predictores.\
- $\beta_0$: intercepto. (donde la linea atraviesa el Eje Y)\
- $\beta_1$: coeficiente que representan el efecto de cada variable $X_1$.

## Modelo Lineal generalizado

$$ E(Y \mid X_1, X_2, \ldots, X_i) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_i X_i$$

Donde:\
- $E(Y \mid X)$: valor esperado de $Y$ dado los predictores.\
- $\beta_0$: intercepto.\
- $\beta_j$: coeficientes que representan el efecto de cada variable $X_j$.

# Relación lineal

```{r}
ggplot2::ggplot(coronary, aes(x = chol, y =sbp))+
  geom_point(size = 2)+
  theme_classic()+
  theme(text = element_text(size = 25))+
  labs(x = "Colestero mmol/L", y = "Presion sistolica (mmHg)")
```
