[
  {
    "objectID": "diapositivas/RLSM_2.html#objetivos-de-aprendizaje",
    "href": "diapositivas/RLSM_2.html#objetivos-de-aprendizaje",
    "title": "Regresion Lineal Multiple",
    "section": "Objetivos de aprendizaje",
    "text": "Objetivos de aprendizaje\nDespu√©s de este modulo, se espera que los estudiantes sean capaces de:\n\nEntender el concepto de regresi√≥n lineal simple y regresi√≥n lineal m√∫ltiple\nRealizar un an√°lisis de regresi√≥n lineal simple (ajustar el modelo)\nRealizar regresi√≥n lineal m√∫ltiple (ajuste con m√°s de un predictor)\nEvaluar el ajuste del modelo de regresi√≥n lineal (diagn√≥sticos, \\(R^2\\), residuos, supuestos)\nPresentar e interpretar los resultados del an√°lisis de regresi√≥n lineal (coeficientes, intervalos, significado)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#conjunto-de-datos-coronary.rds",
    "href": "diapositivas/RLSM_2.html#conjunto-de-datos-coronary.rds",
    "title": "Regresion Lineal Multiple",
    "section": "Conjunto de datos: coronary.rds",
    "text": "Conjunto de datos: coronary.rds\n\nUsaremos el dataset coronary.rds en formato R. üëâ Descargar coronary.rds\n\nCorresponde a un ensayo cl√≠nico hipot√©tico con informaci√≥n de caracter√≠sticas individuales, niveles de colesterol total y grupos de intervenci√≥n.\n\nContiene 200 observaciones y 9 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripci√≥n\n\n\n\n\nid\nIdentificaci√≥n del sujeto\n\n\ncad\nEstado de enfermedad coronaria (categ√≥rica: sin CAD, con CAD)\n\n\nsbp\nPresi√≥n arterial sist√≥lica (mmHg, num√©rica)\n\n\ndbp\nPresi√≥n arterial diast√≥lica (mmHg, num√©rica)\n\n\nchol\nColesterol total (mmol/L, num√©rica)\n\n\nage\nEdad en a√±os (num√©rica)\n\n\nbmi\n√çndice de masa corporal (num√©rica)\n\n\nrace\nRaza (categ√≥rica: malayo, chino, indio)\n\n\ngender\nSexo (categ√≥rica: mujer, hombre)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#regresi√≥n-lineal-multiple",
    "href": "diapositivas/RLSM_2.html#regresi√≥n-lineal-multiple",
    "title": "Regresion Lineal Multiple",
    "section": "Regresi√≥n Lineal Multiple",
    "text": "Regresi√≥n Lineal Multiple\n\nLa Regresi√≥n Lineal Multiple (RLM) modela la relaci√≥n lineal entre:\n\nUna variable dependiente num√©rica (ej. colesterol).\n\ndos o m√°s predictores (num√©ricas y categ√≥ricas).\n\n\nExpresi√≥n matem√°tica\n\\[\nE(Y \\mid X_1,X_2,X_3 \\dots X_i) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\beta_3 X_3 + \\dots \\beta_i X_i\n\\]\nDonde:\n- \\(E(Y \\mid X_i)\\): valor esperado (predicho) (promedio) de la variable dependiente dado las \\(X_i\\).\n- \\(\\beta_0\\): intercepto.\n- \\(\\beta_i\\): coeficientes de cada predictor \\(X_i\\)."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#estimaci√≥n-por-m√°xima-verosimilitud-caso-1-covariable",
    "href": "diapositivas/RLSM_2.html#estimaci√≥n-por-m√°xima-verosimilitud-caso-1-covariable",
    "title": "Regresion Lineal Multiple",
    "section": "Estimaci√≥n por M√°xima Verosimilitud (caso 1 covariable)",
    "text": "Estimaci√≥n por M√°xima Verosimilitud (caso 1 covariable)\n\nLa idea central es elegir los par√°metros \\(\\beta_i\\) que maximizan la probabilidad de observar los datos.\n\nSupuestos b√°sicos\n\nLos errores \\(\\varepsilon_i\\) se asumen independientes y distribuidos:\n\\(\\varepsilon_i \\sim N(0, \\sigma^2)\\)\nEntonces:\n\\[\nY_i \\sim N(\\beta_0 + \\beta_1 X_i, \\, \\sigma^2)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#funci√≥n-de-verosimilitud",
    "href": "diapositivas/RLSM_2.html#funci√≥n-de-verosimilitud",
    "title": "Regresion Lineal Multiple",
    "section": "Funci√≥n de verosimilitud",
    "text": "Funci√≥n de verosimilitud\n\\[\nL(\\beta_0, \\beta_1,\\dots \\beta_p \\sigma^2 \\mid Y)\n= \\prod_{i=1}^n\n\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{(Y_i - \\beta_0 - \\beta_1 X_{i1} - \\dots \\beta_p X_{ip})^2}{2\\sigma^2} \\right)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#estimadores-mle",
    "href": "diapositivas/RLSM_2.html#estimadores-mle",
    "title": "Regresion Lineal Multiple",
    "section": "Estimadores MLE",
    "text": "Estimadores MLE\n\\[\n\\hat{\\beta}_j : \\text{ solucionan }\n\\sum_{i=1}^n X_{ik} Y_i = \\sum_{j=0}^p \\hat{\\beta}_j \\sum_{i=1}^n X_{ik}X_{ij},\n\\quad k=0,\\ldots,p.\n\\]\nVarianza del error\n\\[\n\\hat{\\sigma}^2_{ML} = \\frac{1}{n} \\sum_{i=1}^n\n\\left( Y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 X_{i1} - \\cdots - \\hat{\\beta}_p X_{ip} \\right)^2.\n\\]\nErrores est√°ndar\n\\[\nSE(\\hat{\\beta}_j) =\n\\sqrt{\\hat{\\sigma}^2 \\cdot c_{jj}}, \\quad j=0,\\ldots,p,\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#modelo-colesterol-en-funcion-de-la-presi√≥n-arterial-sistolica",
    "href": "diapositivas/RLSM_2.html#modelo-colesterol-en-funcion-de-la-presi√≥n-arterial-sistolica",
    "title": "Regresion Lineal Multiple",
    "section": "Modelo: Colesterol en funcion de la Presi√≥n arterial sistolica",
    "text": "Modelo: Colesterol en funcion de la Presi√≥n arterial sistolica\nObjetivo: Se requiere predecir los valores de colesterol de pacientes cuando se conoce su presion arterial sistolica, presencia de enfermedad cardiaca, sexo, BMI y raza\n\nAsumimos que la relaci√≥n entre las variables es lineal. (deberia validarse en el bivariado)\nSegun el modelo lineal planteado seria:\n\n\\[\\mu_{chol} = \\beta_0 + \\beta_1 \\times sbp + \\beta_2 \\times gender + \\beta_3 \\times bmi + \\beta_4 \\times race\\]\nQue valores asumen \\(\\beta_i\\)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ajuste-del-modelo",
    "href": "diapositivas/RLSM_2.html#ajuste-del-modelo",
    "title": "Regresion Lineal Multiple",
    "section": "Ajuste del modelo",
    "text": "Ajuste del modelo\n\nmodelo_multiple &lt;- lm(data = coronary, formula = chol~sbp+gender+bmi+race)\nsummary(modelo_multiple)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#el-modelo-es-adecuado",
    "href": "diapositivas/RLSM_2.html#el-modelo-es-adecuado",
    "title": "Regresion Lineal Multiple",
    "section": "¬øel modelo es adecuado?",
    "text": "¬øel modelo es adecuado?\nPrueba F\nF-statistic: 10.54 on 5 and 194 DF,  p-value: 5.728e-09: el modelo es significativo, con la las variables se permite explicar el colesterol.\nError estandar residual\nResidual standard error: 19.1 para saber que tan grande es: Tasa de error de predicci√≥n:\nsummary(modelo_multiple)$sigma/mean(coronary$chol)*100\n[1] 17.14911\nUna tasas de error de 17.1%\nCoeficiente de determinacion \\(R^2\\) y \\(R^2-ajustado\\)\nsummary(modelo_multiple)$r.squared\n[1] 0.2136579\nsummary(modelo_multiple)$adj.r.squared\n[1] 0.1933913\nEl ajuste es regular, se explica el 19.3% de la variabilidad del Colesterol"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#estimaci√≥n-de-coeficientes",
    "href": "diapositivas/RLSM_2.html#estimaci√≥n-de-coeficientes",
    "title": "Regresion Lineal Multiple",
    "section": "Estimaci√≥n de coeficientes",
    "text": "Estimaci√≥n de coeficientes\nsummary(modelo_multiple)$coefficients %&gt;% \n  kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n97.6645899\n22.9492296\n4.2556806\n0.0000324\n\n\nsbp\n0.2951363\n0.0772263\n3.8217067\n0.0001784\n\n\ngenderHombre\n1.4950868\n2.7281238\n0.5480275\n0.5843031\n\n\nbmi\n-0.8339743\n0.5142786\n-1.6216390\n0.1065047\n\n\nraceChino\n6.5975186\n3.3579541\n1.9647436\n0.0508717\n\n\nraceHindu\n12.2553353\n3.6901195\n3.3211215\n0.0010712\n\n\n\nModelo completo: \\[\\mu_{chol} = 97.66 + 0.29 \\times sbp + 1.49 \\times gender -0.83 \\times bmi + 6.59 \\times chino + 12.25 \\times hindu\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#interpretaci√≥n-de-coeficientes",
    "href": "diapositivas/RLSM_2.html#interpretaci√≥n-de-coeficientes",
    "title": "Regresion Lineal Multiple",
    "section": "Interpretaci√≥n de Coeficientes",
    "text": "Interpretaci√≥n de Coeficientes\n\n\\(\\beta_0\\) Representa la respuesta media cuando todos los predictores valen cero. Hay que ser cautos con su interpretaci√≥n, porque su valor puede no tener un significado pr√°ctico.\n\\(\\beta_1\\): las pendientes (o gradientes). Representan el cambio en la respuesta media por unidad de aumento en la variable explicativa asociada, cuando todos los otros predictores se mantienen constantes. Es decir, nos dicen en qu√© medida cada variable explicativa afecta a la variable respuesta si aislamos los efectos de todos los dem√°s predictores.\n\n\\[\\mu_{chol} = 97.66 + 0.29 \\times sbp + 1.49 \\times gender -0.83 \\times bmi + 6.59 \\times chino + 12.25 \\times hindu\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#predicciones-con-el-modelo-e-inferencia",
    "href": "diapositivas/RLSM_2.html#predicciones-con-el-modelo-e-inferencia",
    "title": "Regresion Lineal Multiple",
    "section": "Predicciones con el modelo e inferencia",
    "text": "Predicciones con el modelo e inferencia\nUn poblaci√≥n de sujetos tiene sbp\\(= 120\\), gender \\(=\\) Mujer, bmi \\(= 23\\) race \\(=\\) hindu\npredictions(modelo_multiple, newdata = data.frame(sbp = 120, gender = \"Mujer\",bmi = 23,\n                                                 race = \"Hindu\")) %&gt;% \n  select(2:9) %&gt;% \n   kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\nsbp\n\n\n\n\n126.15\n8.48\n14.88\n0\n163.88\n109.53\n142.78\n120\n\n\n\n\n\npredictions(modelo_multiple, newdata = data.frame(sbp = 180, gender = \"Mujer\",bmi = 23,\n                                                 race = \"Hindu\")) %&gt;% \n  select(2:9) %&gt;% \n   kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\nsbp\n\n\n\n\n143.86\n8.17\n17.62\n0\n228.31\n127.86\n159.87\n180"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#inferencia-coeficientes",
    "href": "diapositivas/RLSM_2.html#inferencia-coeficientes",
    "title": "Regresion Lineal Multiple",
    "section": "Inferencia: Coeficientes",
    "text": "Inferencia: Coeficientes\nsummary(modelo_multiple)$coefficients %&gt;% \n  kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n97.6645899\n22.9492296\n4.2556806\n0.0000324\n\n\nsbp\n0.2951363\n0.0772263\n3.8217067\n0.0001784\n\n\ngenderHombre\n1.4950868\n2.7281238\n0.5480275\n0.5843031\n\n\nbmi\n-0.8339743\n0.5142786\n-1.6216390\n0.1065047\n\n\nraceChino\n6.5975186\n3.3579541\n1.9647436\n0.0508717\n\n\nraceHindu\n12.2553353\n3.6901195\n3.3211215\n0.0010712\n\n\n\nconfint(modelo_multiple) %&gt;% kable()\n\n\n\n\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n52.4025696\n142.9266103\n\n\nsbp\n0.1428253\n0.4474472\n\n\ngenderHombre\n-3.8855032\n6.8756768\n\n\nbmi\n-1.8482694\n0.1803208\n\n\nraceChino\n-0.0252651\n13.2203024\n\n\nraceHindu\n4.9774324\n19.5332382"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#comparaci√≥n-de-modelo-seleccion-de-variables",
    "href": "diapositivas/RLSM_2.html#comparaci√≥n-de-modelo-seleccion-de-variables",
    "title": "Regresion Lineal Multiple",
    "section": "Comparaci√≥n de modelo: Seleccion de variables",
    "text": "Comparaci√≥n de modelo: Seleccion de variables\n\nSe hace necesario evaluar la contribucion de las variables que ingresan al modelo, ya que un modelo mas parsimonioso (menos variables) y explicando la misma variabilidad es mas deseable.\nComparar un modelo full vs modelo reducido\n\nCriterio de informacion de Akaike AIC\n\nmodelo_multiple_rdc &lt;- lm(formula = chol ~ sbp + bmi + race, data = coronary)\n\nAIC(modelo_multiple, modelo_multiple_rdc) %&gt;% kable()\n\n\n\n\ndf\nAIC\n\n\n\n\nmodelo_multiple\n7\n1756.068\n\n\nmodelo_multiple_rdc\n6\n1754.378"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#comparaci√≥n-de-modelo-seleccion-de-variables-1",
    "href": "diapositivas/RLSM_2.html#comparaci√≥n-de-modelo-seleccion-de-variables-1",
    "title": "Regresion Lineal Multiple",
    "section": "Comparaci√≥n de modelo: Seleccion de variables",
    "text": "Comparaci√≥n de modelo: Seleccion de variables\nPrueba F Parcial\nLa prueba F parcial eval√∫a si el modelo completo es significativamente mejor que el modelo reducido (Si la variable excluida contribuye significativamente)\nanova(modelo_multiple, modelo_multiple_rdc) %&gt;% kable()\n\n\n\nRes.Df\nRSS\nDf\nSum of Sq\nF\nPr(&gt;F)\n\n\n\n\n194\n71024.56\nNA\nNA\nNA\nNA\n\n\n195\n71134.51\n-1\n-109.9541\n0.3003341\n0.5843031"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#section",
    "href": "diapositivas/RLSM_2.html#section",
    "title": "Regresion Lineal Multiple",
    "section": "",
    "text": "summary(modelo_multiple_rdc)$coefficients%&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n99.3172356\n22.7093829\n4.373401\n0.0000199\n\n\nsbp\n0.2933061\n0.0770155\n3.808402\n0.0001873\n\n\nbmi\n-0.8540871\n0.5120464\n-1.667988\n0.0969231\n\n\nraceChino\n6.6566350\n3.3501945\n1.986940\n0.0483291\n\n\nraceHindu\n12.4693861\n3.6628016\n3.404330\n0.0008051\n\n\n\nsummary(modelo_multiple)$coefficients%&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n97.6645899\n22.9492296\n4.2556806\n0.0000324\n\n\nsbp\n0.2951363\n0.0772263\n3.8217067\n0.0001784\n\n\ngenderHombre\n1.4950868\n2.7281238\n0.5480275\n0.5843031\n\n\nbmi\n-0.8339743\n0.5142786\n-1.6216390\n0.1065047\n\n\nraceChino\n6.5975186\n3.3579541\n1.9647436\n0.0508717\n\n\nraceHindu\n12.2553353\n3.6901195\n3.3211215\n0.0010712"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#en-modelos-predictivos",
    "href": "diapositivas/RLSM_2.html#en-modelos-predictivos",
    "title": "Regresion Lineal Multiple",
    "section": "En modelos predictivos",
    "text": "En modelos predictivos\nEn comparaciones multiples se hace dificil probar todos los posible modelos, sin embargo un algortimo automatico puede ayudarnos a reducir el trabajo sin perder el criterio epidemiologico:\n\nfinal &lt;- step(modelo_multiple,direction = \"backward\")\n\nsummary(final)$coefficients %&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n99.3172356\n22.7093829\n4.373401\n0.0000199\n\n\nsbp\n0.2933061\n0.0770155\n3.808402\n0.0001873\n\n\nbmi\n-0.8540871\n0.5120464\n-1.667988\n0.0969231\n\n\nraceChino\n6.6566350\n3.3501945\n1.986940\n0.0483291\n\n\nraceHindu\n12.4693861\n3.6628016\n3.404330\n0.0008051"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagn√≥stico-supuestos",
    "href": "diapositivas/RLSM_2.html#diagn√≥stico-supuestos",
    "title": "Regresion Lineal Multiple",
    "section": "Diagn√≥stico: Supuestos",
    "text": "Diagn√≥stico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nSupuestos b√°sicos (acr√≥nimo LINE):\nL de Linealidad: Los valores de (Y) se pueden expresar como una funci√≥n lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre s√≠.\nN de Normalidad:Para cualquier valor fijo de (X), los valores de (Y) (o los errores/residuos) se distribuyen normalmente.\nE de Equitatividad (Homoscedasticidad): La variaci√≥n de los valores de (Y) (o los errores/residuos) alrededor de la l√≠nea de regresi√≥n es constante."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nLinealidad y homocedasticidad: sin patrones Causas: modelo no lineal, falta de variables explicativas, interacci√≥n."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-1",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-1",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nFalta de Normalidad: Otro modelos lineales generalizados"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-2",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-2",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nHomogeneidad de la varianza: Transformaciones"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-3",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-3",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nIdentificar valores inusuales e influyentes: Transformaciones."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#confusi√≥n",
    "href": "diapositivas/RLSM_2.html#confusi√≥n",
    "title": "Regresion Lineal Multiple",
    "section": "Confusi√≥n",
    "text": "Confusi√≥n\n\nDefinici√≥n: Es un efecto sesgado o no real entre una exposici√≥n y un desenlace, que ocurre como consecuencia de una variable o unas variables confusoras.\nAlgunas variables pueden ser controladas al inicio del estudio (criterios de inclusi√≥n).\nSe presentan com√∫nmente en estudios observacionales.\nSon declarados en el dise√±o y medidos sin error"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#confusi√≥n-1",
    "href": "diapositivas/RLSM_2.html#confusi√≥n-1",
    "title": "Regresion Lineal Multiple",
    "section": "Confusi√≥n",
    "text": "Confusi√≥n\n\\[E(Y/X) = \\beta_0 + \\beta_1X_1\\]\nPara dos distinto valores \\(X_1\\), \\(A\\) para poblaciones expuestas \\(Y_1\\) y \\(B\\) para no expuestos \\(Y_0\\) la diferencia es representada por:\n\\[E(Y_1)-E(Y_0)= \\beta_0 + \\beta_1A - \\beta_0 - \\beta_1B \\\\= \\beta_1(A-B)\\]\nahora si tenemos en cuenta a \\(X_2\\) en la relacion de \\(Y\\) y \\(X_1\\)\n\\[E(Y/X_1,X_2) = \\beta_0 + \\beta_1X_1 + \\beta_2X_2\\]\nPara valores de \\(X_2\\) distintos \\((C,D)\\) entre expuestos y no expuestos:\n\\[E(Y_1)-E(Y_0)= \\beta_0 + \\beta_1A + \\beta_2C - \\beta_0 - \\beta_1B - \\beta_2D \\\\= \\beta_1(A-B) + \\beta_2(C-D)\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#evidenciemos-los-efectos-del-confusor-modelo-explicativo",
    "href": "diapositivas/RLSM_2.html#evidenciemos-los-efectos-del-confusor-modelo-explicativo",
    "title": "Regresion Lineal Multiple",
    "section": "Evidenciemos los efectos del confusor (modelo explicativo)",
    "text": "Evidenciemos los efectos del confusor (modelo explicativo)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n53.91\n8.86\n6.09\n0\n\n\ndbp\n0.70\n0.11\n6.59\n0"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#etnia-hindu-como-posible-confusor",
    "href": "diapositivas/RLSM_2.html#etnia-hindu-como-posible-confusor",
    "title": "Regresion Lineal Multiple",
    "section": "Etnia Hindu como posible confusor",
    "text": "Etnia Hindu como posible confusor\nRelaci√≥n entre raza hindu y presion diastolica\nWelch Two Sample t-test data:  dbp by raza t = -3.96, df = 103.83, p-value = 0.0001376\nmean in group 0 mean in group 1\n79.80         87.76\nRelaci√≥n entre raza hindu y Colesterol\nWelch Two Sample t-test data:  chol by raza t = -4.3482, df = 104.53, p-value = 0.000003197\nmean in group 0 mean in group 1\n107.07            121.35"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ajustemos-un-modelo-incluyendo-a-raza",
    "href": "diapositivas/RLSM_2.html#ajustemos-un-modelo-incluyendo-a-raza",
    "title": "Regresion Lineal Multiple",
    "section": "Ajustemos un modelo incluyendo a raza",
    "text": "Ajustemos un modelo incluyendo a raza\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n53.91\n8.86\n6.09\n0\n\n\ndbp\n0.70\n0.11\n6.59\n0\n\n\n\n\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n59.03\n8.81\n6.70\n0\n\n\ndbp\n0.60\n0.11\n5.55\n0\n\n\nraza\n9.48\n3.01\n3.15\n0"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#interacci√≥n",
    "href": "diapositivas/RLSM_2.html#interacci√≥n",
    "title": "Regresion Lineal Multiple",
    "section": "Interacci√≥n",
    "text": "Interacci√≥n\n\nDefinici√≥n: El efecto de una exposici√≥n sobre el desenlace varia en funci√≥n de otra covariable. (heterogeneidad de efectos o modificaci√≥n de efectos).\n\nEn resumen es evaluar el efecto de una exposici√≥n separadamente para los niveles (valores) de otras covariables incluidas en el modelo.\nHasta ahora en Confusi√≥n:\nEl efecto de un predictor es independiente de otros en efectos principales.\nEn adelante en Interacci√≥n:\nEl efecto de una exposici√≥n depende de los valores de otra covariable."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacci√≥n-i",
    "href": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacci√≥n-i",
    "title": "Regresion Lineal Multiple",
    "section": "Modelo para evaluar interacci√≥n I",
    "text": "Modelo para evaluar interacci√≥n I\nasumiendo que \\(X_1\\) es la exposici√≥n de inter√©s:\n\\[E(Y/X_1,X_2)=\\beta_0+\\beta_1X_1+\\beta_2X_2+\\beta_3X_1X_2\\]\nSe puede re-agrupar:\n\\[E(Y/X_1,X_2)=\\beta_0+\\beta_1X_1+\\beta_2X_2+\\beta_3X_1X_2\\]\n\\[Y=\\beta_0+\\beta_2X_2+\\left(\\beta_1+\\beta_3X_2\\right)X_1\\]\n\\((\\beta_1+\\beta_3X_2)\\) es el efecto de \\(X_1\\) en \\(Y\\) cuando \\(X_2 \\neq 0\\)\n\\(\\beta_1\\) cuando \\(X_2=0\\)."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacci√≥n-ii",
    "href": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacci√≥n-ii",
    "title": "Regresion Lineal Multiple",
    "section": "Modelo para evaluar interacci√≥n II",
    "text": "Modelo para evaluar interacci√≥n II\nasumiendo que \\(X_2\\) es la exposici√≥n de inter√©s:\n\\[E(Y/X_1,X_2)=\\beta_0+\\beta_1X_1+\\beta_2X_2+\\beta_3X_1X_2\\]\nSe puede re-agrupar:\n\\[Y=\\beta_0+\\beta_1X_1+\\left(\\beta_2+\\beta_3X_1\\right)X_2\\]\n\\((\\beta_2+\\beta_3X_2)\\) es el efecto de \\(X_2\\) en \\(Y\\) cuando \\(X_1 \\neq 0\\)\n\\(\\beta_2\\) cuando \\(X_1=0\\)."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ejemplo-interacci√≥n-con-categorica",
    "href": "diapositivas/RLSM_2.html#ejemplo-interacci√≥n-con-categorica",
    "title": "Regresion Lineal Multiple",
    "section": "ejemplo: Interacci√≥n con categorica",
    "text": "ejemplo: Interacci√≥n con categorica\nmodelo_inter &lt;- glm(LDL1 ~ HT + statins + HT:statins, data = hers)\nsummary(modelo_inter)$coefficients %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n145.156724\n1.325549\n109.506863\n0.0000000\n\n\nHThormone therapy\n-17.728360\n1.870629\n-9.477219\n0.0000000\n\n\nstatinsyes\n-13.809124\n2.152130\n-6.416491\n0.0000000\n\n\nHThormone therapy:statinsyes\n6.244416\n3.076489\n2.029721\n0.0424863\n\n\n\n\\[ LDL = 145.15 -17.72HT - 13.80statins + 6.24HTstatins\\]\navg_comparisons(modelo_inter, variables = \"HT\", by = \"statins\") %&gt;%  \nselect(1:6)%&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\n\nterm\ncontrast\nstatins\nestimate\nstd.error\nstatistic\n\n\n\n\nHT\nhormone therapy - placebo\nno\n-17.72836\n1.870629\n-9.477219\n\n\nHT\nhormone therapy - placebo\nyes\n-11.48394\n2.442444\n-4.701824"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#graficamente-la-interacci√≥n",
    "href": "diapositivas/RLSM_2.html#graficamente-la-interacci√≥n",
    "title": "Regresion Lineal Multiple",
    "section": "Graficamente la interacci√≥n:",
    "text": "Graficamente la interacci√≥n:"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ejemplo-interacci√≥n-continua",
    "href": "diapositivas/RLSM_2.html#ejemplo-interacci√≥n-continua",
    "title": "Regresion Lineal Multiple",
    "section": "Ejemplo: Interacci√≥n Continua",
    "text": "Ejemplo: Interacci√≥n Continua\nmodelo_inter2 &lt;- glm(LDL1 ~ statins + BMI + statins:BMI, data = hers)\nsummary(modelo_inter2)$coefficients %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n122.1451382\n5.0146274\n24.357769\n0.0000000\n\n\nstatinsyes\n10.0822853\n8.4339549\n1.195440\n0.2320243\n\n\nBMI\n0.4919387\n0.1719634\n2.860717\n0.0042606\n\n\nstatinsyes:BMI\n-0.7146756\n0.2903733\n-2.461230\n0.0139107\n\n\n\n\\[ LDL = 122.14 + 10.08statins + 0.49BMI - 0.71statins*BMI\\]\ncomparisons(modelo_inter2, variables = \"statins\", newdata = datagrid(BMI = range)) %&gt;% select(1:6) %&gt;% kable()\n\n\n\nrowid\nterm\ncontrast\nestimate\nstd.error\nstatistic\n\n\n\n\n1\nstatins\nyes - no\n-0.988039\n4.100950\n-0.2409293\n\n\n2\nstatins\nyes - no\n-28.603103\n7.595175\n-3.7659573"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#graficamente-la-interacci√≥n-1",
    "href": "diapositivas/RLSM_2.html#graficamente-la-interacci√≥n-1",
    "title": "Regresion Lineal Multiple",
    "section": "Graficamente la interacci√≥n:",
    "text": "Graficamente la interacci√≥n:"
  },
  {
    "objectID": "diapositivas/rlgs.html#conjunto-de-datos-stroke.rds",
    "href": "diapositivas/rlgs.html#conjunto-de-datos-stroke.rds",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Conjunto de datos: stroke.rds",
    "text": "Conjunto de datos: stroke.rds\n\nUsaremos el dataset stroke.rds en formato R.¬†üëâ Descargar stroke.rds\n\nContiene 226 observaciones y 7 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripci√≥n\n\n\n\n\nstatus\nEstado del paciente durante la hospitalizaci√≥n ( 0 vivo / 1 fallecido)\n\n\ngcs\nEscala de Glasgow al ingreso (3‚Äì15)\n\n\nstroke_type\nTipo de ictus (IS = isqu√©mico; HS = hemorr√°gico)\n\n\nsex\nSexo biol√≥gico (1 femenino / 0masculino)\n\n\ndm\nHistoria de diabetes (s√≠ / no)\n\n\nsbp\nPresi√≥n arterial sist√≥lica (mmHg)\n\n\nage\nEdad al ingreso (a√±os)"
  },
  {
    "objectID": "diapositivas/rlgs.html#introducci√≥n-a-la-regresi√≥n-logistica",
    "href": "diapositivas/rlgs.html#introducci√≥n-a-la-regresi√≥n-logistica",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Introducci√≥n a la Regresi√≥n Logistica",
    "text": "Introducci√≥n a la Regresi√≥n Logistica\n\nLa regresi√≥n logistica es uno de los an√°lisis estad√≠sticos m√°s comunes en epidemiologia.\nModela la relaci√≥n lineal entre una variable resultado categorica binaria (por ejemplo estado de infecci√≥n, estado vital, complicaciones) y predictores que pueden ser num√©ricos o categ√≥ricos.\nLa regresi√≥n log√≠stica es un caso particular del Modelo Lineal Generalizado (GLM)."
  },
  {
    "objectID": "diapositivas/rlgs.html#regresi√≥n-logistica-simple",
    "href": "diapositivas/rlgs.html#regresi√≥n-logistica-simple",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Regresi√≥n Logistica Simple",
    "text": "Regresi√≥n Logistica Simple\n\nLa Regresi√≥n Logistica Simple modela la relaci√≥n lineal entre:\n\nUna variable dependiente categorica (ej. Status).\n\nUn √∫nico predictor (num√©rico o categ√≥rico).\n\nCuando el predictor es categ√≥rico, se puede interpretar como un prueba de chi-cuadrado.\n\nExpresi√≥n matem√°tica\n\\[E(Y \\mid X) = \\beta_0 + \\beta_1 X\\] \\(E(Y) = P(Y)\\) Recordar que \\(Y = [0,1]\\) si se asume asi los valores de \\(Y\\) estimados por el modelo lineal simple siempre los valores estimados de \\(Y\\) se salen de \\(0\\) o de \\(1\\)."
  },
  {
    "objectID": "diapositivas/rlgs.html#modelo-enlace-y-probabilidades",
    "href": "diapositivas/rlgs.html#modelo-enlace-y-probabilidades",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Modelo, enlace y probabilidades",
    "text": "Modelo, enlace y probabilidades\n\\[Odds = \\frac{P(Y)}{1-P(Y)}\\] el logaritmo de Odds \\(Log(odds)\\) si es lineal en terminos de una covariable, y se llama el logit.\n\\[\n\\log(\\frac{P(Y/X)}{1-P(Y/X)}) = \\beta_0 + \\beta_1X\n\\]\n\\[\nP(Y/X)=\\frac{1}{1+e^{-\\left(\\beta_0+\\beta_1 X\\right)}}\n\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#estimaci√≥n-por-m√°xima-verosimilitud-caso-1-covariable",
    "href": "diapositivas/rlgs.html#estimaci√≥n-por-m√°xima-verosimilitud-caso-1-covariable",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Estimaci√≥n por M√°xima Verosimilitud (caso 1 covariable)",
    "text": "Estimaci√≥n por M√°xima Verosimilitud (caso 1 covariable)\n\nLa idea central es elegir los par√°metros \\(\\beta_0, \\beta_1\\) que maximizan la probabilidad de observar los datos.\n\n\\[\nL(P(\\beta_0,\\beta_1/Y,X))=\\sum_{i=1}^n\\Big[y_i(\\beta_0+\\beta_1 X_i)-\\log\\!\\big(1+e^{\\beta_0+\\beta_1 X_i}\\big)\\Big].\n\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo",
    "href": "diapositivas/rlgs.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Modelo: Probabilidad de muerte en funcion del sexo",
    "text": "Modelo: Probabilidad de muerte en funcion del sexo\nObjetivo: Se requiere predecir la probabilidad de fallecer (status = 1) en pacientes cuando se conoce su sexo\n\nAsumimos que la relac√≥on lineal en el \\(logit(P)\\) es decir \\(\\log(\\frac{P}{1-P})\\)\nSegun el modelo lineal planteado seria:\n\n\\[\\log(\\frac{P}{1-P}) = \\beta_0 + \\beta_1 \\times sexo\\]\nQue valores asumen \\(\\beta_0\\) y \\(\\beta_1\\)"
  },
  {
    "objectID": "diapositivas/rlgs.html#ajuste-del-modelo",
    "href": "diapositivas/rlgs.html#ajuste-del-modelo",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Ajuste del modelo",
    "text": "Ajuste del modelo\n\nmodelo &lt;- glm(status ~ sex, \n      data = stroke, \n      family = binomial(link = 'logit'))\nsummary(modelo)"
  },
  {
    "objectID": "diapositivas/rlgs.html#el-modelo-es-adecuado",
    "href": "diapositivas/rlgs.html#el-modelo-es-adecuado",
    "title": "Regresi√≥n Logistica Simple",
    "section": "¬øEl modelo es adecuado?",
    "text": "¬øEl modelo es adecuado?\nPrueba chi-cuadrado\nminimizar la perdida de informacion Deviance residual comparada con la nula.\n\nresiduos_log_1 &lt;- modelo$null.deviance - modelo$deviance\n#Grados de Libertad.\ngrados_log_1 &lt;- modelo$df.null - modelo$df.residual\n#p-value.\npchisq(residuos_log_1, grados_log_1,lower.tail = F)\n\n[1] 0.01559606"
  },
  {
    "objectID": "diapositivas/rlgs.html#estimaci√≥n-de-coeficientes",
    "href": "diapositivas/rlgs.html#estimaci√≥n-de-coeficientes",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Estimaci√≥n de coeficientes",
    "text": "Estimaci√≥n de coeficientes\n\nmodelo_null &lt;- glm(status ~ 1, \n      data = stroke, \n      family = binomial(link = 'logit'))\n\nsummary(modelo_null)$coefficients\n\n            Estimate Std. Error  z value     Pr(&gt;|z|)\n(Intercept) -1.13433  0.1550153 -7.31754 2.525578e-13\n\n\n\nmean(stroke$status)\n\n[1] 0.2433628\n\n\nEl coeficiente \\(-1.13433\\) segun modelo corresponde a:\n\\[\\log(odds) = -1.13433\\] \\[e^{\\log(odds)} = e^{-1.13433}\\] \\(odds = 0.3217\\) ahora devolviendonos \\(P = \\frac{odds}{1+odds}\\) entonces:\n\\[ P = \\frac{0.3217}{1+0.3217} = 0.2424\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#con-covariable-categorica",
    "href": "diapositivas/rlgs.html#con-covariable-categorica",
    "title": "Regresi√≥n Logistica Simple",
    "section": "con covariable categorica",
    "text": "con covariable categorica\nmodelo &lt;- glm(status ~ sex, \n      data = stroke, \n      family = binomial(link = 'logit'))\nsummary(modelo)$coefficients\n          Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -0.8362480 0.1917084 -4.362084 1.288295e-05 sex -0.7856124 0.3340625 -2.351693 1.868821e-02\nModelo completo: \\(\\log(odds) = -0.835 - 0.785 \\times sex\\)\n\n\nAhora vamos a la interpretaci√≥n de coeficientes"
  },
  {
    "objectID": "diapositivas/rlgs.html#interpretaci√≥n-de-coeficientes-de-variable-categorica-binaria",
    "href": "diapositivas/rlgs.html#interpretaci√≥n-de-coeficientes-de-variable-categorica-binaria",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Interpretaci√≥n de Coeficientes de variable categorica (binaria)",
    "text": "Interpretaci√≥n de Coeficientes de variable categorica (binaria)\n\n\\(\\beta_0\\) es el valor medio que asumen la variable dependiente (\\(\\log(odds)\\)) cuando la covariable toma valor cero (en nuestro caso ser hombre).\n\n\\[\\log(odds) = -0.835 - 0.785(0) = -0.835\\]\n\\[odds_{hombre} = e^{-0.835} = 0.43\\]\n\npasadolo a probabilidad seria \\(\\frac{0.43}{1-0.43} = 0.302\\).\n\nSi recordamos la tabla de \\(2\\times 2\\)"
  },
  {
    "objectID": "diapositivas/rlgs.html#interpretaci√≥n-de-coeficientes-de-variable-categorica-binaria-1",
    "href": "diapositivas/rlgs.html#interpretaci√≥n-de-coeficientes-de-variable-categorica-binaria-1",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Interpretaci√≥n de Coeficientes de variable categorica (binaria)",
    "text": "Interpretaci√≥n de Coeficientes de variable categorica (binaria)\n\n\\(\\beta_1\\): para obtener interpretaci√≥n de este coeficiente realizamos la siguiente comparaci√≥n de resultados del modelo cuando sexo asume ser F contra M. Es decir un cambio de 0 (Hombre) a 1(Mujer).\n\n\\[e^{\\log(odds_{mujer})} =odds_{mujer} = e^{\\beta_0 + \\beta_1(1)}\\] \\[e^{\\log(odds_{hombre})} =odds_{hombre} = e^{\\beta_0 + \\beta_1(0)}\\] \\[\\frac{odds_{mujer}}{odds_{hombre}} = \\frac{e^{\\beta_0 + \\beta_1(1)}}{e^{\\beta_0 + \\beta_1(0)}} = e^{\\beta_0 + \\beta_1(1)}e^{-\\beta_0 - \\beta_1(0)} = e^{\\beta_1}\\] ¬øSe concluye entonces qu√©?"
  },
  {
    "objectID": "diapositivas/rlgs.html#predicciones-con-el-modelo",
    "href": "diapositivas/rlgs.html#predicciones-con-el-modelo",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Predicciones con el modelo",
    "text": "Predicciones con el modelo\n\npredict(modelo,newdata = data.frame(sex = 1),type = \"response\")\n\n        1 \n0.1649485 \n\n\n\npredict(modelo,newdata = data.frame(sex = 0), type = \"response\")\n\n        1 \n0.3023256"
  },
  {
    "objectID": "diapositivas/rlgs.html#inferencia-coeficientes-y-predicciones",
    "href": "diapositivas/rlgs.html#inferencia-coeficientes-y-predicciones",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\n\nsummary(modelo)$coefficients\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -0.8362480  0.1917084 -4.362084 1.288295e-05\nsex         -0.7856124  0.3340625 -2.351693 1.868821e-02\n\n\n\nexp(coefficients(modelo))\n\n(Intercept)         sex \n  0.4333333   0.4558405 \n\nexp(confint(modelo))\n\n                2.5 %    97.5 %\n(Intercept) 0.2944922 0.6258239\nsex         0.2316497 0.8640154"
  },
  {
    "objectID": "diapositivas/rlgs.html#inferencia-en-predicciones",
    "href": "diapositivas/rlgs.html#inferencia-en-predicciones",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Inferencia en predicciones",
    "text": "Inferencia en predicciones\n\npredictions(modelo, newdata = data.frame(sex = c(1)))\n\n\n Estimate Pr(&gt;|z|)    S 2.5 % 97.5 % sex\n    0.165   &lt;0.001 28.3 0.104  0.252   1\n\nType:  invlink(link)"
  },
  {
    "objectID": "diapositivas/rlgs.html#diagn√≥stico-supuestos",
    "href": "diapositivas/rlgs.html#diagn√≥stico-supuestos",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Diagn√≥stico: Supuestos",
    "text": "Diagn√≥stico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nL de Linealidad: Los valores de (Y) se pueden expresar como una funci√≥n lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre s√≠."
  },
  {
    "objectID": "diapositivas/rlgs.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "href": "diapositivas/rlgs.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)"
  },
  {
    "objectID": "diapositivas/rlgs.html#con-covariable-numerica",
    "href": "diapositivas/rlgs.html#con-covariable-numerica",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Con covariable numerica",
    "text": "Con covariable numerica\nmodelo con glasglow como covariable\n\nmodelo_num &lt;- glm(formula = status ~ gcs, stroke, family = binomial(link = 'logit'))\nsummary(modelo_num)\n\n\nCall:\nglm(formula = status ~ gcs, family = binomial(link = \"logit\"), \n    data = stroke)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  3.29479    0.60432   5.452 4.98e-08 ***\ngcs         -0.38811    0.05213  -7.446 9.64e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 250.83  on 225  degrees of freedom\nResidual deviance: 170.92  on 224  degrees of freedom\nAIC: 174.92\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "diapositivas/rlgs.html#modelo-estimado",
    "href": "diapositivas/rlgs.html#modelo-estimado",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Modelo Estimado",
    "text": "Modelo Estimado\n\\[\\log(odds) = 3.29 - 0.38 \\times gcs\\]\n\n\\(\\beta_1\\): evaluemos que pasa si hacemos un cambio en una unidad de la covariable\n\n\n\\[\\log(Odds_{gcs12})-\\log(Odds_{gcs11}) = \\log(\\frac{Odds_{gcs12}}{Odds_{gcs11}})\\]\n\n\n\\[\\log(\\frac{Odds_{gcs12}}{Odds_{gcs11}})=\\beta_0 + \\beta_1(12)-\\beta_0 - \\beta_1(11)= \\beta_0-\\beta_0+\\beta_1(12)-\\beta_1(11)\\]\n\n\n\\[\\log(\\frac{Odds_{gcs12}}{Odds_{gcs11}}) = \\beta_1(12-11) = \\beta_1\\] \\[\\log(OR) = \\beta_1\\], aplicamos \\(e\\) ambos lados\n\n\n\\[OR = e^{\\beta_1} = e^{-0.38} = 0.68\\]\npor cada punto de incremento en la escala glasglow OR se multiplicar√≠a por \\(0.68\\)."
  },
  {
    "objectID": "diapositivas/rlgs.html#cuidado-con-la-interepretaci√≥n-de-or-en-variable-numericas",
    "href": "diapositivas/rlgs.html#cuidado-con-la-interepretaci√≥n-de-or-en-variable-numericas",
    "title": "Regresi√≥n Logistica Simple",
    "section": "CUIDADO CON LA INTEREPRETACI√ìN DE OR EN VARIABLE NUMERICAS",
    "text": "CUIDADO CON LA INTEREPRETACI√ìN DE OR EN VARIABLE NUMERICAS\n\nEl cambio es en escala multiplicativa no ADITIVA como en regresi√≥n lineal.\nEn el ejemplo: La frecuencia de muerte cambia multiplicando por el valor del coeficiente exponenciado.\n\nPara 1 punto de cambio en glasglow \\(OR = 0.68\\)\nPara 2 puntos de cambio acumulados seria \\(OR = 0.68\\times0.68 = 0.46\\)\nDe otra manera \\[OR = e^{-0.38\\times2}= 0.46\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#diagnostico-del-modelo",
    "href": "diapositivas/rlgs.html#diagnostico-del-modelo",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Diagnostico del modelo",
    "text": "Diagnostico del modelo"
  },
  {
    "objectID": "diapositivas/rlgs.html#revisemos-linealidad-entre-odds-de-fallecer-y-glasglow",
    "href": "diapositivas/rlgs.html#revisemos-linealidad-entre-odds-de-fallecer-y-glasglow",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Revisemos linealidad entre Odds de fallecer y Glasglow",
    "text": "Revisemos linealidad entre Odds de fallecer y Glasglow"
  },
  {
    "objectID": "rlm.html#actividad",
    "href": "rlm.html#actividad",
    "title": "Regresion Lineal Multiple",
    "section": "Actividad",
    "text": "Actividad\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento Documento de trabajo, copiando y pegando pantallazos de los resultados y sus interpretaciones.\nEl dataset lowbwt que se puede descargar aca üëâ Descargar lowbwt.rds contiene informaci√≥n para una muestra de 100 reci√©n nacidos con bajo peso al nacer. mediciones de presi√≥n arterial sistolica son guardadas bajo el nombre de sbp y valores de edad gestacional bajo el nombre de gestage.\nDescargue el siguiente archivo denominado Codigo_taller2.R üëâ Descargar Codigo_taller2.R, donde encontrara los codigos necesarios para obtener los resultados solicitados en el taller.\nRecuerde que en el pasado ya habian encontrado una relaci√≥n significativa entre la presion arterial sistolica de neonatos con bajo peso (sbp)y la edad gestacional (gestage). En este nuevo analisis utilizaremos la variable Apgar a los 5 minutos (apgar5), es una variable oridnal, pero frecuentemente es tratada como continua.",
    "crumbs": [
      "Regresi√≥n Lineal Multiple"
    ]
  },
  {
    "objectID": "rlm.html#taller-2-regresion-lineal-multiple",
    "href": "rlm.html#taller-2-regresion-lineal-multiple",
    "title": "Regresion Lineal Multiple",
    "section": "Taller 2: Regresion Lineal Multiple",
    "text": "Taller 2: Regresion Lineal Multiple\n\nConstruya un grafico de dispersi√≥n de presion artetial sistolica y apgar . ¬øParece tener una relaci√≥n lineal entre las dos variables?.\nUsando la presi√≥n arterial sistolica como variable dependiente (respuesta), la edad gestacional y el apgar como variables explicatorias. Estime los parametros del modelo \\[\\hat \\mu_{sbp} = \\beta_0 + \\beta_1 \\times gestage + \\beta_2 \\times apgar\\]\n\n\nInterprete \\(\\hat \\beta_1\\), ¬øqu√© significa en palabras?, realice lo mismo para \\(\\hat \\beta_2\\)\n\n\nCual es la media estimada de la presi√≥n arterial para la poblaci√≥n de recien nacidos con bajo peso en quienes la edad gestacional es 31 semanas y apgar a los 5 minutos sea de 7, Interprete.\nConstruya un intervalo de confianza para la media cuando la edad gestacional es 31 semanas y el apgar es de 7. Interpretelo.\nA un nivel de 0.05 de error alfa, contraste \\(H_0: \\beta_2 = 0\\)?, ¬øQu√© concluye?\n¬øEl modelo ajustado parece ajustar a los datos observados?.Revise el \\(R^2\\) ajustado comente e interprete. estime la tasa de error de las predicciones.\nla inclusi√≥n del apgar aporta significativamente al modelo como para dejarlo en el modelo?.\nConstruya los graficos de diagnostico, hay cumplimiento de los supuestos de validez del modelo?",
    "crumbs": [
      "Regresi√≥n Lineal Multiple"
    ]
  },
  {
    "objectID": "rlm.html#taller-3-ajuste-para-confusion-e-interacci√≥n-en-regresion-lineal-multiple",
    "href": "rlm.html#taller-3-ajuste-para-confusion-e-interacci√≥n-en-regresion-lineal-multiple",
    "title": "Regresion Lineal Multiple",
    "section": "Taller 3: Ajuste para confusion e interacci√≥n en regresion lineal multiple",
    "text": "Taller 3: Ajuste para confusion e interacci√≥n en regresion lineal multiple\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento Documento de trabajo.\nSi desea reproducir los resultados en su PC, los datos se pueden descargar aca üëâ Descargar hers.rds.\n\nConfusi√≥n\nSe esta estudiando los efectos que se puedan dar sobre los niveles de glucosa sobre un grupo de pacientes, para esto se ajusto inicialmente un modelo que estimo el principal que tiene un programa donde se recibe actividad f√≠sica 3 veces a la semana, los resultados fueron los siguientes:\n\nmod_unjus &lt;- lm(formula = glucose ~ exercise, data = hers)\nsummary(mod_unjus)\n\n\nCall:\nlm(formula = glucose ~ exercise, data = hers)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-85.561 -20.561 -12.561   2.672 189.672 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 114.5611     0.8922 128.408  &lt; 2e-16 ***\nexerciseyes  -6.2333     1.4350  -4.344 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 36.73 on 2761 degrees of freedom\nMultiple R-squared:  0.006788,  Adjusted R-squared:  0.006428 \nF-statistic: 18.87 on 1 and 2761 DF,  p-value: 1.451e-05\n\nconfint(mod_unjus)\n\n                 2.5 %     97.5 %\n(Intercept) 112.811683 116.310441\nexerciseyes  -9.047117  -3.419576\n\n\nA la luz de las estimaciones:\n\nInterprete el coeficiente asociado al programa de actividad f√≠sica, acompa√±e esta interpretaci√≥n de sus respectivos intervalos de confianza al 95% y valor de p.\n\nSin embargo es de conocimiento pleno que otras variables tambien se relacionan con los niveles de glucosa en sangre, espec√≠ficamente se tiene conocimiento que el indice de masa corporal que define obesidad, podria tambine jugar un papel preponderante tanto con la glucosa como el programa de actividad fisica. Dado esto se ajusta el efecto entre el progama de actividad fisica y glucosa:\n\nmod &lt;- lm(formula = glucose ~ exercise + BMI , data = hers)\nsummary(mod)\n\n\nCall:\nlm(formula = glucose ~ exercise + BMI, data = hers)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-79.18 -18.72 -10.35   3.79 192.38 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  62.4154     3.7402  16.688   &lt;2e-16 ***\nexerciseyes  -2.8932     1.4066  -2.057   0.0398 *  \nBMI           1.7794     0.1242  14.331   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.46 on 2755 degrees of freedom\n  (5 observations deleted due to missingness)\nMultiple R-squared:  0.07576,   Adjusted R-squared:  0.07509 \nF-statistic: 112.9 on 2 and 2755 DF,  p-value: &lt; 2.2e-16\n\n\n\nEl efecto que tiene el programa de ejercicio cambio despues del ajuste?, si fue asi, qu√© direcci√≥n tomo?, cuantifique su cambio porcentual (\\(\\frac{\\beta_{crudo}-\\beta_{ajustado}}{\\beta_{crudo}}\\times100\\)). Se confirma que BMI sesgaba el efecto que tenia el programa de ejercicio sobre la glucosa?. Explique.\nAhora interprete el coeficiente ajustado del programa de actividad fisica. acompa√±elos de intervalos de confianza y valor de p.\n\n\nconfint(mod)\n\n                2.5 %     97.5 %\n(Intercept) 55.081469 69.7492613\nexerciseyes -5.651330 -0.1350112\nBMI          1.535926  2.0228348\n\n\n\npor ultimo asuma que eval√∫a por el contrario el efecto de BMI sobre la glucosa teniendo en cuenta el ajuste por pertenecer a un programa de actividad fisica. Interprete coeficiente ajustado de BMI, no olvide en su interpretaci√≥n hablar de los intervalos de confianza y valores de p.\nFinalmente se ajusta el siguiente modelo explicativo sobre el efecto sobre la glucosa que tienen diversas variables. Interprete cada uno de los coeficientes, como efecto principal.\n\n\nmod_com &lt;- lm(formula = glucose ~ exercise + BMI + age + drinkany + smoking , data = hers)\nsummary(mod_com)\n\n\nCall:\nlm(formula = glucose ~ exercise + BMI + age + drinkany + smoking, \n    data = hers)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-77.533 -18.879  -9.858   4.765 192.487 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  89.7184     8.7503  10.253  &lt; 2e-16 ***\nexerciseyes  -3.5013     1.4193  -2.467  0.01369 *  \nBMI           1.6225     0.1274  12.733  &lt; 2e-16 ***\nage          -0.2843     0.1051  -2.705  0.00687 ** \ndrinkanyyes  -7.1882     1.3832  -5.197 2.17e-07 ***\nsmokingyes   -6.3218     2.0852  -3.032  0.00245 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.24 on 2750 degrees of freedom\n  (7 observations deleted due to missingness)\nMultiple R-squared:  0.08872,   Adjusted R-squared:  0.08707 \nF-statistic: 53.55 on 5 and 2750 DF,  p-value: &lt; 2.2e-16\n\nconfint(mod_com)\n\n                 2.5 %       97.5 %\n(Intercept)  72.560556 106.87633140\nexerciseyes  -6.284288  -0.71838376\nBMI           1.372648   1.87237829\nage          -0.490288  -0.07822204\ndrinkanyyes  -9.900321  -4.47606535\nsmokingyes  -10.410451  -2.23321159\n\n\n\n\nInteracci√≥n\nSe quiere evaluar en el modelo de efectos principales del programa de actividad fisica sobre la glucosa la posibilidad de una heterogeneidad de efectos mediada por el indice de masa corporal. Para este proposito se ajusto un modelo con un termino de interacci√≥n, entre BMI y el programa de ejercicio:\n\nEscribe la ecuaci√≥n del modelo con el termino de interacci√≥n:\n\n\nmod2 &lt;- lm(formula = glucose ~ exercise + BMI + exercise:BMI, data = hers)\nsummary(mod2)\n\n\nCall:\nlm(formula = glucose ~ exercise + BMI + exercise:BMI, data = hers)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-84.543 -18.890 -10.382   4.243 193.710 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)      67.2848     4.4908  14.983   &lt;2e-16 ***\nexerciseyes     -17.4940     7.5928  -2.304   0.0213 *  \nBMI               1.6133     0.1504  10.730   &lt;2e-16 ***\nexerciseyes:BMI   0.5211     0.2663   1.957   0.0505 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.44 on 2754 degrees of freedom\n  (5 observations deleted due to missingness)\nMultiple R-squared:  0.07705,   Adjusted R-squared:  0.07604 \nF-statistic: 76.63 on 3 and 2754 DF,  p-value: &lt; 2.2e-16\n\n\n\nDespeje de la ecuaci√≥n de regresi√≥n escrita por ud, el efecto (pendiente) del programa de ejercicio para un BMI de 15.2 y para BMI 54.1, calculelo seg√∫n el modelo estimado e interpr√©telo.\nDespeje de la ecuaci√≥n de regresi√≥n escrita por ud, el efecto (pendiente) del BMI para pertenecer y no al programa de ejercicio, calculelo seg√∫n el modelo estimado e interpr√©telo.\nEl siguiente grafico refuerza tiene coherencia frente al resultado calculado en el punto anterior (efecto de BMI sobre glucosa seg√∫n pertenezca al programa)\n\n\nplot_predictions(mod2, by = c(\"BMI\", \"exercise\"))+\n  theme(axis.text = element_text(size = 20), axis.title = element_text(size = 20))",
    "crumbs": [
      "Regresi√≥n Lineal Multiple"
    ]
  },
  {
    "objectID": "rls.html#actividad",
    "href": "rls.html#actividad",
    "title": "Regresion Lineal Simple",
    "section": "Actividad",
    "text": "Actividad\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento üëâ Documento de Trabajo, copiando y pegando pantallazos de los resultados y sus interpretaciones.\nEl dataset lowbwt que se puede descargar aca üëâ Descargar lowbwt.rds contiene informaci√≥n para una muestra de 100 reci√©n nacidos con bajo peso al nacer. Mediciones de presi√≥n arterial sistolica son guardadas bajo el nombre de sbp y valores de edad gestacional bajo el nombre de gestage.\nDescargue el siguiente archivo denominado Codigo_taller1.R üëâ Descargar Codigo_taller1.R, donde encontrara los c√≥digos necesarios para obtener los resultados solicitados en el taller.",
    "crumbs": [
      "Regresi√≥n Lineal Simple"
    ]
  },
  {
    "objectID": "rls.html#taller-1-regresion-lineal-simple",
    "href": "rls.html#taller-1-regresion-lineal-simple",
    "title": "Regresion Lineal Simple",
    "section": "Taller 1: Regresion Lineal Simple",
    "text": "Taller 1: Regresion Lineal Simple\n\nCon covariable continua\n\nConstruya un grafico de dispersi√≥n de presion artetial sistolica y edad gestacional. Sugiere el grafico acerca de la naturaleza de la relaci√≥n entre las variables (haga una breve interpretacion del grafico).\nUsando la la presion arterial sistolica como variable dependiente (respuesta) y la edad gestacional como la variable explicatoria. Estime una regresion lineal e interprete los coeficientes. ¬øQue significan en palabras?.\nA un nivel de 0.05 de error alfa, contraste la hipotesis nula que el coeficiente asociado a edad gestacional es igual a cero. ¬øQu√© concluye?\nCual es la media estimada de la presi√≥n arterial para la poblaci√≥n de recien nacidos con bajo peso en quienes la edad gestacional es 31 semanas.\nConstruya un intervalo de confianza para la media cuando la edad gestacional es 31 semanas.\n¬øEl modelo ajustado parece ajustar a los datos observados?. comente e interprete el coeficiente de determinaci√≥n, la tasa de error de las predicciones y los gr√°ficos de diagnostico. Interprete cada uno de ellos.\n\n\n\nCon covariable categorica\nLos niveles de glucosa por encima de 125 mg/dL son diagn√≥sticos de diabetes, mientras que niveles en el rango de 100 a 125 mg/dL indican un mayor riesgo de progresar hacia esta condici√≥n seria y cada vez m√°s frecuente. Por ello, resulta de inter√©s determinar si el ejercicio, un factor de estilo de vida modificable, podr√≠a ayudar a las personas sin diabetes a reducir sus niveles de glucosa y, de esta manera, evitar la diabetes.\nResponder de manera definitiva a esta pregunta requerir√≠a un ensayo cl√≠nico aleatorizado, lo cual constituye una tarea dif√≠cil y costosa. Como resultado, preguntas de investigaci√≥n como esta suelen abordarse inicialmente con datos observacionales. Sin embargo, esto se complica por el hecho de que las personas que hacen ejercicio difieren en muchos aspectos de aquellas que no lo hacen, y algunas de esas diferencias podr√≠an explicar cualquier asociaci√≥n no ajustada entre el ejercicio y el nivel de glucosa.\nPara los siguientes puntos se usara los datos del estudio HERS que se puede descargar directamente desde R copian y pegando directamente en la consola el siguinete codigo hers &lt;- rio::import(\"https://regression.ucsf.edu/sites/g/files/tkssra16191/files/wysiwyg/home/data/hersdata.dta\") %&gt;% filter(diabetes == 0). (Debes tener conexi√≥n a internet)\nEn el archivo denominado Codigo_taller1.R üëâ Descargar Codigo_taller1.R se encuentran los c√≥digos para reproducir los resultados necesarios para contestar las siguientes preguntas:\n\nUsando la glucosa como variable dependiente (respuesta) y la actividad f√≠sica como la variable explicatoria. Estime una regresi√≥n lineal e interprete el coeficiente. ¬øQue significan en palabras?. Escriba la ecuaci√≥n de regresi√≥n con los coeficientes estimados.\nA un nivel de 0.05 de error alfa, contraste la hip√≥tesis nula que el coeficiente asociado a actividad f√≠sica al menos 3 veces por semana es igual a cero. ¬øQu√© concluye?\nCual es la media estimada de la glucosa para la poblaci√≥n que no realiza actividad fisica.\nConstruya un intervalo de confianza al 95% para la media en la glucosa de quienes realizan actividad f√≠sica.\n¬øEl modelo ajustado parece ajustar a los datos observados?. comente e interprete el coeficiente de determinaci√≥n, la tasa de error de las predicciones y los gr√°ficos de diagnostico. Interprete cada uno de ellos.",
    "crumbs": [
      "Regresi√≥n Lineal Simple"
    ]
  },
  {
    "objectID": "index.html#objetivos-de-aprendizaje",
    "href": "index.html#objetivos-de-aprendizaje",
    "title": "Modelos de Regresion para Epidemiologos",
    "section": "Objetivos de Aprendizaje",
    "text": "Objetivos de Aprendizaje\n\nAprender el modelo multivariado adecuado para el control de la interacci√≥n y confusi√≥n de variables\nImplementar los modelos multivariados en los an√°lisis de factores de riesgo frente a la enfermedad\nIdentificar los m√©todos adecuados para evaluar relaciones entre dos variables\nDeterminar cu√°l es el mejor m√©todo de an√°lisis cuando la variable principal de resultado es de tipo cuantitativo o categ√≥rico\nAnalizar e interpretar las principales metodolog√≠as estad√≠sticas en el an√°lisis de datos.",
    "crumbs": [
      "Inicio"
    ]
  },
  {
    "objectID": "rlg_simple.html#actividad",
    "href": "rlg_simple.html#actividad",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Actividad",
    "text": "Actividad\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento üëâ Documento de Trabajo.\nEl dataset coronary que se puede descargar aca üëâ Descargar coronary.rds.\nDescargue el siguiente archivo denominado Codigo_taller4.R üëâ Descargar Codigo_taller4.R, donde encontrara los c√≥digos necesarios para obtener los resultados solicitados en el taller.",
    "crumbs": [
      "Regresi√≥n Logistica Simple"
    ]
  },
  {
    "objectID": "rlg_simple.html#taller-1-regresion-logistica-simple",
    "href": "rlg_simple.html#taller-1-regresion-logistica-simple",
    "title": "Regresi√≥n Logistica Simple",
    "section": "Taller 1: Regresion Logistica Simple",
    "text": "Taller 1: Regresion Logistica Simple\n\nCon covariable categorica\n\nUsando la variable cad como variable dependiente (respuesta) y el sexo como la variable explicatoria. Estime una regresion logistica e interprete los coeficientes. ¬øQue significan en palabras?.\nA un nivel de 0.05 de error alfa, contraste la hipotesis nula que el coeficiente asociado a sexo es igual a cero. ¬øQu√© concluye?\nCual es la interpretacion para el coeficiente de sexo ? no olvide exponenciarlo \\(e^{\\beta_1}\\)\nRealice una predicci√≥n de probabilidad de enfermedad cardiaca si se es mujer no olvide interpretar el intervalo de confianza.\n\n\n\nCon covariable numerica\n\nUsando la variable cad como variable dependiente (respuesta) y el colesterol como la variable explicatoria. Estime una regresion logistica e interprete los coeficientes. ¬øQue significan en palabras?.\nA un nivel de 0.05 de error alfa, contraste la hipotesis nula que el coeficiente asociado a colesterol es igual a cero. ¬øQu√© concluye?\nCual es la interpretacion para el coeficiente de colesterol ? no olvide exponenciarlo \\(e^{\\beta_1}\\)\nRealice una predicci√≥n de probabilidad de enfermedad cardiaca si se tiene un colesterol de 248 y luego con colesterol de 140. Si hace la razon de estas dos cantidades estimadas (mayor sobre la menor) a que medida epidemiologica corresponde ? interprete.\nCalcule el OR asociado con un cambio de incremento en el colesterol de 108 mg/dl (es decir pasar de 140 mg/dl a 248mg/dl). Compare con la medida anterior, son iguales ?. Explique sus razones por que si o porqu√© no?.",
    "crumbs": [
      "Regresi√≥n Logistica Simple"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#utilidad-prop√≥sitos-primarios-de-los-modelos-en-epidemiolog√≠a",
    "href": "diapositivas/generalidades.html#utilidad-prop√≥sitos-primarios-de-los-modelos-en-epidemiolog√≠a",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Utilidad: Prop√≥sitos Primarios de los Modelos en Epidemiolog√≠a:",
    "text": "Utilidad: Prop√≥sitos Primarios de los Modelos en Epidemiolog√≠a:\nLa regresi√≥n puede ser una herramienta poderosa para direccionar tres preguntas relevantes:\n\nPredicci√≥n (En la era de la IA)\nAislar el efecto de una exposici√≥n/covariable\nComprender la relaciones de m√∫ltiples exposiciones hacia un efecto (confusi√≥n - interacci√≥n - mediaci√≥n)",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelos-de-predicci√≥n",
    "href": "diapositivas/generalidades.html#modelos-de-predicci√≥n",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Modelos de Predicci√≥n",
    "text": "Modelos de Predicci√≥n\n\nLos modelos de predicci√≥n se emplean para estimar el riesgo o efecto (o alguna otra medida epidemiol√≥gica).\nEsta estimaci√≥n se basa en la informaci√≥n proporcionada por los predictores o covariables.\n\nEjemplo: Una ecuaci√≥n puede estimar el riesgo de un ataque card√≠aco durante un per√≠odo de 10 a√±os, bas√°ndose en la combinaci√≥n de predictores como edad, sexo, historial familiar, presi√≥n arterial, historial de tabaquismo, peso, altura, h√°bitos de ejercicio e historial m√©dico.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelos-de-explicaci√≥n",
    "href": "diapositivas/generalidades.html#modelos-de-explicaci√≥n",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Modelos de Explicaci√≥n",
    "text": "Modelos de Explicaci√≥n\n\nEstimar efecto (fuerza de asociaci√≥n) de consumo cigarrillo con el c√°ncer g√°strico bajo diferentes niveles de exposici√≥n al consumo de embutidos. En esta relaci√≥n podr√≠a el consumo de embutidos actuar como confusor o modificador de efecto (Interacci√≥n).\n\nDiagramas DAG\nEstimaciones (Descriptivas) en sub-poblaciones (Mas eficientemente)\n\nAplicaci√≥n de Estimaci√≥n de prevalencias ajustadas en subpoblaciones (VIH)",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelos-de-regresi√≥n-clasicos",
    "href": "diapositivas/generalidades.html#modelos-de-regresi√≥n-clasicos",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Modelos de Regresi√≥n clasicos",
    "text": "Modelos de Regresi√≥n clasicos\n\nUna variable dependiente (Nivel de medici√≥n)\nUna o m√°s variables independientes (Continua, categorica dicotomica, cateogica politomica)",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelos-seg√∫n-la-variable-dependiente",
    "href": "diapositivas/generalidades.html#modelos-seg√∫n-la-variable-dependiente",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Modelos seg√∫n la variable dependiente",
    "text": "Modelos seg√∫n la variable dependiente\n\n\n\n\n\n\n\nTipo de variable dependiente\nModelo estad√≠stico\n\n\n\n\nContinua\nRegresi√≥n lineal\n\n\nBinaria (s√≠/no)\nRegresi√≥n log√≠stica\n\n\nConteo (n√∫mero de eventos)\nRegresi√≥n de Poisson / Binomial Negativa\n\n\nTiempo hasta evento\nModelos de supervivencia (Cox, param√©tricos)\n\n\nOrdinal (categor√≠as ordenadas)\nRegresi√≥n log√≠stica ordinal\n\n\nNominal (categor√≠as no ordenadas)\nRegresi√≥n log√≠stica multinomial",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#ejemplos-en-epidemiolog√≠a",
    "href": "diapositivas/generalidades.html#ejemplos-en-epidemiolog√≠a",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Ejemplos en Epidemiolog√≠a",
    "text": "Ejemplos en Epidemiolog√≠a\n\n\n\n\n\n\n\n\n\nTipo de variable dependiente\nModelo\nEjemplo aplicado\n\n\n\n\nContinua\nRegresi√≥n lineal\nRelaci√≥n entre presi√≥n arterial sist√≥lica y edad en adultos\n\n\nBinaria\nRegresi√≥n log√≠stica\nProbabilidad de tener tuberculosis seg√∫n contacto previo\n\n\nConteo\nRegresi√≥n de Poisson / Binomial Negativa\nN√∫mero de casos de dengue por barrio en un mes\n\n\nTiempo hasta evento\nModelos de supervivencia (Cox, Weibull, etc.)\nTiempo hasta la reca√≠da de pacientes con malaria tras el tratamiento\n\n\nOrdinal\nRegresi√≥n log√≠stica ordinal\nGrado de severidad de la desnutrici√≥n infantil (leve, moderada, severa) en funci√≥n de variables socioecon√≥micas\n\n\nNominal\nRegresi√≥n log√≠stica multinomial\nTipo de desenlace obst√©trico (parto eut√≥cico, ces√°rea, parto instrumental) seg√∫n factores maternos",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#los-modelos-como-representaciones-de-la-realidad",
    "href": "diapositivas/generalidades.html#los-modelos-como-representaciones-de-la-realidad",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Los modelos como representaciones de la realidad",
    "text": "Los modelos como representaciones de la realidad\n\nUn su forma mas simple un modelo estad√≠stico es una representaci√≥n matem√°tica simplificada de un fen√≥meno real.\n\nEl Modelo Lineal Generalizado (GLM) se basa en expresar la variable dependiente como funci√≥n lineal de las variables independientes.\n\nLa idea central es que la relaci√≥n entre la variable dependiente y los predictores se asume lineal en los par√°metros.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#expresi√≥n-matem√°tica",
    "href": "diapositivas/generalidades.html#expresi√≥n-matem√°tica",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Expresi√≥n matem√°tica",
    "text": "Expresi√≥n matem√°tica\nModelo Lineal generalizado simple\n\\[ E(Y \\mid X_1, X_2, \\ldots, X_i) = \\beta_0 + \\beta_1 X_1\\]\nDonde:\n- \\(E(Y \\mid X)\\): valor esperado de \\(Y\\) dado los predictores.\n- \\(\\beta_0\\): intercepto. (donde la linea atraviesa el Eje Y)\n- \\(\\beta_1\\): coeficiente que representan el efecto de cada variable \\(X_1\\).",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelo-lineal-generalizado",
    "href": "diapositivas/generalidades.html#modelo-lineal-generalizado",
    "title": "Generalidades sobre Modelos de Regresi√≥n en Epidemiologia",
    "section": "Modelo Lineal generalizado",
    "text": "Modelo Lineal generalizado\n\\[ E(Y \\mid X_1, X_2, \\ldots, X_i) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\cdots + \\beta_i X_i\\]\nDonde:\n- \\(E(Y \\mid X)\\): valor esperado de \\(Y\\) dado los predictores.\n- \\(\\beta_0\\): intercepto.\n- \\(\\beta_j\\): coeficientes que representan el efecto de cada variable \\(X_j\\).",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/rlgm.html#conjunto-de-datos-stroke.rds",
    "href": "diapositivas/rlgm.html#conjunto-de-datos-stroke.rds",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Conjunto de datos: stroke.rds",
    "text": "Conjunto de datos: stroke.rds\n\nUsaremos el dataset stroke.rds en formato R.¬†üëâ Descargar stroke.rds\n\nContiene 226 observaciones y 7 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripci√≥n\n\n\n\n\nstatus\nEstado del paciente durante la hospitalizaci√≥n ( 0 vivo / 1 fallecido)\n\n\ngcs\nEscala de Glasgow al ingreso (3‚Äì15)\n\n\nstroke_type\nTipo de ictus (0 = isqu√©mico; 1 = hemorr√°gico)\n\n\nsex\nSexo biol√≥gico (1 femenino / 0masculino)\n\n\ndm\nHistoria de diabetes (s√≠ / no)\n\n\nsbp\nPresi√≥n arterial sist√≥lica (mmHg)\n\n\nage\nEdad al ingreso (a√±os)"
  },
  {
    "objectID": "diapositivas/rlgm.html#necesidad-bivariado-vs-multivariado",
    "href": "diapositivas/rlgm.html#necesidad-bivariado-vs-multivariado",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Necesidad: Bivariado vs Multivariado",
    "text": "Necesidad: Bivariado vs Multivariado\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n0 N = 1711\n1 N = 551\np-value2\n\n\n\n\nsex\n81 (47%)\n16 (29%)\n0.017\n\n\nStroke Haemorrhagic\n39 (23%)\n38 (69%)\n&lt;0.001\n\n\n\n1 n (%)\n\n\n2 Pearson‚Äôs Chi-squared test"
  },
  {
    "objectID": "diapositivas/rlgm.html#regresi√≥n-logistica-multiple",
    "href": "diapositivas/rlgm.html#regresi√≥n-logistica-multiple",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Regresi√≥n Logistica Multiple",
    "text": "Regresi√≥n Logistica Multiple\n\nLa Regresi√≥n Logistica Mutiple modela la relaci√≥n lineal entre:\n\nUna variable dependiente categorica (ej. Status).\n\ny dos o mas predictores (num√©ricos y categ√≥ricos).\n\n\nExpresi√≥n matem√°tica\n\\[E(Y \\mid X_1,X_2,\\dots X_i) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\dots + \\beta_iX_i\\] \\(E(Y) = P(Y)\\) Recordar que \\(Y = [0,1]\\) si se asume asi los valores de \\(Y\\) estimados por el modelo lineal simple siempre los valores estimados de \\(Y\\) se salen de \\(0\\) o de \\(1\\)."
  },
  {
    "objectID": "diapositivas/rlgm.html#modelo-enlace-y-probabilidades",
    "href": "diapositivas/rlgm.html#modelo-enlace-y-probabilidades",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Modelo, enlace y probabilidades",
    "text": "Modelo, enlace y probabilidades\n\\[Odds = \\frac{P(Y/X_i)}{1-P(Y/X_i)}\\] el logaritmo de Odds \\(Log(odds)\\) si es lineal en terminos de una covariable, y se llama el logit.\n\\[\n\\log(\\frac{P(Y/X_i)}{1-P(Y/X_i)}) = \\beta_0 + \\beta_1X + \\dots +\\beta_iX_i\n\\]\n\\[\nP(Y/X_i)=\\frac{1}{1+e^{-\\left(\\beta_0 + \\beta_1X_1 + \\dots +\\beta_iX_i\\right)}}\n\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#estimaci√≥n-por-m√°xima-verosimilitud",
    "href": "diapositivas/rlgm.html#estimaci√≥n-por-m√°xima-verosimilitud",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Estimaci√≥n por M√°xima Verosimilitud",
    "text": "Estimaci√≥n por M√°xima Verosimilitud\n\nLa idea central es elegir los par√°metros \\(\\beta_0, \\beta_1, \\dots \\beta_i\\) que maximizan la probabilidad de observar los datos.\n\n\\[\nL(P(\\beta_0,\\beta_1,\\dots,\\beta_i/Y,X_i))=\\sum_{i=1}^n\\Big[y_i(\\beta_0+\\beta_1 X_1+\\dots\\beta_i)-\\log\\!\\big(1+e^{\\beta_0+\\beta_1 X_1+\\dots +\\beta_iX_i}\\big)\\Big].\n\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke",
    "href": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke",
    "text": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke\n\nAsumimos que la relaci√≥n lineal en el \\(logit(P)\\) es decir \\(\\log(\\frac{P}{1-P})\\)\n\n\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -0.8362480  0.1917084 -4.362084 1.288295e-05\nsex         -0.7856124  0.3340625 -2.351693 1.868821e-02\n\n\nAhora ajustemos un nuevo modelo que incluya el efecto que pueda tener el tipo de stroke, el modelo seria:\n\\[\\log(odds) = \\beta_0 + \\beta_1sex + \\beta_2strokeType\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke-1",
    "href": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke-1",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke",
    "text": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke"
  },
  {
    "objectID": "diapositivas/rlgm.html#el-modelo-es-adecuado",
    "href": "diapositivas/rlgm.html#el-modelo-es-adecuado",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "¬øEl modelo es adecuado?",
    "text": "¬øEl modelo es adecuado?\nPrueba chi-cuadrado\nminimizar la perdida de informacion Deviance residual comparada con la nula.\n\nresiduos_log_1 &lt;- modelo_mult$null.deviance - modelo_mult$deviance\n#Grados de Libertad.\ngrados_log_1 &lt;- modelo_mult$df.null - modelo_mult$df.residual\n#p-value.\npchisq(residuos_log_1, grados_log_1,lower.tail = F)\n\n[1] 4.940062e-10"
  },
  {
    "objectID": "diapositivas/rlgm.html#estimaci√≥n-de-coeficientes",
    "href": "diapositivas/rlgm.html#estimaci√≥n-de-coeficientes",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Estimaci√≥n de coeficientes",
    "text": "Estimaci√≥n de coeficientes\n\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -1.7565411  0.2837494 -6.190467 5.998629e-10\nsex         -0.7611076  0.3643847 -2.088748 3.673045e-02\nstroke_type  2.0141947  0.3483070  5.782815 7.346092e-09\n\n\nRecordar la \\(H_o: \\beta_i = 0\\)"
  },
  {
    "objectID": "diapositivas/rlgm.html#interpretaci√≥n-de-coeficientes",
    "href": "diapositivas/rlgm.html#interpretaci√≥n-de-coeficientes",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Interpretaci√≥n de Coeficientes",
    "text": "Interpretaci√≥n de Coeficientes\n\n\\(\\beta_0\\) es el valor medio que asumen la variable dependiente (\\(\\log(odds)\\)) cuando todas las covariables toman valor cero (Cuidado No aplica siempre o se refiere a una subpoblacion que no es de interes o de proposito)\n\n\\[\\log(odds) = -1.75 - 0.7611sex + 2.01strokeType\\]\nEn nuestro caso, las covariables cero son: Hombre(0), isquemico(0), entonces\n\\[\\log(odds) = -1.75\\] \\[e^{\\log(odds)} = e^{-1.75}\\] \\[odds = 0.173\\]\nConviertanlo en Probabilidad."
  },
  {
    "objectID": "diapositivas/rlgm.html#interpretaci√≥n-de-coeficientes-1",
    "href": "diapositivas/rlgm.html#interpretaci√≥n-de-coeficientes-1",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Interpretaci√≥n de Coeficientes",
    "text": "Interpretaci√≥n de Coeficientes\n\n\\(\\beta_1\\): para obtener interpretaci√≥n de este coeficiente realizamos la siguiente comparaci√≥n de resultados del modelo cuando sexo asume ser constante y la variable stroke_type es hemorragico(1) e isquemico(0)\n\n\n\\[e^{\\log(odds_{hem})} =odds_{hem} = e^{\\beta_0 + \\beta_1sex + \\beta_2(1)}\\]\n\n\n\\[\ne^{\\log(odds_{isq})} = odds_{isq} = e^{\\beta_0+\\beta_1sex+\\beta_2(0)}\n\\]\n\n\n\\[\\frac{odds_{hem}}{odds_{isq}} = \\frac{e^{\\beta_0 + \\beta_1sex+\\beta_2(1)}}{e^{\\beta_0 + \\beta_1sex+\\beta_2(0)}} = e^{\\beta_0 + \\beta_1sex+\\beta_2(1)}e^{-\\beta_0 - \\beta_1sex-\\beta_2(0)} = e^{\\beta_2}\\]\n\n\n¬øSe concluye entonces qu√©?"
  },
  {
    "objectID": "diapositivas/rlgm.html#predicciones-con-el-modelo-para-probabilidades",
    "href": "diapositivas/rlgm.html#predicciones-con-el-modelo-para-probabilidades",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Predicciones con el modelo para probabilidades",
    "text": "Predicciones con el modelo para probabilidades\n\\[P(Y=1/X_i)= \\frac{1}{1 + e^{-(\\beta_0+\\beta_1+\\dots+\\beta_i)}}\\] \\[P(Y=1/sex,stroketype)= \\frac{1}{1 + e^{-(-1.75-0.76sex++2.01stroketype)}}\\]\n\nProbabilidad de fallecer siendo mujer y stroke hemorragico\n\n\npredict(modelo_mult,newdata = data.frame(sex = 1,stroke_type = 1),type = \"response\")\n\n        1 \n0.3767293 \n\n\n\nProbabilidad de fallecer siendo hombre y stroke hemorragico\n\n\npredict(modelo_mult,newdata = data.frame(sex = 0, stroke_type = 1), type = \"response\")\n\n        1 \n0.5640594"
  },
  {
    "objectID": "diapositivas/rlgm.html#inferencia-coeficientes-y-predicciones",
    "href": "diapositivas/rlgm.html#inferencia-coeficientes-y-predicciones",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\n\nsummary(modelo_mult)$coefficients %&gt;% kable()\n\n\n\n\n\nEstimate\nStd. Error\nz value\nPr(&gt;|z|)\n\n\n\n\n(Intercept)\n-1.7565411\n0.2837494\n-6.190467\n0.0000000\n\n\nsex\n-0.7611076\n0.3643847\n-2.088748\n0.0367305\n\n\nstroke_type\n2.0141947\n0.3483070\n5.782815\n0.0000000\n\n\n\n\n\n\nexp(coefficients(modelo_mult))\n\n(Intercept)         sex stroke_type \n  0.1726410   0.4671487   7.4946893 \n\nexp(confint(modelo_mult)) %&gt;% kable()\n\n\n\n\n\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n0.0956288\n0.2926718\n\n\nsex\n0.2238593\n0.9409725\n\n\nstroke_type\n3.8476842\n15.1571568"
  },
  {
    "objectID": "diapositivas/rlgm.html#diagn√≥stico-supuestos",
    "href": "diapositivas/rlgm.html#diagn√≥stico-supuestos",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Diagn√≥stico: Supuestos",
    "text": "Diagn√≥stico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nL de Linealidad: Los valores de (Y) se pueden expresar como una funci√≥n lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre s√≠."
  },
  {
    "objectID": "diapositivas/rlgm.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "href": "diapositivas/rlgm.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)"
  },
  {
    "objectID": "diapositivas/rlgm.html#incluyendo-mas-variables-ejemplo-numerica",
    "href": "diapositivas/rlgm.html#incluyendo-mas-variables-ejemplo-numerica",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Incluyendo mas variables (Ejemplo: numerica)",
    "text": "Incluyendo mas variables (Ejemplo: numerica)\n\nmodelo_new &lt;- glm(formula = status ~ sex + stroke_type + gcs, stroke, family = binomial(link = 'logit'))\nsummary(modelo_new)$coefficients\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept)  2.3012969 0.71127424  3.235457 1.214484e-03\nsex         -0.5124684 0.42794355 -1.197514 2.311062e-01\nstroke_type  1.1189027 0.41587007  2.690510 7.134284e-03\ngcs         -0.3286912 0.05456293 -6.024076 1.700784e-09\n\n\nDebemos evaluar si la inclusi√≥n de la variable glasglow aporta o no al modelo, No Olvidar principio de parsimonia en modelamiento."
  },
  {
    "objectID": "diapositivas/rlgm.html#prueba-chi2",
    "href": "diapositivas/rlgm.html#prueba-chi2",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Prueba \\(\\chi^2\\)",
    "text": "Prueba \\(\\chi^2\\)\ncompara las diferencias entre las deviance entre los modelos, la cual tiene una distribuci√≥n \\(\\chi^2\\).\n\\(H_o: model_1 = model_2\\)\n\nanova(modelo_mult, modelo_new)\n\n  Analysis of Deviance Table\n  \n  Model 1: status ~ sex + stroke_type\n  Model 2: status ~ sex + stroke_type + gcs\n    Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    \n  1       223     207.97                          \n  2       222     162.72  1   45.254 1.731e-11 ***\n  ---\n  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "diapositivas/rlgm.html#aic",
    "href": "diapositivas/rlgm.html#aic",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "AIC",
    "text": "AIC\n\nAIC(modelo_mult, modelo_new)\n\n              df      AIC\n  modelo_mult  3 213.9693\n  modelo_new   4 170.7152"
  },
  {
    "objectID": "diapositivas/rlgm.html#prueba-de-bondad-de-ajuste-o-test-de-hosmer-lemeshow",
    "href": "diapositivas/rlgm.html#prueba-de-bondad-de-ajuste-o-test-de-hosmer-lemeshow",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Prueba de bondad de ajuste o test de Hosmer-Lemeshow",
    "text": "Prueba de bondad de ajuste o test de Hosmer-Lemeshow\n\nCuando llegamos a este punto del an√°lisis, estamos presuponiendo que el modelo contiene todas las variables importantes.\nAhora el siguiente paso es saber lo eficiente que es es modelo a la hora de predecir la variable respuesta. A esto se le llama bondad de ajuste.\nDiremos que un modelo ajusta bien si la diferencia entre los valores observados y los ajustados, es peque√±a."
  },
  {
    "objectID": "diapositivas/rlgm.html#test-de-hosmer-y-lemeshow",
    "href": "diapositivas/rlgm.html#test-de-hosmer-y-lemeshow",
    "title": "Regresi√≥n Logistica Multiple",
    "section": "Test de Hosmer y Lemeshow",
    "text": "Test de Hosmer y Lemeshow\n\\(H_o\\): el modelo se ajusta bien a los datos.\n\\(H_1\\): el modelo no se ajusta bien (mal ajuste).\nüëâ Si \\(p &gt; 0.05\\), no se rechaza \\(H_o\\), lo que sugiere un buen ajuste.\nüëâ Si \\(p &lt; 0.05\\), se rechaza \\(H_o\\), indicando un posible mal ajuste.\n\nhoslem.test(stroke$status, fitted(modelo_new), g = 10)\n\n\n    Hosmer and Lemeshow goodness of fit (GOF) test\n\ndata:  stroke$status, fitted(modelo_new)\nX-squared = 5.911, df = 5, p-value = 0.315"
  },
  {
    "objectID": "diapositivas/RLSM.html#objetivos-de-aprendizaje",
    "href": "diapositivas/RLSM.html#objetivos-de-aprendizaje",
    "title": "Regresion Lineal Simple",
    "section": "Objetivos de aprendizaje",
    "text": "Objetivos de aprendizaje\nDespu√©s de este modulo, se espera que los estudiantes sean capaces de:\n\nEntender el concepto de regresi√≥n lineal simple y regresi√≥n lineal m√∫ltiple\nRealizar un an√°lisis de regresi√≥n lineal simple (ajustar el modelo)\nRealizar regresi√≥n lineal m√∫ltiple (ajuste con m√°s de un predictor)\nEvaluar el ajuste del modelo de regresi√≥n lineal (diagn√≥sticos, \\(R^2\\), residuos, supuestos)\nPresentar e interpretar los resultados del an√°lisis de regresi√≥n lineal (coeficientes, intervalos, significado)"
  },
  {
    "objectID": "diapositivas/RLSM.html#conjunto-de-datos-coronary.rds",
    "href": "diapositivas/RLSM.html#conjunto-de-datos-coronary.rds",
    "title": "Regresion Lineal Simple",
    "section": "Conjunto de datos: coronary.rds",
    "text": "Conjunto de datos: coronary.rds\n\nUsaremos el dataset coronary.rds en formato R.¬†üëâ Descargar coronary.rds\n\nCorresponde a un ensayo cl√≠nico hipot√©tico con informaci√≥n de caracter√≠sticas individuales, niveles de colesterol total y grupos de intervenci√≥n.\n\nContiene 200 observaciones y 9 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripci√≥n\n\n\n\n\nid\nIdentificaci√≥n del sujeto\n\n\ncad\nEstado de enfermedad coronaria (categ√≥rica: sin CAD, con CAD)\n\n\nsbp\nPresi√≥n arterial sist√≥lica (mmHg, num√©rica)\n\n\ndbp\nPresi√≥n arterial diast√≥lica (mmHg, num√©rica)\n\n\nchol\nColesterol total (mmol/L, num√©rica)\n\n\nage\nEdad en a√±os (num√©rica)\n\n\nbmi\n√çndice de masa corporal (num√©rica)\n\n\nrace\nRaza (categ√≥rica: malayo, chino, indio)\n\n\ngender\nSexo (categ√≥rica: mujer, hombre)"
  },
  {
    "objectID": "diapositivas/RLSM.html#introducci√≥n-a-la-regresi√≥n-lineal",
    "href": "diapositivas/RLSM.html#introducci√≥n-a-la-regresi√≥n-lineal",
    "title": "Regresion Lineal Simple",
    "section": "Introducci√≥n a la Regresi√≥n Lineal",
    "text": "Introducci√≥n a la Regresi√≥n Lineal\n\nLa regresi√≥n lineal es uno de los an√°lisis estad√≠sticos m√°s comunes en las ciencias de la salud.\nModela la relaci√≥n lineal (recta) entre una variable resultado num√©rica (por ejemplo colesterol, presi√≥n arterial, IMC) y predictores que pueden ser num√©ricos o categ√≥ricos.\nEn t√©rminos ‚Äúcoloquiales‚Äù, podr√≠amos estar interesados en saber c√≥mo var√≠a (distribuci√≥n) el nivel de colesterol en terminos de distintas variables.\nLa regresi√≥n lineal es un caso particular del Modelo Lineal Generalizado (GLM); los modelos que veremos m√°s adelante (log√≠stico)."
  },
  {
    "objectID": "diapositivas/RLSM.html#regresi√≥n-lineal-simple",
    "href": "diapositivas/RLSM.html#regresi√≥n-lineal-simple",
    "title": "Regresion Lineal Simple",
    "section": "Regresi√≥n Lineal Simple",
    "text": "Regresi√≥n Lineal Simple\n\nLa Regresi√≥n Lineal Simple (RLS) modela la relaci√≥n lineal entre:\n\nUna variable dependiente num√©rica (ej. colesterol).\n\nUn √∫nico predictor (num√©rico o categ√≥rico).\n\nCuando el predictor es categ√≥rico, se puede interpretar como un ANOVA de una v√≠a.\n\nExpresi√≥n matem√°tica\n\\[\nE(Y \\mid X) = \\beta_0 + \\beta_1 X\n\\]\nDonde:\n- \\(E(Y \\mid X)\\): valor esperado (predicho) (promedio) de la variable dependiente dado \\(X\\).\n- \\(\\beta_0\\): intercepto.\n- \\(\\beta_1\\): coeficiente del predictor \\(X\\)."
  },
  {
    "objectID": "diapositivas/RLSM.html#estimaci√≥n-por-m√°xima-verosimilitud-caso-1-covariable",
    "href": "diapositivas/RLSM.html#estimaci√≥n-por-m√°xima-verosimilitud-caso-1-covariable",
    "title": "Regresion Lineal Simple",
    "section": "Estimaci√≥n por M√°xima Verosimilitud (caso 1 covariable)",
    "text": "Estimaci√≥n por M√°xima Verosimilitud (caso 1 covariable)\n\nLa idea central es elegir los par√°metros \\(\\beta_0, \\beta_1\\) que maximizan la probabilidad de observar los datos.\n\nSupuestos b√°sicos\n\nLos errores \\(\\varepsilon_i\\) se asumen independientes y distribuidos:\n\\(\\varepsilon_i \\sim N(0, \\sigma^2)\\)\nEntonces:\n\\[\nY_i \\sim N(\\beta_0 + \\beta_1 X_i, \\, \\sigma^2)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM.html#funci√≥n-de-verosimilitud",
    "href": "diapositivas/RLSM.html#funci√≥n-de-verosimilitud",
    "title": "Regresion Lineal Simple",
    "section": "Funci√≥n de verosimilitud",
    "text": "Funci√≥n de verosimilitud\n\\[\nL(\\beta_0, \\beta_1, \\sigma^2 \\mid Y)\n= \\prod_{i=1}^n\n\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{(Y_i - \\beta_0 - \\beta_1 X_i)^2}{2\\sigma^2} \\right)\n\\]\nEstimadores MLE\n\\[\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^n (X_i - \\bar{X})^2}\n\\]\n\\[\n\\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X}\n\\]\n\n\n\\(\\widehat{\\sigma}^2 = \\frac{1}{n-2} \\sum_{i=1}^n \\left( Y_i - \\hat{Y}_i \\right)^2\\)\n\n\\(SE(\\hat{\\beta}_1) = \\sqrt{ \\frac{\\widehat{\\sigma}^2}{\\sum_{i=1}^n (X_i - \\bar{X})^2} }\\)\n\\(SE(\\hat{\\beta}_0) = \\sqrt{ \\widehat{\\sigma}^2 \\left( \\frac{1}{n} + \\frac{\\bar{X}^2}{\\sum_{i=1}^n (X_i - \\bar{X})^2} \\right) }\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-colesterol-en-funcion-de-la-presi√≥n-arterial-sistolica",
    "href": "diapositivas/RLSM.html#modelo-colesterol-en-funcion-de-la-presi√≥n-arterial-sistolica",
    "title": "Regresion Lineal Simple",
    "section": "Modelo: Colesterol en funcion de la Presi√≥n arterial sistolica",
    "text": "Modelo: Colesterol en funcion de la Presi√≥n arterial sistolica\nObjetivo: Se requiere predecir los valores de colesterol de pacientes cuando se conoce su presion arterial sistolica.\n\nAsumimos que la relaci√≥n entre las variables es lineal \\(r = 0.39\\)\nSegun el modelo lineal planteado seria:\n\n\\[\\mu_{chol} = \\beta_0 + \\beta_1 \\times sbp\\]\nQue valores asumen \\(\\beta_0\\) y \\(\\beta_1\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#ajuste-del-modelo",
    "href": "diapositivas/RLSM.html#ajuste-del-modelo",
    "title": "Regresion Lineal Simple",
    "section": "Ajuste del modelo",
    "text": "Ajuste del modelo\n\nmodelo_simple &lt;- lm(data = coronary, formula = chol~sbp)\nsummary(modelo_simple)"
  },
  {
    "objectID": "diapositivas/RLSM.html#el-modelo-es-adecuado",
    "href": "diapositivas/RLSM.html#el-modelo-es-adecuado",
    "title": "Regresion Lineal Simple",
    "section": "¬øel modelo es adecuado?",
    "text": "¬øel modelo es adecuado?\nPrueba F\nF-statistic: 36.52 on 1 and 198 DF,  p-value: 7.377e-09: el modelo es significativo, con la sbp se permite explicar el chol.\nError estandar residual\nResidual standard error: 19.6 para saber que tan grande es: Tasa de error de predicci√≥n:\nsummary(modelo_simple)$sigma/mean(coronary$chol)*100\n[1] 17.58923\nUna tasas de error de 17.6%\nCoeficiente de determinacion \\(R^2\\)\nsummary(modelo_simple)$r.squared\n[1] 0.1557222\nEl ajuste es regular, se explica el 15.5% de la variabilidad del Colesterol"
  },
  {
    "objectID": "diapositivas/RLSM.html#estimaci√≥n-de-coeficientes",
    "href": "diapositivas/RLSM.html#estimaci√≥n-de-coeficientes",
    "title": "Regresion Lineal Simple",
    "section": "Estimaci√≥n de coeficientes",
    "text": "Estimaci√≥n de coeficientes\nmodelo_simple &lt;- lm(data = coronary, formula = chol~1)\n\nsummary(modelo_simple)$coefficients\n        Estimate Std. Error  t value      Pr(&gt;|t|)\n(Intercept) 111.5737 1.506458 74.06359 8.021754e-147\nmean(coronary$chol)\n[1] 111.5737\ncon covariable\nmodelo_simple &lt;- lm(data = coronary, formula = chol~sbp)\nsummary(modelo_simple)$coefficients %&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n56.3342138\n9.2455346\n6.093127\n0\n\n\nsbp\n0.4243314\n0.0702166\n6.043176\n0\n\n\n\nModelo completo: \\(\\mu_{chol} = 56.33 + 0.42 \\times sbp\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#interpretaci√≥n-de-coeficientes",
    "href": "diapositivas/RLSM.html#interpretaci√≥n-de-coeficientes",
    "title": "Regresion Lineal Simple",
    "section": "Interpretaci√≥n de Coeficientes",
    "text": "Interpretaci√≥n de Coeficientes\n\n\\(\\beta_0\\) es el valor medio que asumen la variable dependiente cuando la covariable toma valor cero. (unidades de la variable dependiente)\n\\(\\beta_1\\): Es el cambio en promedio que tiene la variable dependiente por unidad de cambio de la covariable.\n\n\\[\\mu_{chol} = 56.33 + 0.42 \\times sbp\\]\nEl colesterol cambia en promedio en 0.42 mg/dl por cada mmHg de presi√≥n arterial sistolica.\nAhora si estariamos en capacidad de predecir cual es el valor medio del colesterol para un sujeto que tiene 120 mmHg de presion arterial sistolica."
  },
  {
    "objectID": "diapositivas/RLSM.html#predicciones-con-el-modelo",
    "href": "diapositivas/RLSM.html#predicciones-con-el-modelo",
    "title": "Regresion Lineal Simple",
    "section": "Predicciones con el modelo",
    "text": "Predicciones con el modelo\npredict(modelo_simple,newdata = data.frame(sbp = 120))\n  1 \n107.254\npredict(modelo_simple,newdata = data.frame(sbp = 180))\n   1 \n132.7139"
  },
  {
    "objectID": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones",
    "href": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones",
    "title": "Regresion Lineal Simple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\nContrastes de hip√≥tesis\n\n\\(H_0: \\beta_j = 0\\)\n\\(H_a: \\beta_j \\neq 0\\) para \\(j=0,1\\)\nEstad√≠stico de prueba:\n\\[t = \\frac{\\hat{\\beta}_j}{SE(\\hat{\\beta}_j)} \\sim t_{n-p-1}\\]\n\nIntervalos de confianza\n\nA un nivel de confianza \\(1-\\alpha\\):\n\\[\nIC_{1-\\alpha}(\\beta_j) = \\hat{\\beta}_j \\;\\pm\\; t_{\\alpha/2, \\, n-p-1} \\times SE(\\hat{\\beta}_j)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones-1",
    "href": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones-1",
    "title": "Regresion Lineal Simple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\nsummary(modelo_simple)$coefficients %&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n56.3342138\n9.2455346\n6.093127\n0\n\n\nsbp\n0.4243314\n0.0702166\n6.043176\n0\n\n\n\nconfint(modelo_simple) %&gt;% kable()\n\n\n\n\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n38.101858\n74.5665696\n\n\nsbp\n0.285863\n0.5627998"
  },
  {
    "objectID": "diapositivas/RLSM.html#inferencia-en-predicciones",
    "href": "diapositivas/RLSM.html#inferencia-en-predicciones",
    "title": "Regresion Lineal Simple",
    "section": "Inferencia en predicciones",
    "text": "Inferencia en predicciones\npredictions(modelo_simple, newdata = data.frame(sbp = c(120,180))) %&gt;% \n  select(2:9) %&gt;% \n  kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\nsbp\n\n\n\n\n107.25\n1.56\n68.71\n0\nInf\n104.19\n110.31\n120\n\n\n132.71\n3.76\n35.26\n0\n902.53\n125.34\n140.09\n180\n\n\n\n\n\navg_comparisons(modelo_simple,variables = list(sbp = c(120, 180))) %&gt;%\n  select(3:9) %&gt;% \n  kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\n\n\n\n\n25.46\n4.21\n6.04\n0\n29.3\n17.2\n33.72"
  },
  {
    "objectID": "diapositivas/RLSM.html#diagn√≥stico-supuestos",
    "href": "diapositivas/RLSM.html#diagn√≥stico-supuestos",
    "title": "Regresion Lineal Simple",
    "section": "Diagn√≥stico: Supuestos",
    "text": "Diagn√≥stico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nSupuestos b√°sicos (acr√≥nimo LINE):\nL de Linealidad: Los valores de (Y) se pueden expresar como una funci√≥n lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre s√≠.\nN de Normalidad:Para cualquier valor fijo de (X), los valores de (Y) (o los errores/residuos) se distribuyen normalmente.\nE de Equitatividad (Homoscedasticidad): La variaci√≥n de los valores de (Y) (o los errores/residuos) alrededor de la l√≠nea de regresi√≥n es constante."
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nLinealidad y homocedasticidad: sin patrones Causas: modelo no lineal, falta de variables explicativas, interacci√≥n."
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-1",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-1",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nFalta de Normalidad: Otro modelos lineales generalizados"
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-2",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-2",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nHomogeneidad de la varianza: Transformaciones"
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-3",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificaci√≥n-de-supuestos-3",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificaci√≥n de supuestos)",
    "text": "Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n\n\n\n\n\nIdentificar valores inusuales e influyentes: Transformaciones."
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-de-regresi√≥n-lineal-simple-con-una-covariablepredictor-categorico",
    "href": "diapositivas/RLSM.html#modelo-de-regresi√≥n-lineal-simple-con-una-covariablepredictor-categorico",
    "title": "Regresion Lineal Simple",
    "section": "Modelo de regresi√≥n lineal simple con una covariable/predictor categorico",
    "text": "Modelo de regresi√≥n lineal simple con una covariable/predictor categorico\n\\[E(Y \\mid X) = \\beta_0 + \\beta_1 X\\]\n\\(X\\) = En el caso que sea binaria, el modelo asume codificaci√≥n (\\(1=\\) Presencia, \\(0=\\) Ausencia)\n\\(E(Y \\mid X) = \\beta_0 + \\beta_1 \\times (1)\\) indicar√≠a el cambio en la variable dependiente ante la presencia de la condici√≥n que fue codificada como \\(1\\).\n\\(E(Y \\mid X) = \\beta_0 + \\beta_1 \\times (0)\\)\n\\(E(Y \\mid X) = \\beta_0\\) indicar√≠a el cambio en la variable dependiente ante la ausencia de la condici√≥n que fue codificada como \\(0\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-lineal-con-covariable-categorica",
    "href": "diapositivas/RLSM.html#modelo-lineal-con-covariable-categorica",
    "title": "Regresion Lineal Simple",
    "section": "Modelo lineal con covariable categorica",
    "text": "Modelo lineal con covariable categorica\nmodelo_cat &lt;- lm(formula = chol ~ cad, coronary)"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-estimado",
    "href": "diapositivas/RLSM.html#modelo-estimado",
    "title": "Regresion Lineal Simple",
    "section": "modelo Estimado",
    "text": "modelo Estimado\n\\[E(Y \\mid X) = 109.855 + 9.9 \\times cad\\]\nDonde \\(cad = 0,1\\)\n\\(\\beta_1\\) es el cambio o diferencia promedio que hay en los niveles de colesterol entre pacientes con y sin enfermedad cardiovascular.\n\nRealicemos predicci√≥n de la media de colesterol para pacientes con enfermedad\nRealicemos predicci√≥n de la media de colesterol para pacientes sin enfermedad"
  },
  {
    "objectID": "diapositivas/RLSM.html#variable-categorica-politomica",
    "href": "diapositivas/RLSM.html#variable-categorica-politomica",
    "title": "Regresion Lineal Simple",
    "section": "Variable categorica politomica",
    "text": "Variable categorica politomica\n\nSe debe representar cada categoria de la variable en el modelo, dejando como 1 la presencial de la categoria y 0 las demas (variable dummy)\n\n\n\n\n\\(X=\\) Malayo\n\\(X=\\) Chino\n\\(X =\\) Hindu\n\n\n\n\n1\n0\n0\n\n\n0\n1\n0\n\n\n0\n0\n1"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-con-variable-categorica-politomica",
    "href": "diapositivas/RLSM.html#modelo-con-variable-categorica-politomica",
    "title": "Regresion Lineal Simple",
    "section": "modelo con variable categorica politomica",
    "text": "modelo con variable categorica politomica\n\nmodelo_cat2 &lt;- lm(formula = chol ~ race, coronary)\nsummary(modelo_cat2)"
  }
]