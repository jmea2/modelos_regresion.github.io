[
  {
    "objectID": "diapositivas/RLSM_2.html#objetivos-de-aprendizaje",
    "href": "diapositivas/RLSM_2.html#objetivos-de-aprendizaje",
    "title": "Regresion Lineal Multiple",
    "section": "Objetivos de aprendizaje",
    "text": "Objetivos de aprendizaje\nDespués de este modulo, se espera que los estudiantes sean capaces de:\n\nEntender el concepto de regresión lineal simple y regresión lineal múltiple\nRealizar un análisis de regresión lineal simple (ajustar el modelo)\nRealizar regresión lineal múltiple (ajuste con más de un predictor)\nEvaluar el ajuste del modelo de regresión lineal (diagnósticos, \\(R^2\\), residuos, supuestos)\nPresentar e interpretar los resultados del análisis de regresión lineal (coeficientes, intervalos, significado)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#conjunto-de-datos-coronary.rds",
    "href": "diapositivas/RLSM_2.html#conjunto-de-datos-coronary.rds",
    "title": "Regresion Lineal Multiple",
    "section": "Conjunto de datos: coronary.rds",
    "text": "Conjunto de datos: coronary.rds\n\nUsaremos el dataset coronary.rds en formato R. 👉 Descargar coronary.rds\n\nCorresponde a un ensayo clínico hipotético con información de características individuales, niveles de colesterol total y grupos de intervención.\n\nContiene 200 observaciones y 9 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripción\n\n\n\n\nid\nIdentificación del sujeto\n\n\ncad\nEstado de enfermedad coronaria (categórica: sin CAD, con CAD)\n\n\nsbp\nPresión arterial sistólica (mmHg, numérica)\n\n\ndbp\nPresión arterial diastólica (mmHg, numérica)\n\n\nchol\nColesterol total (mmol/L, numérica)\n\n\nage\nEdad en años (numérica)\n\n\nbmi\nÍndice de masa corporal (numérica)\n\n\nrace\nRaza (categórica: malayo, chino, indio)\n\n\ngender\nSexo (categórica: mujer, hombre)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#regresión-lineal-multiple",
    "href": "diapositivas/RLSM_2.html#regresión-lineal-multiple",
    "title": "Regresion Lineal Multiple",
    "section": "Regresión Lineal Multiple",
    "text": "Regresión Lineal Multiple\n\nLa Regresión Lineal Multiple (RLM) modela la relación lineal entre:\n\nUna variable dependiente numérica (ej. colesterol).\n\ndos o más predictores (numéricas y categóricas).\n\n\nExpresión matemática\n\\[\nE(Y \\mid X_1,X_2,X_3 \\dots X_i) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\beta_3 X_3 + \\dots \\beta_i X_i\n\\]\nDonde:\n- \\(E(Y \\mid X_i)\\): valor esperado (predicho) (promedio) de la variable dependiente dado las \\(X_i\\).\n- \\(\\beta_0\\): intercepto.\n- \\(\\beta_i\\): coeficientes de cada predictor \\(X_i\\)."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#estimación-por-máxima-verosimilitud-caso-1-covariable",
    "href": "diapositivas/RLSM_2.html#estimación-por-máxima-verosimilitud-caso-1-covariable",
    "title": "Regresion Lineal Multiple",
    "section": "Estimación por Máxima Verosimilitud (caso 1 covariable)",
    "text": "Estimación por Máxima Verosimilitud (caso 1 covariable)\n\nLa idea central es elegir los parámetros \\(\\beta_i\\) que maximizan la probabilidad de observar los datos.\n\nSupuestos básicos\n\nLos errores \\(\\varepsilon_i\\) se asumen independientes y distribuidos:\n\\(\\varepsilon_i \\sim N(0, \\sigma^2)\\)\nEntonces:\n\\[\nY_i \\sim N(\\beta_0 + \\beta_1 X_i, \\, \\sigma^2)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#función-de-verosimilitud",
    "href": "diapositivas/RLSM_2.html#función-de-verosimilitud",
    "title": "Regresion Lineal Multiple",
    "section": "Función de verosimilitud",
    "text": "Función de verosimilitud\n\\[\nL(\\beta_0, \\beta_1,\\dots \\beta_p \\sigma^2 \\mid Y)\n= \\prod_{i=1}^n\n\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{(Y_i - \\beta_0 - \\beta_1 X_{i1} - \\dots \\beta_p X_{ip})^2}{2\\sigma^2} \\right)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#estimadores-mle",
    "href": "diapositivas/RLSM_2.html#estimadores-mle",
    "title": "Regresion Lineal Multiple",
    "section": "Estimadores MLE",
    "text": "Estimadores MLE\n\\[\n\\hat{\\beta}_j : \\text{ solucionan }\n\\sum_{i=1}^n X_{ik} Y_i = \\sum_{j=0}^p \\hat{\\beta}_j \\sum_{i=1}^n X_{ik}X_{ij},\n\\quad k=0,\\ldots,p.\n\\]\nVarianza del error\n\\[\n\\hat{\\sigma}^2_{ML} = \\frac{1}{n} \\sum_{i=1}^n\n\\left( Y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 X_{i1} - \\cdots - \\hat{\\beta}_p X_{ip} \\right)^2.\n\\]\nErrores estándar\n\\[\nSE(\\hat{\\beta}_j) =\n\\sqrt{\\hat{\\sigma}^2 \\cdot c_{jj}}, \\quad j=0,\\ldots,p,\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#modelo-colesterol-en-funcion-de-la-presión-arterial-sistolica",
    "href": "diapositivas/RLSM_2.html#modelo-colesterol-en-funcion-de-la-presión-arterial-sistolica",
    "title": "Regresion Lineal Multiple",
    "section": "Modelo: Colesterol en funcion de la Presión arterial sistolica",
    "text": "Modelo: Colesterol en funcion de la Presión arterial sistolica\nObjetivo: Se requiere predecir los valores de colesterol de pacientes cuando se conoce su presion arterial sistolica, presencia de enfermedad cardiaca, sexo, BMI y raza\n\nAsumimos que la relación entre las variables es lineal. (deberia validarse en el bivariado)\nSegun el modelo lineal planteado seria:\n\n\\[\\mu_{chol} = \\beta_0 + \\beta_1 \\times sbp + \\beta_2 \\times gender + \\beta_3 \\times bmi + \\beta_4 \\times race\\]\nQue valores asumen \\(\\beta_i\\)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ajuste-del-modelo",
    "href": "diapositivas/RLSM_2.html#ajuste-del-modelo",
    "title": "Regresion Lineal Multiple",
    "section": "Ajuste del modelo",
    "text": "Ajuste del modelo\n\nmodelo_multiple &lt;- lm(data = coronary, formula = chol~sbp+gender+bmi+race)\nsummary(modelo_multiple)"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#el-modelo-es-adecuado",
    "href": "diapositivas/RLSM_2.html#el-modelo-es-adecuado",
    "title": "Regresion Lineal Multiple",
    "section": "¿el modelo es adecuado?",
    "text": "¿el modelo es adecuado?\nPrueba F\nF-statistic: 10.54 on 5 and 194 DF,  p-value: 5.728e-09: el modelo es significativo, con la las variables se permite explicar el colesterol.\nError estandar residual\nResidual standard error: 19.1 para saber que tan grande es: Tasa de error de predicción:\nsummary(modelo_multiple)$sigma/mean(coronary$chol)*100\n[1] 17.14911\nUna tasas de error de 17.1%\nCoeficiente de determinacion \\(R^2\\) y \\(R^2-ajustado\\)\nsummary(modelo_multiple)$r.squared\n[1] 0.2136579\nsummary(modelo_multiple)$adj.r.squared\n[1] 0.1933913\nEl ajuste es regular, se explica el 19.3% de la variabilidad del Colesterol"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#estimación-de-coeficientes",
    "href": "diapositivas/RLSM_2.html#estimación-de-coeficientes",
    "title": "Regresion Lineal Multiple",
    "section": "Estimación de coeficientes",
    "text": "Estimación de coeficientes\nsummary(modelo_multiple)$coefficients %&gt;% \n  kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n97.6645899\n22.9492296\n4.2556806\n0.0000324\n\n\nsbp\n0.2951363\n0.0772263\n3.8217067\n0.0001784\n\n\ngenderHombre\n1.4950868\n2.7281238\n0.5480275\n0.5843031\n\n\nbmi\n-0.8339743\n0.5142786\n-1.6216390\n0.1065047\n\n\nraceChino\n6.5975186\n3.3579541\n1.9647436\n0.0508717\n\n\nraceHindu\n12.2553353\n3.6901195\n3.3211215\n0.0010712\n\n\n\nModelo completo: \\[\\mu_{chol} = 97.66 + 0.29 \\times sbp + 1.49 \\times gender -0.83 \\times bmi + 6.59 \\times chino + 12.25 \\times hindu\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#interpretación-de-coeficientes",
    "href": "diapositivas/RLSM_2.html#interpretación-de-coeficientes",
    "title": "Regresion Lineal Multiple",
    "section": "Interpretación de Coeficientes",
    "text": "Interpretación de Coeficientes\n\n\\(\\beta_0\\) Representa la respuesta media cuando todos los predictores valen cero. Hay que ser cautos con su interpretación, porque su valor puede no tener un significado práctico.\n\\(\\beta_1\\): las pendientes (o gradientes). Representan el cambio en la respuesta media por unidad de aumento en la variable explicativa asociada, cuando todos los otros predictores se mantienen constantes. Es decir, nos dicen en qué medida cada variable explicativa afecta a la variable respuesta si aislamos los efectos de todos los demás predictores.\n\n\\[\\mu_{chol} = 97.66 + 0.29 \\times sbp + 1.49 \\times gender -0.83 \\times bmi + 6.59 \\times chino + 12.25 \\times hindu\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#predicciones-con-el-modelo-e-inferencia",
    "href": "diapositivas/RLSM_2.html#predicciones-con-el-modelo-e-inferencia",
    "title": "Regresion Lineal Multiple",
    "section": "Predicciones con el modelo e inferencia",
    "text": "Predicciones con el modelo e inferencia\nUn población de sujetos tiene sbp\\(= 120\\), gender \\(=\\) Mujer, bmi \\(= 23\\) race \\(=\\) hindu\npredictions(modelo_multiple, newdata = data.frame(sbp = 120, gender = \"Mujer\",bmi = 23,\n                                                 race = \"Hindu\")) %&gt;% \n  select(2:9) %&gt;% \n   kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\nsbp\n\n\n\n\n126.15\n8.48\n14.88\n0\n163.88\n109.53\n142.78\n120\n\n\n\n\n\npredictions(modelo_multiple, newdata = data.frame(sbp = 180, gender = \"Mujer\",bmi = 23,\n                                                 race = \"Hindu\")) %&gt;% \n  select(2:9) %&gt;% \n   kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\nsbp\n\n\n\n\n143.86\n8.17\n17.62\n0\n228.31\n127.86\n159.87\n180"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#inferencia-coeficientes",
    "href": "diapositivas/RLSM_2.html#inferencia-coeficientes",
    "title": "Regresion Lineal Multiple",
    "section": "Inferencia: Coeficientes",
    "text": "Inferencia: Coeficientes\nsummary(modelo_multiple)$coefficients %&gt;% \n  kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n97.6645899\n22.9492296\n4.2556806\n0.0000324\n\n\nsbp\n0.2951363\n0.0772263\n3.8217067\n0.0001784\n\n\ngenderHombre\n1.4950868\n2.7281238\n0.5480275\n0.5843031\n\n\nbmi\n-0.8339743\n0.5142786\n-1.6216390\n0.1065047\n\n\nraceChino\n6.5975186\n3.3579541\n1.9647436\n0.0508717\n\n\nraceHindu\n12.2553353\n3.6901195\n3.3211215\n0.0010712\n\n\n\nconfint(modelo_multiple) %&gt;% kable()\n\n\n\n\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n52.4025696\n142.9266103\n\n\nsbp\n0.1428253\n0.4474472\n\n\ngenderHombre\n-3.8855032\n6.8756768\n\n\nbmi\n-1.8482694\n0.1803208\n\n\nraceChino\n-0.0252651\n13.2203024\n\n\nraceHindu\n4.9774324\n19.5332382"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#comparación-de-modelo-seleccion-de-variables",
    "href": "diapositivas/RLSM_2.html#comparación-de-modelo-seleccion-de-variables",
    "title": "Regresion Lineal Multiple",
    "section": "Comparación de modelo: Seleccion de variables",
    "text": "Comparación de modelo: Seleccion de variables\n\nSe hace necesario evaluar la contribucion de las variables que ingresan al modelo, ya que un modelo mas parsimonioso (menos variables) y explicando la misma variabilidad es mas deseable.\nComparar un modelo full vs modelo reducido\n\nCriterio de informacion de Akaike AIC\n\nmodelo_multiple_rdc &lt;- lm(formula = chol ~ sbp + bmi + race, data = coronary)\n\nAIC(modelo_multiple, modelo_multiple_rdc) %&gt;% kable()\n\n\n\n\ndf\nAIC\n\n\n\n\nmodelo_multiple\n7\n1756.068\n\n\nmodelo_multiple_rdc\n6\n1754.378"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#comparación-de-modelo-seleccion-de-variables-1",
    "href": "diapositivas/RLSM_2.html#comparación-de-modelo-seleccion-de-variables-1",
    "title": "Regresion Lineal Multiple",
    "section": "Comparación de modelo: Seleccion de variables",
    "text": "Comparación de modelo: Seleccion de variables\nPrueba F Parcial\nLa prueba F parcial evalúa si el modelo completo es significativamente mejor que el modelo reducido (Si la variable excluida contribuye significativamente)\nanova(modelo_multiple, modelo_multiple_rdc) %&gt;% kable()\n\n\n\nRes.Df\nRSS\nDf\nSum of Sq\nF\nPr(&gt;F)\n\n\n\n\n194\n71024.56\nNA\nNA\nNA\nNA\n\n\n195\n71134.51\n-1\n-109.9541\n0.3003341\n0.5843031"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#section",
    "href": "diapositivas/RLSM_2.html#section",
    "title": "Regresion Lineal Multiple",
    "section": "",
    "text": "summary(modelo_multiple_rdc)$coefficients%&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n99.3172356\n22.7093829\n4.373401\n0.0000199\n\n\nsbp\n0.2933061\n0.0770155\n3.808402\n0.0001873\n\n\nbmi\n-0.8540871\n0.5120464\n-1.667988\n0.0969231\n\n\nraceChino\n6.6566350\n3.3501945\n1.986940\n0.0483291\n\n\nraceHindu\n12.4693861\n3.6628016\n3.404330\n0.0008051\n\n\n\nsummary(modelo_multiple)$coefficients%&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n97.6645899\n22.9492296\n4.2556806\n0.0000324\n\n\nsbp\n0.2951363\n0.0772263\n3.8217067\n0.0001784\n\n\ngenderHombre\n1.4950868\n2.7281238\n0.5480275\n0.5843031\n\n\nbmi\n-0.8339743\n0.5142786\n-1.6216390\n0.1065047\n\n\nraceChino\n6.5975186\n3.3579541\n1.9647436\n0.0508717\n\n\nraceHindu\n12.2553353\n3.6901195\n3.3211215\n0.0010712"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#en-modelos-predictivos",
    "href": "diapositivas/RLSM_2.html#en-modelos-predictivos",
    "title": "Regresion Lineal Multiple",
    "section": "En modelos predictivos",
    "text": "En modelos predictivos\nEn comparaciones multiples se hace dificil probar todos los posible modelos, sin embargo un algortimo automatico puede ayudarnos a reducir el trabajo sin perder el criterio epidemiologico:\n\nfinal &lt;- step(modelo_multiple,direction = \"backward\")\n\nsummary(final)$coefficients %&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n99.3172356\n22.7093829\n4.373401\n0.0000199\n\n\nsbp\n0.2933061\n0.0770155\n3.808402\n0.0001873\n\n\nbmi\n-0.8540871\n0.5120464\n-1.667988\n0.0969231\n\n\nraceChino\n6.6566350\n3.3501945\n1.986940\n0.0483291\n\n\nraceHindu\n12.4693861\n3.6628016\n3.404330\n0.0008051"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnóstico-supuestos",
    "href": "diapositivas/RLSM_2.html#diagnóstico-supuestos",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnóstico: Supuestos",
    "text": "Diagnóstico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nSupuestos básicos (acrónimo LINE):\nL de Linealidad: Los valores de (Y) se pueden expresar como una función lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre sí.\nN de Normalidad:Para cualquier valor fijo de (X), los valores de (Y) (o los errores/residuos) se distribuyen normalmente.\nE de Equitatividad (Homoscedasticidad): La variación de los valores de (Y) (o los errores/residuos) alrededor de la línea de regresión es constante."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nLinealidad y homocedasticidad: sin patrones Causas: modelo no lineal, falta de variables explicativas, interacción."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos-1",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos-1",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nFalta de Normalidad: Otro modelos lineales generalizados"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos-2",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos-2",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nHomogeneidad de la varianza: Transformaciones"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos-3",
    "href": "diapositivas/RLSM_2.html#diagnostico-con-graficos-verificación-de-supuestos-3",
    "title": "Regresion Lineal Multiple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nIdentificar valores inusuales e influyentes: Transformaciones."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#confusión",
    "href": "diapositivas/RLSM_2.html#confusión",
    "title": "Regresion Lineal Multiple",
    "section": "Confusión",
    "text": "Confusión\n\nDefinición: Es un efecto sesgado o no real entre una exposición y un desenlace, que ocurre como consecuencia de una variable o unas variables confusoras.\nAlgunas variables pueden ser controladas al inicio del estudio (criterios de inclusión).\nSe presentan comúnmente en estudios observacionales.\nSon declarados en el diseño y medidos sin error"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#confusión-1",
    "href": "diapositivas/RLSM_2.html#confusión-1",
    "title": "Regresion Lineal Multiple",
    "section": "Confusión",
    "text": "Confusión\n\\[E(Y/X) = \\beta_0 + \\beta_1X_1\\]\nPara dos distinto valores \\(X_1\\), \\(A\\) para poblaciones expuestas \\(Y_1\\) y \\(B\\) para no expuestos \\(Y_0\\) la diferencia es representada por:\n\\[E(Y_1)-E(Y_0)= \\beta_0 + \\beta_1A - \\beta_0 - \\beta_1B \\\\= \\beta_1(A-B)\\]\nahora si tenemos en cuenta a \\(X_2\\) en la relacion de \\(Y\\) y \\(X_1\\)\n\\[E(Y/X_1,X_2) = \\beta_0 + \\beta_1X_1 + \\beta_2X_2\\]\nPara valores de \\(X_2\\) distintos \\((C,D)\\) entre expuestos y no expuestos:\n\\[E(Y_1)-E(Y_0)= \\beta_0 + \\beta_1A + \\beta_2C - \\beta_0 - \\beta_1B - \\beta_2D \\\\= \\beta_1(A-B) + \\beta_2(C-D)\\]"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#evidenciemos-los-efectos-del-confusor-modelo-explicativo",
    "href": "diapositivas/RLSM_2.html#evidenciemos-los-efectos-del-confusor-modelo-explicativo",
    "title": "Regresion Lineal Multiple",
    "section": "Evidenciemos los efectos del confusor (modelo explicativo)",
    "text": "Evidenciemos los efectos del confusor (modelo explicativo)\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n53.91\n8.86\n6.09\n0\n\n\ndbp\n0.70\n0.11\n6.59\n0"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#etnia-hindu-como-posible-confusor",
    "href": "diapositivas/RLSM_2.html#etnia-hindu-como-posible-confusor",
    "title": "Regresion Lineal Multiple",
    "section": "Etnia Hindu como posible confusor",
    "text": "Etnia Hindu como posible confusor\nRelación entre raza hindu y presion diastolica\nWelch Two Sample t-test data:  dbp by raza t = -3.96, df = 103.83, p-value = 0.0001376\nmean in group 0 mean in group 1\n79.80         87.76\nRelación entre raza hindu y Colesterol\nWelch Two Sample t-test data:  chol by raza t = -4.3482, df = 104.53, p-value = 0.000003197\nmean in group 0 mean in group 1\n107.07            121.35"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ajustemos-un-modelo-incluyendo-a-raza",
    "href": "diapositivas/RLSM_2.html#ajustemos-un-modelo-incluyendo-a-raza",
    "title": "Regresion Lineal Multiple",
    "section": "Ajustemos un modelo incluyendo a raza",
    "text": "Ajustemos un modelo incluyendo a raza\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n53.91\n8.86\n6.09\n0\n\n\ndbp\n0.70\n0.11\n6.59\n0\n\n\n\n\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n59.03\n8.81\n6.70\n0\n\n\ndbp\n0.60\n0.11\n5.55\n0\n\n\nraza\n9.48\n3.01\n3.15\n0"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#interacción",
    "href": "diapositivas/RLSM_2.html#interacción",
    "title": "Regresion Lineal Multiple",
    "section": "Interacción",
    "text": "Interacción\n\nDefinición: El efecto de una exposición sobre el desenlace varia en función de otra covariable. (heterogeneidad de efectos o modificación de efectos).\n\nEn resumen es evaluar el efecto de una exposición separadamente para los niveles (valores) de otras covariables incluidas en el modelo.\nHasta ahora en Confusión:\nEl efecto de un predictor es independiente de otros en efectos principales.\nEn adelante en Interacción:\nEl efecto de una exposición depende de los valores de otra covariable."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacción-i",
    "href": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacción-i",
    "title": "Regresion Lineal Multiple",
    "section": "Modelo para evaluar interacción I",
    "text": "Modelo para evaluar interacción I\nasumiendo que \\(X_1\\) es la exposición de interés:\n\\[E(Y/X_1,X_2)=\\beta_0+\\beta_1X_1+\\beta_2X_2+\\beta_3X_1X_2\\]\nSe puede re-agrupar:\n\\[E(Y/X_1,X_2)=\\beta_0+\\beta_1X_1+\\beta_2X_2+\\beta_3X_1X_2\\]\n\\[Y=\\beta_0+\\beta_2X_2+\\left(\\beta_1+\\beta_3X_2\\right)X_1\\]\n\\((\\beta_1+\\beta_3X_2)\\) es el efecto de \\(X_1\\) en \\(Y\\) cuando \\(X_2 \\neq 0\\)\n\\(\\beta_1\\) cuando \\(X_2=0\\)."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacción-ii",
    "href": "diapositivas/RLSM_2.html#modelo-para-evaluar-interacción-ii",
    "title": "Regresion Lineal Multiple",
    "section": "Modelo para evaluar interacción II",
    "text": "Modelo para evaluar interacción II\nasumiendo que \\(X_2\\) es la exposición de interés:\n\\[E(Y/X_1,X_2)=\\beta_0+\\beta_1X_1+\\beta_2X_2+\\beta_3X_1X_2\\]\nSe puede re-agrupar:\n\\[Y=\\beta_0+\\beta_1X_1+\\left(\\beta_2+\\beta_3X_1\\right)X_2\\]\n\\((\\beta_2+\\beta_3X_2)\\) es el efecto de \\(X_2\\) en \\(Y\\) cuando \\(X_1 \\neq 0\\)\n\\(\\beta_2\\) cuando \\(X_1=0\\)."
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ejemplo-interacción-con-categorica",
    "href": "diapositivas/RLSM_2.html#ejemplo-interacción-con-categorica",
    "title": "Regresion Lineal Multiple",
    "section": "ejemplo: Interacción con categorica",
    "text": "ejemplo: Interacción con categorica\nmodelo_inter &lt;- glm(LDL1 ~ HT + statins + HT:statins, data = hers)\nsummary(modelo_inter)$coefficients %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n145.156724\n1.325549\n109.506863\n0.0000000\n\n\nHThormone therapy\n-17.728360\n1.870629\n-9.477219\n0.0000000\n\n\nstatinsyes\n-13.809124\n2.152130\n-6.416491\n0.0000000\n\n\nHThormone therapy:statinsyes\n6.244416\n3.076489\n2.029721\n0.0424863\n\n\n\n\\[ LDL = 145.15 -17.72HT - 13.80statins + 6.24HTstatins\\]\navg_comparisons(modelo_inter, variables = \"HT\", by = \"statins\") %&gt;%  \nselect(1:6)%&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\n\nterm\ncontrast\nstatins\nestimate\nstd.error\nstatistic\n\n\n\n\nHT\nhormone therapy - placebo\nno\n-17.72836\n1.870629\n-9.477219\n\n\nHT\nhormone therapy - placebo\nyes\n-11.48394\n2.442444\n-4.701824"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#graficamente-la-interacción",
    "href": "diapositivas/RLSM_2.html#graficamente-la-interacción",
    "title": "Regresion Lineal Multiple",
    "section": "Graficamente la interacción:",
    "text": "Graficamente la interacción:"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#ejemplo-interacción-continua",
    "href": "diapositivas/RLSM_2.html#ejemplo-interacción-continua",
    "title": "Regresion Lineal Multiple",
    "section": "Ejemplo: Interacción Continua",
    "text": "Ejemplo: Interacción Continua\nmodelo_inter2 &lt;- glm(LDL1 ~ statins + BMI + statins:BMI, data = hers)\nsummary(modelo_inter2)$coefficients %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n122.1451382\n5.0146274\n24.357769\n0.0000000\n\n\nstatinsyes\n10.0822853\n8.4339549\n1.195440\n0.2320243\n\n\nBMI\n0.4919387\n0.1719634\n2.860717\n0.0042606\n\n\nstatinsyes:BMI\n-0.7146756\n0.2903733\n-2.461230\n0.0139107\n\n\n\n\\[ LDL = 122.14 + 10.08statins + 0.49BMI - 0.71statins*BMI\\]\ncomparisons(modelo_inter2, variables = \"statins\", newdata = datagrid(BMI = range)) %&gt;% select(1:6) %&gt;% kable()\n\n\n\nrowid\nterm\ncontrast\nestimate\nstd.error\nstatistic\n\n\n\n\n1\nstatins\nyes - no\n-0.988039\n4.100950\n-0.2409293\n\n\n2\nstatins\nyes - no\n-28.603103\n7.595175\n-3.7659573"
  },
  {
    "objectID": "diapositivas/RLSM_2.html#graficamente-la-interacción-1",
    "href": "diapositivas/RLSM_2.html#graficamente-la-interacción-1",
    "title": "Regresion Lineal Multiple",
    "section": "Graficamente la interacción:",
    "text": "Graficamente la interacción:"
  },
  {
    "objectID": "diapositivas/RLSM.html#objetivos-de-aprendizaje",
    "href": "diapositivas/RLSM.html#objetivos-de-aprendizaje",
    "title": "Regresion Lineal Simple",
    "section": "Objetivos de aprendizaje",
    "text": "Objetivos de aprendizaje\nDespués de este modulo, se espera que los estudiantes sean capaces de:\n\nEntender el concepto de regresión lineal simple y regresión lineal múltiple\nRealizar un análisis de regresión lineal simple (ajustar el modelo)\nRealizar regresión lineal múltiple (ajuste con más de un predictor)\nEvaluar el ajuste del modelo de regresión lineal (diagnósticos, \\(R^2\\), residuos, supuestos)\nPresentar e interpretar los resultados del análisis de regresión lineal (coeficientes, intervalos, significado)"
  },
  {
    "objectID": "diapositivas/RLSM.html#conjunto-de-datos-coronary.rds",
    "href": "diapositivas/RLSM.html#conjunto-de-datos-coronary.rds",
    "title": "Regresion Lineal Simple",
    "section": "Conjunto de datos: coronary.rds",
    "text": "Conjunto de datos: coronary.rds\n\nUsaremos el dataset coronary.rds en formato R. 👉 Descargar coronary.rds\n\nCorresponde a un ensayo clínico hipotético con información de características individuales, niveles de colesterol total y grupos de intervención.\n\nContiene 200 observaciones y 9 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripción\n\n\n\n\nid\nIdentificación del sujeto\n\n\ncad\nEstado de enfermedad coronaria (categórica: sin CAD, con CAD)\n\n\nsbp\nPresión arterial sistólica (mmHg, numérica)\n\n\ndbp\nPresión arterial diastólica (mmHg, numérica)\n\n\nchol\nColesterol total (mmol/L, numérica)\n\n\nage\nEdad en años (numérica)\n\n\nbmi\nÍndice de masa corporal (numérica)\n\n\nrace\nRaza (categórica: malayo, chino, indio)\n\n\ngender\nSexo (categórica: mujer, hombre)"
  },
  {
    "objectID": "diapositivas/RLSM.html#introducción-a-la-regresión-lineal",
    "href": "diapositivas/RLSM.html#introducción-a-la-regresión-lineal",
    "title": "Regresion Lineal Simple",
    "section": "Introducción a la Regresión Lineal",
    "text": "Introducción a la Regresión Lineal\n\nLa regresión lineal es uno de los análisis estadísticos más comunes en las ciencias de la salud.\nModela la relación lineal (recta) entre una variable resultado numérica (por ejemplo colesterol, presión arterial, IMC) y predictores que pueden ser numéricos o categóricos.\nEn términos “coloquiales”, podríamos estar interesados en saber cómo varía (distribución) el nivel de colesterol en terminos de distintas variables.\nLa regresión lineal es un caso particular del Modelo Lineal Generalizado (GLM); los modelos que veremos más adelante (logístico)."
  },
  {
    "objectID": "diapositivas/RLSM.html#regresión-lineal-simple",
    "href": "diapositivas/RLSM.html#regresión-lineal-simple",
    "title": "Regresion Lineal Simple",
    "section": "Regresión Lineal Simple",
    "text": "Regresión Lineal Simple\n\nLa Regresión Lineal Simple (RLS) modela la relación lineal entre:\n\nUna variable dependiente numérica (ej. colesterol).\n\nUn único predictor (numérico o categórico).\n\nCuando el predictor es categórico, se puede interpretar como un ANOVA de una vía.\n\nExpresión matemática\n\\[\nE(Y \\mid X) = \\beta_0 + \\beta_1 X\n\\]\nDonde:\n- \\(E(Y \\mid X)\\): valor esperado (predicho) (promedio) de la variable dependiente dado \\(X\\).\n- \\(\\beta_0\\): intercepto.\n- \\(\\beta_1\\): coeficiente del predictor \\(X\\)."
  },
  {
    "objectID": "diapositivas/RLSM.html#estimación-por-máxima-verosimilitud-caso-1-covariable",
    "href": "diapositivas/RLSM.html#estimación-por-máxima-verosimilitud-caso-1-covariable",
    "title": "Regresion Lineal Simple",
    "section": "Estimación por Máxima Verosimilitud (caso 1 covariable)",
    "text": "Estimación por Máxima Verosimilitud (caso 1 covariable)\n\nLa idea central es elegir los parámetros \\(\\beta_0, \\beta_1\\) que maximizan la probabilidad de observar los datos.\n\nSupuestos básicos\n\nLos errores \\(\\varepsilon_i\\) se asumen independientes y distribuidos:\n\\(\\varepsilon_i \\sim N(0, \\sigma^2)\\)\nEntonces:\n\\[\nY_i \\sim N(\\beta_0 + \\beta_1 X_i, \\, \\sigma^2)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM.html#función-de-verosimilitud",
    "href": "diapositivas/RLSM.html#función-de-verosimilitud",
    "title": "Regresion Lineal Simple",
    "section": "Función de verosimilitud",
    "text": "Función de verosimilitud\n\\[\nL(\\beta_0, \\beta_1, \\sigma^2 \\mid Y)\n= \\prod_{i=1}^n\n\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{(Y_i - \\beta_0 - \\beta_1 X_i)^2}{2\\sigma^2} \\right)\n\\]\nEstimadores MLE\n\\[\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^n (X_i - \\bar{X})^2}\n\\]\n\\[\n\\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X}\n\\]\n\n\n\\(\\widehat{\\sigma}^2 = \\frac{1}{n-2} \\sum_{i=1}^n \\left( Y_i - \\hat{Y}_i \\right)^2\\)\n\n\\(SE(\\hat{\\beta}_1) = \\sqrt{ \\frac{\\widehat{\\sigma}^2}{\\sum_{i=1}^n (X_i - \\bar{X})^2} }\\)\n\\(SE(\\hat{\\beta}_0) = \\sqrt{ \\widehat{\\sigma}^2 \\left( \\frac{1}{n} + \\frac{\\bar{X}^2}{\\sum_{i=1}^n (X_i - \\bar{X})^2} \\right) }\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-colesterol-en-funcion-de-la-presión-arterial-sistolica",
    "href": "diapositivas/RLSM.html#modelo-colesterol-en-funcion-de-la-presión-arterial-sistolica",
    "title": "Regresion Lineal Simple",
    "section": "Modelo: Colesterol en funcion de la Presión arterial sistolica",
    "text": "Modelo: Colesterol en funcion de la Presión arterial sistolica\nObjetivo: Se requiere predecir los valores de colesterol de pacientes cuando se conoce su presion arterial sistolica.\n\nAsumimos que la relación entre las variables es lineal \\(r = 0.39\\)\nSegun el modelo lineal planteado seria:\n\n\\[\\mu_{chol} = \\beta_0 + \\beta_1 \\times sbp\\]\nQue valores asumen \\(\\beta_0\\) y \\(\\beta_1\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#ajuste-del-modelo",
    "href": "diapositivas/RLSM.html#ajuste-del-modelo",
    "title": "Regresion Lineal Simple",
    "section": "Ajuste del modelo",
    "text": "Ajuste del modelo\n\nmodelo_simple &lt;- lm(data = coronary, formula = chol~sbp)\nsummary(modelo_simple)"
  },
  {
    "objectID": "diapositivas/RLSM.html#el-modelo-es-adecuado",
    "href": "diapositivas/RLSM.html#el-modelo-es-adecuado",
    "title": "Regresion Lineal Simple",
    "section": "¿el modelo es adecuado?",
    "text": "¿el modelo es adecuado?\nPrueba F\nF-statistic: 36.52 on 1 and 198 DF,  p-value: 7.377e-09: el modelo es significativo, con la sbp se permite explicar el chol.\nError estandar residual\nResidual standard error: 19.6 para saber que tan grande es: Tasa de error de predicción:\nsummary(modelo_simple)$sigma/mean(coronary$chol)*100\n[1] 17.58923\nUna tasas de error de 17.6%\nCoeficiente de determinacion \\(R^2\\)\nsummary(modelo_simple)$r.squared\n[1] 0.1557222\nEl ajuste es regular, se explica el 15.5% de la variabilidad del Colesterol"
  },
  {
    "objectID": "diapositivas/RLSM.html#estimación-de-coeficientes",
    "href": "diapositivas/RLSM.html#estimación-de-coeficientes",
    "title": "Regresion Lineal Simple",
    "section": "Estimación de coeficientes",
    "text": "Estimación de coeficientes\nmodelo_simple &lt;- lm(data = coronary, formula = chol~1)\n\nsummary(modelo_simple)$coefficients\n        Estimate Std. Error  t value      Pr(&gt;|t|)\n(Intercept) 111.5737 1.506458 74.06359 8.021754e-147\nmean(coronary$chol)\n[1] 111.5737\ncon covariable\nmodelo_simple &lt;- lm(data = coronary, formula = chol~sbp)\nsummary(modelo_simple)$coefficients %&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n56.3342138\n9.2455346\n6.093127\n0\n\n\nsbp\n0.4243314\n0.0702166\n6.043176\n0\n\n\n\nModelo completo: \\(\\mu_{chol} = 56.33 + 0.42 \\times sbp\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#interpretación-de-coeficientes",
    "href": "diapositivas/RLSM.html#interpretación-de-coeficientes",
    "title": "Regresion Lineal Simple",
    "section": "Interpretación de Coeficientes",
    "text": "Interpretación de Coeficientes\n\n\\(\\beta_0\\) es el valor medio que asumen la variable dependiente cuando la covariable toma valor cero. (unidades de la variable dependiente)\n\\(\\beta_1\\): Es el cambio en promedio que tiene la variable dependiente por unidad de cambio de la covariable.\n\n\\[\\mu_{chol} = 56.33 + 0.42 \\times sbp\\]\nEl colesterol cambia en promedio en 0.42 mg/dl por cada mmHg de presión arterial sistolica.\nAhora si estariamos en capacidad de predecir cual es el valor medio del colesterol para un sujeto que tiene 120 mmHg de presion arterial sistolica."
  },
  {
    "objectID": "diapositivas/RLSM.html#predicciones-con-el-modelo",
    "href": "diapositivas/RLSM.html#predicciones-con-el-modelo",
    "title": "Regresion Lineal Simple",
    "section": "Predicciones con el modelo",
    "text": "Predicciones con el modelo\npredict(modelo_simple,newdata = data.frame(sbp = 120))\n  1 \n107.254\npredict(modelo_simple,newdata = data.frame(sbp = 180))\n   1 \n132.7139"
  },
  {
    "objectID": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones",
    "href": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones",
    "title": "Regresion Lineal Simple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\nContrastes de hipótesis\n\n\\(H_0: \\beta_j = 0\\)\n\\(H_a: \\beta_j \\neq 0\\) para \\(j=0,1\\)\nEstadístico de prueba:\n\\[t = \\frac{\\hat{\\beta}_j}{SE(\\hat{\\beta}_j)} \\sim t_{n-p-1}\\]\n\nIntervalos de confianza\n\nA un nivel de confianza \\(1-\\alpha\\):\n\\[\nIC_{1-\\alpha}(\\beta_j) = \\hat{\\beta}_j \\;\\pm\\; t_{\\alpha/2, \\, n-p-1} \\times SE(\\hat{\\beta}_j)\n\\]"
  },
  {
    "objectID": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones-1",
    "href": "diapositivas/RLSM.html#inferencia-coeficientes-y-predicciones-1",
    "title": "Regresion Lineal Simple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\nsummary(modelo_simple)$coefficients %&gt;% kable()\n\n\n\n\nEstimate\nStd. Error\nt value\nPr(&gt;|t|)\n\n\n\n\n(Intercept)\n56.3342138\n9.2455346\n6.093127\n0\n\n\nsbp\n0.4243314\n0.0702166\n6.043176\n0\n\n\n\nconfint(modelo_simple) %&gt;% kable()\n\n\n\n\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n38.101858\n74.5665696\n\n\nsbp\n0.285863\n0.5627998"
  },
  {
    "objectID": "diapositivas/RLSM.html#inferencia-en-predicciones",
    "href": "diapositivas/RLSM.html#inferencia-en-predicciones",
    "title": "Regresion Lineal Simple",
    "section": "Inferencia en predicciones",
    "text": "Inferencia en predicciones\npredictions(modelo_simple, newdata = data.frame(sbp = c(120,180))) %&gt;% \n  select(2:9) %&gt;% \n  kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\nsbp\n\n\n\n\n107.25\n1.56\n68.71\n0\nInf\n104.19\n110.31\n120\n\n\n132.71\n3.76\n35.26\n0\n902.53\n125.34\n140.09\n180\n\n\n\n\n\navg_comparisons(modelo_simple,variables = list(sbp = c(120, 180))) %&gt;%\n  select(3:9) %&gt;% \n  kable(digits = 2,align = \"c\",\"html\")\n\n\n\nestimate\nstd.error\nstatistic\np.value\ns.value\nconf.low\nconf.high\n\n\n\n\n25.46\n4.21\n6.04\n0\n29.3\n17.2\n33.72"
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnóstico-supuestos",
    "href": "diapositivas/RLSM.html#diagnóstico-supuestos",
    "title": "Regresion Lineal Simple",
    "section": "Diagnóstico: Supuestos",
    "text": "Diagnóstico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nSupuestos básicos (acrónimo LINE):\nL de Linealidad: Los valores de (Y) se pueden expresar como una función lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre sí.\nN de Normalidad:Para cualquier valor fijo de (X), los valores de (Y) (o los errores/residuos) se distribuyen normalmente.\nE de Equitatividad (Homoscedasticidad): La variación de los valores de (Y) (o los errores/residuos) alrededor de la línea de regresión es constante."
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nLinealidad y homocedasticidad: sin patrones Causas: modelo no lineal, falta de variables explicativas, interacción."
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos-1",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos-1",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nFalta de Normalidad: Otro modelos lineales generalizados"
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos-2",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos-2",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nHomogeneidad de la varianza: Transformaciones"
  },
  {
    "objectID": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos-3",
    "href": "diapositivas/RLSM.html#diagnostico-con-graficos-verificación-de-supuestos-3",
    "title": "Regresion Lineal Simple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)\n\n\n\n\n\n\nIdentificar valores inusuales e influyentes: Transformaciones."
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-de-regresión-lineal-simple-con-una-covariablepredictor-categorico",
    "href": "diapositivas/RLSM.html#modelo-de-regresión-lineal-simple-con-una-covariablepredictor-categorico",
    "title": "Regresion Lineal Simple",
    "section": "Modelo de regresión lineal simple con una covariable/predictor categorico",
    "text": "Modelo de regresión lineal simple con una covariable/predictor categorico\n\\[E(Y \\mid X) = \\beta_0 + \\beta_1 X\\]\n\\(X\\) = En el caso que sea binaria, el modelo asume codificación (\\(1=\\) Presencia, \\(0=\\) Ausencia)\n\\(E(Y \\mid X) = \\beta_0 + \\beta_1 \\times (1)\\) indicaría el cambio en la variable dependiente ante la presencia de la condición que fue codificada como \\(1\\).\n\\(E(Y \\mid X) = \\beta_0 + \\beta_1 \\times (0)\\)\n\\(E(Y \\mid X) = \\beta_0\\) indicaría el cambio en la variable dependiente ante la ausencia de la condición que fue codificada como \\(0\\)"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-lineal-con-covariable-categorica",
    "href": "diapositivas/RLSM.html#modelo-lineal-con-covariable-categorica",
    "title": "Regresion Lineal Simple",
    "section": "Modelo lineal con covariable categorica",
    "text": "Modelo lineal con covariable categorica\nmodelo_cat &lt;- lm(formula = chol ~ cad, coronary)"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-estimado",
    "href": "diapositivas/RLSM.html#modelo-estimado",
    "title": "Regresion Lineal Simple",
    "section": "modelo Estimado",
    "text": "modelo Estimado\n\\[E(Y \\mid X) = 109.855 + 9.9 \\times cad\\]\nDonde \\(cad = 0,1\\)\n\\(\\beta_1\\) es el cambio o diferencia promedio que hay en los niveles de colesterol entre pacientes con y sin enfermedad cardiovascular.\n\nRealicemos predicción de la media de colesterol para pacientes con enfermedad\nRealicemos predicción de la media de colesterol para pacientes sin enfermedad"
  },
  {
    "objectID": "diapositivas/RLSM.html#variable-categorica-politomica",
    "href": "diapositivas/RLSM.html#variable-categorica-politomica",
    "title": "Regresion Lineal Simple",
    "section": "Variable categorica politomica",
    "text": "Variable categorica politomica\n\nSe debe representar cada categoria de la variable en el modelo, dejando como 1 la presencial de la categoria y 0 las demas (variable dummy)\n\n\n\n\n\\(X=\\) Malayo\n\\(X=\\) Chino\n\\(X =\\) Hindu\n\n\n\n\n1\n0\n0\n\n\n0\n1\n0\n\n\n0\n0\n1"
  },
  {
    "objectID": "diapositivas/RLSM.html#modelo-con-variable-categorica-politomica",
    "href": "diapositivas/RLSM.html#modelo-con-variable-categorica-politomica",
    "title": "Regresion Lineal Simple",
    "section": "modelo con variable categorica politomica",
    "text": "modelo con variable categorica politomica\n\nmodelo_cat2 &lt;- lm(formula = chol ~ race, coronary)\nsummary(modelo_cat2)"
  },
  {
    "objectID": "diapositivas/rlgs.html#conjunto-de-datos-stroke.rds",
    "href": "diapositivas/rlgs.html#conjunto-de-datos-stroke.rds",
    "title": "Regresión Logistica Simple",
    "section": "Conjunto de datos: stroke.rds",
    "text": "Conjunto de datos: stroke.rds\n\nUsaremos el dataset stroke.rds en formato R. 👉 Descargar stroke.rds\n\nContiene 226 observaciones y 7 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripción\n\n\n\n\nstatus\nEstado del paciente durante la hospitalización ( 0 vivo / 1 fallecido)\n\n\ngcs\nEscala de Glasgow al ingreso (3–15)\n\n\nstroke_type\nTipo de ictus (IS = isquémico; HS = hemorrágico)\n\n\nsex\nSexo biológico (1 femenino / 0masculino)\n\n\ndm\nHistoria de diabetes (sí / no)\n\n\nsbp\nPresión arterial sistólica (mmHg)\n\n\nage\nEdad al ingreso (años)"
  },
  {
    "objectID": "diapositivas/rlgs.html#introducción-a-la-regresión-logistica",
    "href": "diapositivas/rlgs.html#introducción-a-la-regresión-logistica",
    "title": "Regresión Logistica Simple",
    "section": "Introducción a la Regresión Logistica",
    "text": "Introducción a la Regresión Logistica\n\nLa regresión logistica es uno de los análisis estadísticos más comunes en epidemiologia.\nModela la relación lineal entre una variable resultado categorica binaria (por ejemplo estado de infección, estado vital, complicaciones) y predictores que pueden ser numéricos o categóricos.\nLa regresión logística es un caso particular del Modelo Lineal Generalizado (GLM)."
  },
  {
    "objectID": "diapositivas/rlgs.html#regresión-logistica-simple",
    "href": "diapositivas/rlgs.html#regresión-logistica-simple",
    "title": "Regresión Logistica Simple",
    "section": "Regresión Logistica Simple",
    "text": "Regresión Logistica Simple\n\nLa Regresión Logistica Simple modela la relación lineal entre:\n\nUna variable dependiente categorica (ej. Status).\n\nUn único predictor (numérico o categórico).\n\nCuando el predictor es categórico, se puede interpretar como un prueba de chi-cuadrado.\n\nExpresión matemática\n\\[E(Y \\mid X) = \\beta_0 + \\beta_1 X\\] \\(E(Y) = P(Y)\\) Recordar que \\(Y = [0,1]\\) si se asume asi los valores de \\(Y\\) estimados por el modelo lineal simple siempre los valores estimados de \\(Y\\) se salen de \\(0\\) o de \\(1\\)."
  },
  {
    "objectID": "diapositivas/rlgs.html#modelo-enlace-y-probabilidades",
    "href": "diapositivas/rlgs.html#modelo-enlace-y-probabilidades",
    "title": "Regresión Logistica Simple",
    "section": "Modelo, enlace y probabilidades",
    "text": "Modelo, enlace y probabilidades\n\\[Odds = \\frac{P(Y)}{1-P(Y)}\\] el logaritmo de Odds \\(Log(odds)\\) si es lineal en terminos de una covariable, y se llama el logit.\n\\[\n\\log(\\frac{P(Y/X)}{1-P(Y/X)}) = \\beta_0 + \\beta_1X\n\\]\n\\[\nP(Y/X)=\\frac{1}{1+e^{-\\left(\\beta_0+\\beta_1 X\\right)}}\n\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#estimación-por-máxima-verosimilitud-caso-1-covariable",
    "href": "diapositivas/rlgs.html#estimación-por-máxima-verosimilitud-caso-1-covariable",
    "title": "Regresión Logistica Simple",
    "section": "Estimación por Máxima Verosimilitud (caso 1 covariable)",
    "text": "Estimación por Máxima Verosimilitud (caso 1 covariable)\n\nLa idea central es elegir los parámetros \\(\\beta_0, \\beta_1\\) que maximizan la probabilidad de observar los datos.\n\n\\[\nL(P(\\beta_0,\\beta_1/Y,X))=\\sum_{i=1}^n\\Big[y_i(\\beta_0+\\beta_1 X_i)-\\log\\!\\big(1+e^{\\beta_0+\\beta_1 X_i}\\big)\\Big].\n\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo",
    "href": "diapositivas/rlgs.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo",
    "title": "Regresión Logistica Simple",
    "section": "Modelo: Probabilidad de muerte en funcion del sexo",
    "text": "Modelo: Probabilidad de muerte en funcion del sexo\nObjetivo: Se requiere predecir la probabilidad de fallecer (status = 1) en pacientes cuando se conoce su sexo\n\nAsumimos que la relacóon lineal en el \\(logit(P)\\) es decir \\(\\log(\\frac{P}{1-P})\\)\nSegun el modelo lineal planteado seria:\n\n\\[\\log(\\frac{P}{1-P}) = \\beta_0 + \\beta_1 \\times sexo\\]\nQue valores asumen \\(\\beta_0\\) y \\(\\beta_1\\)"
  },
  {
    "objectID": "diapositivas/rlgs.html#ajuste-del-modelo",
    "href": "diapositivas/rlgs.html#ajuste-del-modelo",
    "title": "Regresión Logistica Simple",
    "section": "Ajuste del modelo",
    "text": "Ajuste del modelo\n\nmodelo &lt;- glm(status ~ sex, \n      data = stroke, \n      family = binomial(link = 'logit'))\nsummary(modelo)"
  },
  {
    "objectID": "diapositivas/rlgs.html#el-modelo-es-adecuado",
    "href": "diapositivas/rlgs.html#el-modelo-es-adecuado",
    "title": "Regresión Logistica Simple",
    "section": "¿El modelo es adecuado?",
    "text": "¿El modelo es adecuado?\nPrueba chi-cuadrado\nminimizar la perdida de informacion Deviance residual comparada con la nula.\n\nresiduos_log_1 &lt;- modelo$null.deviance - modelo$deviance\n#Grados de Libertad.\ngrados_log_1 &lt;- modelo$df.null - modelo$df.residual\n#p-value.\npchisq(residuos_log_1, grados_log_1,lower.tail = F)\n\n[1] 0.01559606"
  },
  {
    "objectID": "diapositivas/rlgs.html#estimación-de-coeficientes",
    "href": "diapositivas/rlgs.html#estimación-de-coeficientes",
    "title": "Regresión Logistica Simple",
    "section": "Estimación de coeficientes",
    "text": "Estimación de coeficientes\n\nmodelo_null &lt;- glm(status ~ 1, \n      data = stroke, \n      family = binomial(link = 'logit'))\n\nsummary(modelo_null)$coefficients\n\n            Estimate Std. Error  z value     Pr(&gt;|z|)\n(Intercept) -1.13433  0.1550153 -7.31754 2.525578e-13\n\n\n\nmean(stroke$status)\n\n[1] 0.2433628\n\n\nEl coeficiente \\(-1.13433\\) segun modelo corresponde a:\n\\[\\log(odds) = -1.13433\\] \\[e^{\\log(odds)} = e^{-1.13433}\\] \\(odds = 0.3217\\) ahora devolviendonos \\(P = \\frac{odds}{1+odds}\\) entonces:\n\\[ P = \\frac{0.3217}{1+0.3217} = 0.2424\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#con-covariable-categorica",
    "href": "diapositivas/rlgs.html#con-covariable-categorica",
    "title": "Regresión Logistica Simple",
    "section": "con covariable categorica",
    "text": "con covariable categorica\nmodelo &lt;- glm(status ~ sex, \n      data = stroke, \n      family = binomial(link = 'logit'))\nsummary(modelo)$coefficients\n          Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -0.8362480 0.1917084 -4.362084 1.288295e-05 sex -0.7856124 0.3340625 -2.351693 1.868821e-02\nModelo completo: \\(\\log(odds) = -0.835 - 0.785 \\times sex\\)\n\n\nAhora vamos a la interpretación de coeficientes"
  },
  {
    "objectID": "diapositivas/rlgs.html#interpretación-de-coeficientes-de-variable-categorica-binaria",
    "href": "diapositivas/rlgs.html#interpretación-de-coeficientes-de-variable-categorica-binaria",
    "title": "Regresión Logistica Simple",
    "section": "Interpretación de Coeficientes de variable categorica (binaria)",
    "text": "Interpretación de Coeficientes de variable categorica (binaria)\n\n\\(\\beta_0\\) es el valor medio que asumen la variable dependiente (\\(\\log(odds)\\)) cuando la covariable toma valor cero (en nuestro caso ser hombre).\n\n\\[\\log(odds) = -0.835 - 0.785(0) = -0.835\\]\n\\[odds_{hombre} = e^{-0.835} = 0.43\\]\n\npasadolo a probabilidad seria \\(\\frac{0.43}{1-0.43} = 0.302\\).\n\nSi recordamos la tabla de \\(2\\times 2\\)"
  },
  {
    "objectID": "diapositivas/rlgs.html#interpretación-de-coeficientes-de-variable-categorica-binaria-1",
    "href": "diapositivas/rlgs.html#interpretación-de-coeficientes-de-variable-categorica-binaria-1",
    "title": "Regresión Logistica Simple",
    "section": "Interpretación de Coeficientes de variable categorica (binaria)",
    "text": "Interpretación de Coeficientes de variable categorica (binaria)\n\n\\(\\beta_1\\): para obtener interpretación de este coeficiente realizamos la siguiente comparación de resultados del modelo cuando sexo asume ser F contra M. Es decir un cambio de 0 (Hombre) a 1(Mujer).\n\n\\[e^{\\log(odds_{mujer})} =odds_{mujer} = e^{\\beta_0 + \\beta_1(1)}\\] \\[e^{\\log(odds_{hombre})} =odds_{hombre} = e^{\\beta_0 + \\beta_1(0)}\\] \\[\\frac{odds_{mujer}}{odds_{hombre}} = \\frac{e^{\\beta_0 + \\beta_1(1)}}{e^{\\beta_0 + \\beta_1(0)}} = e^{\\beta_0 + \\beta_1(1)}e^{-\\beta_0 - \\beta_1(0)} = e^{\\beta_1}\\] ¿Se concluye entonces qué?"
  },
  {
    "objectID": "diapositivas/rlgs.html#predicciones-con-el-modelo",
    "href": "diapositivas/rlgs.html#predicciones-con-el-modelo",
    "title": "Regresión Logistica Simple",
    "section": "Predicciones con el modelo",
    "text": "Predicciones con el modelo\n\npredict(modelo,newdata = data.frame(sex = 1),type = \"response\")\n\n        1 \n0.1649485 \n\n\n\npredict(modelo,newdata = data.frame(sex = 0), type = \"response\")\n\n        1 \n0.3023256"
  },
  {
    "objectID": "diapositivas/rlgs.html#inferencia-coeficientes-y-predicciones",
    "href": "diapositivas/rlgs.html#inferencia-coeficientes-y-predicciones",
    "title": "Regresión Logistica Simple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\n\nsummary(modelo)$coefficients\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -0.8362480  0.1917084 -4.362084 1.288295e-05\nsex         -0.7856124  0.3340625 -2.351693 1.868821e-02\n\n\n\nexp(coefficients(modelo))\n\n(Intercept)         sex \n  0.4333333   0.4558405 \n\nexp(confint(modelo))\n\n                2.5 %    97.5 %\n(Intercept) 0.2944922 0.6258239\nsex         0.2316497 0.8640154"
  },
  {
    "objectID": "diapositivas/rlgs.html#inferencia-en-predicciones",
    "href": "diapositivas/rlgs.html#inferencia-en-predicciones",
    "title": "Regresión Logistica Simple",
    "section": "Inferencia en predicciones",
    "text": "Inferencia en predicciones\n\npredictions(modelo, newdata = data.frame(sex = c(1)))\n\n\n Estimate Pr(&gt;|z|)    S 2.5 % 97.5 % sex\n    0.165   &lt;0.001 28.3 0.104  0.252   1\n\nType:  invlink(link)"
  },
  {
    "objectID": "diapositivas/rlgs.html#diagnóstico-supuestos",
    "href": "diapositivas/rlgs.html#diagnóstico-supuestos",
    "title": "Regresión Logistica Simple",
    "section": "Diagnóstico: Supuestos",
    "text": "Diagnóstico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nL de Linealidad: Los valores de (Y) se pueden expresar como una función lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre sí."
  },
  {
    "objectID": "diapositivas/rlgs.html#diagnostico-con-graficos-verificación-de-supuestos",
    "href": "diapositivas/rlgs.html#diagnostico-con-graficos-verificación-de-supuestos",
    "title": "Regresión Logistica Simple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)"
  },
  {
    "objectID": "diapositivas/rlgs.html#con-covariable-numerica",
    "href": "diapositivas/rlgs.html#con-covariable-numerica",
    "title": "Regresión Logistica Simple",
    "section": "Con covariable numerica",
    "text": "Con covariable numerica\nmodelo con glasglow como covariable\n\nmodelo_num &lt;- glm(formula = status ~ gcs, stroke, family = binomial(link = 'logit'))\nsummary(modelo_num)\n\n\nCall:\nglm(formula = status ~ gcs, family = binomial(link = \"logit\"), \n    data = stroke)\n\nCoefficients:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  3.29479    0.60432   5.452 4.98e-08 ***\ngcs         -0.38811    0.05213  -7.446 9.64e-14 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 250.83  on 225  degrees of freedom\nResidual deviance: 170.92  on 224  degrees of freedom\nAIC: 174.92\n\nNumber of Fisher Scoring iterations: 5"
  },
  {
    "objectID": "diapositivas/rlgs.html#modelo-estimado",
    "href": "diapositivas/rlgs.html#modelo-estimado",
    "title": "Regresión Logistica Simple",
    "section": "Modelo Estimado",
    "text": "Modelo Estimado\n\\[\\log(odds) = 3.29 - 0.38 \\times gcs\\]\n\n\\(\\beta_1\\): evaluemos que pasa si hacemos un cambio en una unidad de la covariable\n\n\n\\[\\log(Odds_{gcs12})-\\log(Odds_{gcs11}) = \\log(\\frac{Odds_{gcs12}}{Odds_{gcs11}})\\]\n\n\n\\[\\log(\\frac{Odds_{gcs12}}{Odds_{gcs11}})=\\beta_0 + \\beta_1(12)-\\beta_0 - \\beta_1(11)= \\beta_0-\\beta_0+\\beta_1(12)-\\beta_1(11)\\]\n\n\n\\[\\log(\\frac{Odds_{gcs12}}{Odds_{gcs11}}) = \\beta_1(12-11) = \\beta_1\\] \\[\\log(OR) = \\beta_1\\], aplicamos \\(e\\) ambos lados\n\n\n\\[OR = e^{\\beta_1} = e^{-0.38} = 0.68\\]\npor cada punto de incremento en la escala glasglow OR se multiplicaría por \\(0.68\\)."
  },
  {
    "objectID": "diapositivas/rlgs.html#cuidado-con-la-interepretación-de-or-en-variable-numericas",
    "href": "diapositivas/rlgs.html#cuidado-con-la-interepretación-de-or-en-variable-numericas",
    "title": "Regresión Logistica Simple",
    "section": "CUIDADO CON LA INTEREPRETACIÓN DE OR EN VARIABLE NUMERICAS",
    "text": "CUIDADO CON LA INTEREPRETACIÓN DE OR EN VARIABLE NUMERICAS\n\nEl cambio es en escala multiplicativa no ADITIVA como en regresión lineal.\nEn el ejemplo: La frecuencia de muerte cambia multiplicando por el valor del coeficiente exponenciado.\n\nPara 1 punto de cambio en glasglow \\(OR = 0.68\\)\nPara 2 puntos de cambio acumulados seria \\(OR = 0.68\\times0.68 = 0.46\\)\nDe otra manera \\[OR = e^{-0.38\\times2}= 0.46\\]"
  },
  {
    "objectID": "diapositivas/rlgs.html#diagnostico-del-modelo",
    "href": "diapositivas/rlgs.html#diagnostico-del-modelo",
    "title": "Regresión Logistica Simple",
    "section": "Diagnostico del modelo",
    "text": "Diagnostico del modelo"
  },
  {
    "objectID": "diapositivas/rlgs.html#revisemos-linealidad-entre-odds-de-fallecer-y-glasglow",
    "href": "diapositivas/rlgs.html#revisemos-linealidad-entre-odds-de-fallecer-y-glasglow",
    "title": "Regresión Logistica Simple",
    "section": "Revisemos linealidad entre Odds de fallecer y Glasglow",
    "text": "Revisemos linealidad entre Odds de fallecer y Glasglow"
  },
  {
    "objectID": "diapositivas/generalidades.html#utilidad-propósitos-primarios-de-los-modelos-en-epidemiología",
    "href": "diapositivas/generalidades.html#utilidad-propósitos-primarios-de-los-modelos-en-epidemiología",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Utilidad: Propósitos Primarios de los Modelos en Epidemiología:",
    "text": "Utilidad: Propósitos Primarios de los Modelos en Epidemiología:\nLa regresión puede ser una herramienta poderosa para direccionar tres preguntas relevantes:\n\nPredicción (En la era de la IA)\nAislar el efecto de una exposición/covariable\nComprender la relaciones de múltiples exposiciones hacia un efecto (confusión - interacción - mediación)",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelos-de-predicción",
    "href": "diapositivas/generalidades.html#modelos-de-predicción",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Modelos de Predicción",
    "text": "Modelos de Predicción\n\nLos modelos de predicción se emplean para estimar el riesgo o efecto (o alguna otra medida epidemiológica).\nEsta estimación se basa en la información proporcionada por los predictores o covariables.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#ejemplos-de-modelamiento-predictivo",
    "href": "diapositivas/generalidades.html#ejemplos-de-modelamiento-predictivo",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Ejemplos de modelamiento predictivo:",
    "text": "Ejemplos de modelamiento predictivo:\n\nEn el ámbito empresarial para pronosticar el desempeño financiero y para modelar el comportamiento de compra del consumidor y de pago de préstamos.\nEn ingeniería: los modelos de supervivencia se emplean para predecir la vida útil de productos.\nEn la ecología, los modelos de regresión predicen la probabilidad de que una especie de pez desaparezca de un lago.\nEn el ámbito legal, los modelos son comunes en litigios por discriminación para intentar determinar si la raza o el sexo se utilizaron como base para la contratación o promoción, después de tener en cuenta otras características del personal.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#ejemplos-en-ciencias-de-la-salud-y-epidemiologia",
    "href": "diapositivas/generalidades.html#ejemplos-en-ciencias-de-la-salud-y-epidemiologia",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Ejemplos en Ciencias de la salud y epidemiologia:",
    "text": "Ejemplos en Ciencias de la salud y epidemiologia:\n\nDiagnóstico: Predecir la probabilidad de que un paciente tenga una enfermedad específica.\nPronóstico: Predecir el curso temporal de una enfermedad ya diagnosticada.\nEstimación de efectos absolutos en ensayos clínicos aleatorios: Incluso en experimentos aleatorios bien diseñados, el modelado es necesario para estimar los efectos absolutos.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelos-de-explicación",
    "href": "diapositivas/generalidades.html#modelos-de-explicación",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Modelos de Explicación",
    "text": "Modelos de Explicación\n\nAjuste de sesgos en estudios observacionales: Son muy importantes para controlar los sesgos causados por la asignación no aleatoria de tratamientos. (Estimar el efecto del factor de interés de forma más pura).\nCálculo de la Puntuación de Propensión (Propensity Score): permite un ajuste más agresivo de la asignación no aleatoria de tratamientos.\nInferencia Causal: Escenario counterfactual",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#planeación-de-modelo",
    "href": "diapositivas/generalidades.html#planeación-de-modelo",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Planeación de modelo",
    "text": "Planeación de modelo\nPuntos Clave para la Planificación del Modelado\n\nEvaluación Inicial y Propósito\n\n\nAsegurar la Relevancia: La pregunta fundamental es si el modelo será utilizado realmente.\nLos modelos a menudo fallan porque:\n\nNo se consideran relevantes para el entorno previsto.\nLos usuarios potenciales no confían en las relaciones o variables empleadas.\nLas variables necesarias para las predicciones no están disponibles rutinariamente.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#planeación-del-modelo",
    "href": "diapositivas/generalidades.html#planeación-del-modelo",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Planeación del modelo",
    "text": "Planeación del modelo\n\nCalidad de los Datos y Diseño del Estudio\n\n\nEvitar Muestras de Conveniencia: Estas muestras suelen estar plagadas de dificultades, ya que no fueron recolectadas pensando en el modelo predictivo.\nUn modelo será más preciso y útil si la recolección de datos se planea prospectivamente, estableciendo definiciones estándar y minimizando los datos faltantes.\nEvitar el Sobreajuste (Overfitting): El sobreajuste ocurre con frecuencia, lo que lleva a predicciones demasiado extremas o asociaciones falsas. (n = 50 y 30 variables).",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#planeación-del-modelo-1",
    "href": "diapositivas/generalidades.html#planeación-del-modelo-1",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Planeación del modelo",
    "text": "Planeación del modelo\n\nEvitar Extrapolaciones: No se debe hacer predicciones al extrapolar combinaciones de valores de predictores que están fuera del rango utilizado para desarrollar el modelo.\nProhibición de Categorizar Variables Continuas: Es imprudente categorizar variables naturalmente continuas durante la recolección de datos",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelos-según-la-variable-dependiente",
    "href": "diapositivas/generalidades.html#modelos-según-la-variable-dependiente",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Modelos según la variable dependiente",
    "text": "Modelos según la variable dependiente\n\n\n\n\n\n\n\nTipo de variable dependiente\nModelo estadístico\n\n\n\n\nContinua\nRegresión lineal\n\n\nBinaria (sí/no)\nRegresión logística\n\n\nConteo (número de eventos)\nRegresión de Poisson / Binomial Negativa\n\n\nTiempo hasta evento\nModelos de supervivencia (Cox, paramétricos)\n\n\nOrdinal (categorías ordenadas)\nRegresión logística ordinal\n\n\nNominal (categorías no ordenadas)\nRegresión logística multinomial",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#ejemplos-en-epidemiología",
    "href": "diapositivas/generalidades.html#ejemplos-en-epidemiología",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Ejemplos en Epidemiología",
    "text": "Ejemplos en Epidemiología\n\n\n\n\n\n\n\n\n\nTipo de variable dependiente\nModelo\nEjemplo aplicado\n\n\n\n\nContinua\nRegresión lineal\nRelación entre presión arterial sistólica y edad en adultos\n\n\nBinaria\nRegresión logística\nProbabilidad de tener tuberculosis según contacto previo\n\n\nConteo\nRegresión de Poisson / Binomial Negativa\nNúmero de casos de dengue por barrio en un mes\n\n\nTiempo hasta evento\nModelos de supervivencia (Cox, Weibull, etc.)\nTiempo hasta la recaída de pacientes con malaria tras el tratamiento\n\n\nOrdinal\nRegresión logística ordinal\nGrado de severidad de la desnutrición infantil (leve, moderada, severa) en función de variables socioeconómicas\n\n\nNominal\nRegresión logística multinomial\nTipo de desenlace obstétrico (parto eutócico, cesárea, parto instrumental) según factores maternos",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#los-modelos-como-representaciones-de-la-realidad",
    "href": "diapositivas/generalidades.html#los-modelos-como-representaciones-de-la-realidad",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Los modelos como representaciones de la realidad",
    "text": "Los modelos como representaciones de la realidad\n\nUn su forma mas simple un modelo estadístico es una representación matemática simplificada de un fenómeno real.\n\nEl Modelo Lineal Generalizado (GLM) se basa en expresar la variable dependiente como función lineal de las variables independientes.\n\nLa idea central es que la relación entre la variable dependiente y los predictores se asume lineal en los parámetros.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#expresión-matemática",
    "href": "diapositivas/generalidades.html#expresión-matemática",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Expresión matemática",
    "text": "Expresión matemática\nModelo Lineal generalizado simple\n\\[ E(Y \\mid X_1, X_2, \\ldots, X_i) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\cdots + \\beta_i X_i\\]\nEl modelo busca describir una relación entre una respuesta \\(Y\\) y un conjunto de predictores \\(X = (X_1, X_2, ..., X_p)\\).\nLos parámetros \\(\\beta = (\\beta_0, \\beta_1, ..., \\beta_p)\\) representan:\n\n\\(\\beta_0\\): intercepto\n\\(\\beta_j\\): peso o coeficiente correspondiente al predictor \\(X_j\\)",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#modelo-lineal-generalizado",
    "href": "diapositivas/generalidades.html#modelo-lineal-generalizado",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Modelo Lineal generalizado",
    "text": "Modelo Lineal generalizado\nDonde:\n- \\(E(Y \\mid X)\\): valor esperado de \\(Y\\) dado los predictores.\n- \\(\\beta_0\\): intercepto.\n- \\(\\beta_j\\): coeficientes que representan el efecto de cada variable \\(X_j\\).",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#propiedad-de-la-distribución-de-y-dado-x",
    "href": "diapositivas/generalidades.html#propiedad-de-la-distribución-de-y-dado-x",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Propiedad de la distribución de Y dado X",
    "text": "Propiedad de la distribución de Y dado X\n\nDenotamos una propiedad de la distribución condicional como:\n\n\\[C(Y | X)\\]\n\nEjemplos:\n\n\\(C(Y | X) = E(Y | X)\\): valor esperado de Y dado X (la media)\n\\(C(Y | X) = P(Y = 1 | X)\\): probabilidad de “éxito”.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#formulaciones-del-modelo",
    "href": "diapositivas/generalidades.html#formulaciones-del-modelo",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Formulaciones del Modelo",
    "text": "Formulaciones del Modelo\n\nEl modelo de regresión describe cómo una propiedad de \\(Y\\) depende de \\(X\\):\nEn modelos lineales generalizados, se restringe a modelos lineales en los parámetros:\n\n\\[C(Y|X) = g(X\\beta)\\]\nEjemplos de formulaciones\n\n\n\n\n\n\n\n\nModelo\nExpresión\nInterpretación\n\n\n\n\nLineal\n\\(E(Y|X) = X\\beta\\)\nRelación lineal, errores normales\n\n\nLogístico\n\\(P(Y=1|X) = (1 + e^{-X\\beta})^{-1}\\)\nProbabilidad binaria\n\n\nPoisson\n\\(E(Y|X) = e^{X\\beta}\\)\nConteos o tasas\n\n\nGeneral\n\\(C(Y|X) = g(X\\beta)\\)\ng puede ser no lineal",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#linealización-mediante-transformación",
    "href": "diapositivas/generalidades.html#linealización-mediante-transformación",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Linealización mediante transformación",
    "text": "Linealización mediante transformación\n\nSi el modelo no es lineal, se aplica una transformación:\n\n\\[h(C(Y|X)) = X\\beta\\]\n\nEjemplo: para regresión logística, aunque pretende estimar la probabilidad de un evento se trabaja con:\n\\[\\text{logit}(P) = \\log\\left(\\frac{P}{1-P}\\right)\\]\nde modo que: \\(h(\\dots)\\) es logit\n\n\\[\\text{logit}(P(Y=1|X)) = X\\beta\\]",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#interpretacion-de-parametros-del-modelo",
    "href": "diapositivas/generalidades.html#interpretacion-de-parametros-del-modelo",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Interpretacion de parametros del modelo",
    "text": "Interpretacion de parametros del modelo\n\nLa transformación \\(h()\\) se conoce como la función de enlace (link function).\nEl modelo general linealizado se expresa como:\n\nComponentes del modelo\n\nParte de respuesta transformada: \\(C'(Y|X)\\)\n→ propiedad de \\(Y\\) o transformación de la misma\n\nParte lineal o predictor: \\(X\\beta\\)\n→ combinación lineal ponderada de los predictores",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#interpretación-de-los-coeficientes",
    "href": "diapositivas/generalidades.html#interpretación-de-los-coeficientes",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Interpretación de los coeficientes",
    "text": "Interpretación de los coeficientes\n\nCada \\(\\beta_j\\) representa el cambio en la propiedad \\(C'(Y|X)\\) asociado a un incremento unitario en \\(X_j\\), manteniendo constantes los demás predictores:\n\n\\[\\beta_j = C'(Y|X_1,...,X_j+1,...) - C'(Y|X_1,...,X_j,...)\\]\n\nEjemplos:\n\nRegresión lineal: cambio en el valor esperado de Y\n\nRegresión logística: cambio en el logaritmo de los odds\n\nModelos Poisson: cambio en el logaritmo de la tasa esperada.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#relación-lineal",
    "href": "diapositivas/generalidades.html#relación-lineal",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Relación lineal",
    "text": "Relación lineal\n\n\n\n\nDatos muéstrales: La variable de respuesta \\(Y\\) para diferentes predictores \\(X\\)\nParámetros desconocidos: Los coeficientes \\(\\beta_j\\) de las variables.\n\n\n\n\n\n\n\n\nImportant\n\n\nEstimación por Máxima Verosimilitud",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#estimación-por-maxima-verosimilitud-mle",
    "href": "diapositivas/generalidades.html#estimación-por-maxima-verosimilitud-mle",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Estimación por maxima verosimilitud (MLE)",
    "text": "Estimación por maxima verosimilitud (MLE)",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#intuición-del-método-de-máxima-verosimilitud",
    "href": "diapositivas/generalidades.html#intuición-del-método-de-máxima-verosimilitud",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Intuición del método de máxima verosimilitud",
    "text": "Intuición del método de máxima verosimilitud\nCuando el parámetro es conocido \\(\\dots\\)\nSabemos el valor del parámetro (por ejemplo, la media o la probabilidad).\nEntonces podemos calcular la probabilidad de observar ciertos datos:\n\\[P(\\text{Datos} \\mid \\theta)\\]\n. . .\n\n\n\n\n\n\nEjemplo:\n\n\nsi sé que la probabilidad de enfermar es 0.3, puedo calcular la probabilidad de ver 3 casos en 10 personas.\n\n\n\n\\(P(k=3) = \\binom{10}{k}0.3^k(1-0.3)^{10-k} = \\binom{10}{3}0.3^3(1-0.3)^{10-3}\\) = 0.2668279",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "diapositivas/generalidades.html#pero-en-la-práctica-ocurre-al-revés-dots",
    "href": "diapositivas/generalidades.html#pero-en-la-práctica-ocurre-al-revés-dots",
    "title": "Generalidades sobre Modelos de Regresión en Epidemiologia",
    "section": "Pero en la práctica ocurre al revés \\(\\dots\\)",
    "text": "Pero en la práctica ocurre al revés \\(\\dots\\)\nTenemos los datos observados: seleccione 10 personas y observe tres enfermos, ¿Cual es la probabilidad de enfermar?\n\n\n\n\n\n\nTip\n\n\n“¿Qué valor de \\(P\\) hace más probable haber visto estos datos?”.\n\n\n\n\nAsumiendo que cada observación (dato) es una realización independiente procedente de actuar el parametro. la probabilidad que los datos ocurran conjuntamente es el producto de sus probabilidades.\n\n\\[P(\\text{Datos},\\theta) =\\binom{10}{3}P^3(1-P)^{10-3}\\]\ndamos valores a \\(P\\) entre \\(0\\) y \\(1\\) y graficamos.",
    "crumbs": [
      "Generalidades"
    ]
  },
  {
    "objectID": "rlg_simple.html#actividad",
    "href": "rlg_simple.html#actividad",
    "title": "Regresión Logistica Simple",
    "section": "Actividad",
    "text": "Actividad\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento 👉 Documento de Trabajo.\nEl dataset coronary que se puede descargar aca 👉 Descargar coronary.rds.\nDescargue el siguiente archivo denominado Codigo_taller4.R 👉 Descargar Codigo_taller4.R, donde encontrara los códigos necesarios para obtener los resultados solicitados en el taller.",
    "crumbs": [
      "Regresión Logistica Simple"
    ]
  },
  {
    "objectID": "rlg_simple.html#taller-1-regresion-logistica-simple",
    "href": "rlg_simple.html#taller-1-regresion-logistica-simple",
    "title": "Regresión Logistica Simple",
    "section": "Taller 1: Regresion Logistica Simple",
    "text": "Taller 1: Regresion Logistica Simple\n\nCon covariable categorica\n\nUsando la variable cad como variable dependiente (respuesta) y el sexo como la variable explicatoria. Estime una regresion logistica e interprete los coeficientes. ¿Que significan en palabras?.\nA un nivel de 0.05 de error alfa, contraste la hipotesis nula que el coeficiente asociado a sexo es igual a cero. ¿Qué concluye?\nCual es la interpretacion para el coeficiente de sexo ? no olvide exponenciarlo \\(e^{\\beta_1}\\)\nRealice una predicción de probabilidad de enfermedad cardiaca si se es mujer no olvide interpretar el intervalo de confianza.\n\n\n\nCon covariable numerica\n\nUsando la variable cad como variable dependiente (respuesta) y el colesterol como la variable explicatoria. Estime una regresion logistica e interprete los coeficientes. ¿Que significan en palabras?.\nA un nivel de 0.05 de error alfa, contraste la hipotesis nula que el coeficiente asociado a colesterol es igual a cero. ¿Qué concluye?\nCual es la interpretacion para el coeficiente de colesterol ? no olvide exponenciarlo \\(e^{\\beta_1}\\)\nRealice una predicción de probabilidad de enfermedad cardiaca si se tiene un colesterol de 248 y luego con colesterol de 140. Si hace la razon de estas dos cantidades estimadas (mayor sobre la menor) a que medida epidemiologica corresponde ? interprete.\nCalcule el OR asociado con un cambio de incremento en el colesterol de 108 mg/dl (es decir pasar de 140 mg/dl a 248mg/dl). Compare con la medida anterior, son iguales ?. Explique sus razones por que si o porqué no?.",
    "crumbs": [
      "Regresión Logistica Simple"
    ]
  },
  {
    "objectID": "index.html#objetivos-de-aprendizaje",
    "href": "index.html#objetivos-de-aprendizaje",
    "title": "Modelos de Regresion para Epidemiologos",
    "section": "Objetivos de Aprendizaje",
    "text": "Objetivos de Aprendizaje\n\nAprender el modelo multivariado adecuado para el control de la interacción y confusión de variables\nImplementar los modelos multivariados en los análisis de factores de riesgo frente a la enfermedad\nIdentificar los métodos adecuados para evaluar relaciones entre dos variables\nDeterminar cuál es el mejor método de análisis cuando la variable principal de resultado es de tipo cuantitativo o categórico\nAnalizar e interpretar las principales metodologías estadísticas en el análisis de datos.",
    "crumbs": [
      "Inicio"
    ]
  },
  {
    "objectID": "rls.html#actividad",
    "href": "rls.html#actividad",
    "title": "Regresion Lineal Simple",
    "section": "Actividad",
    "text": "Actividad\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento 👉 Documento de Trabajo, copiando y pegando pantallazos de los resultados y sus interpretaciones.\nEl dataset lowbwt que se puede descargar aca 👉 Descargar lowbwt.rds contiene información para una muestra de 100 recién nacidos con bajo peso al nacer. Mediciones de presión arterial sistolica son guardadas bajo el nombre de sbp y valores de edad gestacional bajo el nombre de gestage.\nDescargue el siguiente archivo denominado Codigo_taller1.R 👉 Descargar Codigo_taller1.R, donde encontrara los códigos necesarios para obtener los resultados solicitados en el taller.",
    "crumbs": [
      "Regresión Lineal Simple"
    ]
  },
  {
    "objectID": "rls.html#taller-1-regresion-lineal-simple",
    "href": "rls.html#taller-1-regresion-lineal-simple",
    "title": "Regresion Lineal Simple",
    "section": "Taller 1: Regresion Lineal Simple",
    "text": "Taller 1: Regresion Lineal Simple\n\nCon covariable continua\n\nConstruya un grafico de dispersión de presion artetial sistolica y edad gestacional. Sugiere el grafico acerca de la naturaleza de la relación entre las variables (haga una breve interpretacion del grafico).\nUsando la la presion arterial sistolica como variable dependiente (respuesta) y la edad gestacional como la variable explicatoria. Estime una regresion lineal e interprete los coeficientes. ¿Que significan en palabras?.\nA un nivel de 0.05 de error alfa, contraste la hipotesis nula que el coeficiente asociado a edad gestacional es igual a cero. ¿Qué concluye?\nCual es la media estimada de la presión arterial para la población de recien nacidos con bajo peso en quienes la edad gestacional es 31 semanas.\nConstruya un intervalo de confianza para la media cuando la edad gestacional es 31 semanas.\n¿El modelo ajustado parece ajustar a los datos observados?. comente e interprete el coeficiente de determinación, la tasa de error de las predicciones y los gráficos de diagnostico. Interprete cada uno de ellos.\n\n\n\nCon covariable categorica\nLos niveles de glucosa por encima de 125 mg/dL son diagnósticos de diabetes, mientras que niveles en el rango de 100 a 125 mg/dL indican un mayor riesgo de progresar hacia esta condición seria y cada vez más frecuente. Por ello, resulta de interés determinar si el ejercicio, un factor de estilo de vida modificable, podría ayudar a las personas sin diabetes a reducir sus niveles de glucosa y, de esta manera, evitar la diabetes.\nResponder de manera definitiva a esta pregunta requeriría un ensayo clínico aleatorizado, lo cual constituye una tarea difícil y costosa. Como resultado, preguntas de investigación como esta suelen abordarse inicialmente con datos observacionales. Sin embargo, esto se complica por el hecho de que las personas que hacen ejercicio difieren en muchos aspectos de aquellas que no lo hacen, y algunas de esas diferencias podrían explicar cualquier asociación no ajustada entre el ejercicio y el nivel de glucosa.\nPara los siguientes puntos se usara los datos del estudio HERS que se puede descargar directamente desde R copian y pegando directamente en la consola el siguinete codigo hers &lt;- rio::import(\"https://regression.ucsf.edu/sites/g/files/tkssra16191/files/wysiwyg/home/data/hersdata.dta\") %&gt;% filter(diabetes == 0). (Debes tener conexión a internet)\nEn el archivo denominado Codigo_taller1.R 👉 Descargar Codigo_taller1.R se encuentran los códigos para reproducir los resultados necesarios para contestar las siguientes preguntas:\n\nUsando la glucosa como variable dependiente (respuesta) y la actividad física como la variable explicatoria. Estime una regresión lineal e interprete el coeficiente. ¿Que significan en palabras?. Escriba la ecuación de regresión con los coeficientes estimados.\nA un nivel de 0.05 de error alfa, contraste la hipótesis nula que el coeficiente asociado a actividad física al menos 3 veces por semana es igual a cero. ¿Qué concluye?\nCual es la media estimada de la glucosa para la población que no realiza actividad fisica.\nConstruya un intervalo de confianza al 95% para la media en la glucosa de quienes realizan actividad física.\n¿El modelo ajustado parece ajustar a los datos observados?. comente e interprete el coeficiente de determinación, la tasa de error de las predicciones y los gráficos de diagnostico. Interprete cada uno de ellos.",
    "crumbs": [
      "Regresión Lineal Simple"
    ]
  },
  {
    "objectID": "rlm.html#actividad",
    "href": "rlm.html#actividad",
    "title": "Regresion Lineal Multiple",
    "section": "Actividad",
    "text": "Actividad\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento Documento de trabajo, copiando y pegando pantallazos de los resultados y sus interpretaciones.\nEl dataset lowbwt que se puede descargar aca 👉 Descargar lowbwt.rds contiene información para una muestra de 100 recién nacidos con bajo peso al nacer. mediciones de presión arterial sistolica son guardadas bajo el nombre de sbp y valores de edad gestacional bajo el nombre de gestage.\nDescargue el siguiente archivo denominado Codigo_taller2.R 👉 Descargar Codigo_taller2.R, donde encontrara los codigos necesarios para obtener los resultados solicitados en el taller.\nRecuerde que en el pasado ya habian encontrado una relación significativa entre la presion arterial sistolica de neonatos con bajo peso (sbp)y la edad gestacional (gestage). En este nuevo analisis utilizaremos la variable Apgar a los 5 minutos (apgar5), es una variable oridnal, pero frecuentemente es tratada como continua.",
    "crumbs": [
      "Regresión Lineal Multiple"
    ]
  },
  {
    "objectID": "rlm.html#taller-2-regresion-lineal-multiple",
    "href": "rlm.html#taller-2-regresion-lineal-multiple",
    "title": "Regresion Lineal Multiple",
    "section": "Taller 2: Regresion Lineal Multiple",
    "text": "Taller 2: Regresion Lineal Multiple\n\nConstruya un grafico de dispersión de presion artetial sistolica y apgar . ¿Parece tener una relación lineal entre las dos variables?.\nUsando la presión arterial sistolica como variable dependiente (respuesta), la edad gestacional y el apgar como variables explicatorias. Estime los parametros del modelo \\[\\hat \\mu_{sbp} = \\beta_0 + \\beta_1 \\times gestage + \\beta_2 \\times apgar\\]\n\n\nInterprete \\(\\hat \\beta_1\\), ¿qué significa en palabras?, realice lo mismo para \\(\\hat \\beta_2\\)\n\n\nCual es la media estimada de la presión arterial para la población de recien nacidos con bajo peso en quienes la edad gestacional es 31 semanas y apgar a los 5 minutos sea de 7, Interprete.\nConstruya un intervalo de confianza para la media cuando la edad gestacional es 31 semanas y el apgar es de 7. Interpretelo.\nA un nivel de 0.05 de error alfa, contraste \\(H_0: \\beta_2 = 0\\)?, ¿Qué concluye?\n¿El modelo ajustado parece ajustar a los datos observados?.Revise el \\(R^2\\) ajustado comente e interprete. estime la tasa de error de las predicciones.\nla inclusión del apgar aporta significativamente al modelo como para dejarlo en el modelo?.\nConstruya los graficos de diagnostico, hay cumplimiento de los supuestos de validez del modelo?",
    "crumbs": [
      "Regresión Lineal Multiple"
    ]
  },
  {
    "objectID": "rlm.html#taller-3-ajuste-para-confusion-e-interacción-en-regresion-lineal-multiple",
    "href": "rlm.html#taller-3-ajuste-para-confusion-e-interacción-en-regresion-lineal-multiple",
    "title": "Regresion Lineal Multiple",
    "section": "Taller 3: Ajuste para confusion e interacción en regresion lineal multiple",
    "text": "Taller 3: Ajuste para confusion e interacción en regresion lineal multiple\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento Documento de trabajo.\nSi desea reproducir los resultados en su PC, los datos se pueden descargar aca 👉 Descargar hers.rds.\n\nConfusión\nSe esta estudiando los efectos que se puedan dar sobre los niveles de glucosa sobre un grupo de pacientes, para esto se ajusto inicialmente un modelo que estimo el principal que tiene un programa donde se recibe actividad física 3 veces a la semana, los resultados fueron los siguientes:\n\nmod_unjus &lt;- lm(formula = glucose ~ exercise, data = hers)\nsummary(mod_unjus)\n\n\nCall:\nlm(formula = glucose ~ exercise, data = hers)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-85.561 -20.561 -12.561   2.672 189.672 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 114.5611     0.8922 128.408  &lt; 2e-16 ***\nexercise     -6.2333     1.4350  -4.344 1.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 36.73 on 2761 degrees of freedom\nMultiple R-squared:  0.006788,  Adjusted R-squared:  0.006428 \nF-statistic: 18.87 on 1 and 2761 DF,  p-value: 1.451e-05\n\nconfint(mod_unjus)\n\n                 2.5 %     97.5 %\n(Intercept) 112.811683 116.310441\nexercise     -9.047117  -3.419576\n\n\nA la luz de las estimaciones:\n\nInterprete el coeficiente asociado al programa de actividad física, acompañe esta interpretación de sus respectivos intervalos de confianza al 95% y valor de p.\n\nSin embargo es de conocimiento pleno que otras variables tambien se relacionan con los niveles de glucosa en sangre, específicamente se tiene conocimiento que el indice de masa corporal que define obesidad, podria tambine jugar un papel preponderante tanto con la glucosa como el programa de actividad fisica. Dado esto se ajusta el efecto entre el progama de actividad fisica y glucosa:\n\nmod &lt;- lm(formula = glucose ~ exercise + BMI , data = hers)\nsummary(mod)\n\n\nCall:\nlm(formula = glucose ~ exercise + BMI, data = hers)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-79.18 -18.72 -10.35   3.79 192.38 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  62.4154     3.7402  16.688   &lt;2e-16 ***\nexercise     -2.8932     1.4066  -2.057   0.0398 *  \nBMI           1.7794     0.1242  14.331   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.46 on 2755 degrees of freedom\n  (5 observations deleted due to missingness)\nMultiple R-squared:  0.07576,   Adjusted R-squared:  0.07509 \nF-statistic: 112.9 on 2 and 2755 DF,  p-value: &lt; 2.2e-16\n\n\n\nEl efecto que tiene el programa de ejercicio cambio despues del ajuste?, si fue asi, qué dirección tomo?, cuantifique su cambio porcentual (\\(\\frac{\\beta_{crudo}-\\beta_{ajustado}}{\\beta_{crudo}}\\times100\\)). Se confirma que BMI sesgaba el efecto que tenia el programa de ejercicio sobre la glucosa?. Explique.\nAhora interprete el coeficiente ajustado del programa de actividad fisica. acompañelos de intervalos de confianza y valor de p.\n\n\nconfint(mod)\n\n                2.5 %     97.5 %\n(Intercept) 55.081469 69.7492613\nexercise    -5.651330 -0.1350112\nBMI          1.535926  2.0228348\n\n\n\npor ultimo asuma que evalúa por el contrario el efecto de BMI sobre la glucosa teniendo en cuenta el ajuste por pertenecer a un programa de actividad fisica. Interprete coeficiente ajustado de BMI, no olvide en su interpretación hablar de los intervalos de confianza y valores de p.\nFinalmente se ajusta el siguiente modelo explicativo sobre el efecto sobre la glucosa que tienen diversas variables. Interprete cada uno de los coeficientes, como efecto principal.\n\n\nmod_com &lt;- lm(formula = glucose ~ exercise + BMI + age + drinkany + smoking , data = hers)\nsummary(mod_com)\n\n\nCall:\nlm(formula = glucose ~ exercise + BMI + age + drinkany + smoking, \n    data = hers)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-77.533 -18.879  -9.858   4.765 192.487 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  89.7184     8.7503  10.253  &lt; 2e-16 ***\nexercise     -3.5013     1.4193  -2.467  0.01369 *  \nBMI           1.6225     0.1274  12.733  &lt; 2e-16 ***\nage          -0.2843     0.1051  -2.705  0.00687 ** \ndrinkanyyes  -7.1882     1.3832  -5.197 2.17e-07 ***\nsmokingyes   -6.3218     2.0852  -3.032  0.00245 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.24 on 2750 degrees of freedom\n  (7 observations deleted due to missingness)\nMultiple R-squared:  0.08872,   Adjusted R-squared:  0.08707 \nF-statistic: 53.55 on 5 and 2750 DF,  p-value: &lt; 2.2e-16\n\nconfint(mod_com)\n\n                 2.5 %       97.5 %\n(Intercept)  72.560556 106.87633140\nexercise     -6.284288  -0.71838376\nBMI           1.372648   1.87237829\nage          -0.490288  -0.07822204\ndrinkanyyes  -9.900321  -4.47606535\nsmokingyes  -10.410451  -2.23321159\n\n\n\n\nInteracción\nSe quiere evaluar en el modelo de efectos principales del programa de actividad fisica sobre la glucosa la posibilidad de una heterogeneidad de efectos mediada por el indice de masa corporal. Para este proposito se ajusto un modelo con un termino de interacción, entre BMI y el programa de ejercicio:\n\nEscribe la ecuación del modelo con el termino de interacción:\n\n\nmod2 &lt;- lm(formula = glucose ~ exercise + BMI + exercise:BMI, data = hers)\nsummary(mod2)\n\n\nCall:\nlm(formula = glucose ~ exercise + BMI + exercise:BMI, data = hers)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-84.543 -18.890 -10.382   4.243 193.710 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   67.2848     4.4908  14.983   &lt;2e-16 ***\nexercise     -17.4940     7.5928  -2.304   0.0213 *  \nBMI            1.6133     0.1504  10.730   &lt;2e-16 ***\nexercise:BMI   0.5211     0.2663   1.957   0.0505 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.44 on 2754 degrees of freedom\n  (5 observations deleted due to missingness)\nMultiple R-squared:  0.07705,   Adjusted R-squared:  0.07604 \nF-statistic: 76.63 on 3 and 2754 DF,  p-value: &lt; 2.2e-16\n\n\n\nDespeje de la ecuación de regresión escrita por ud, el efecto (pendiente) del programa de ejercicio para un BMI de 15.2 y para BMI 54.1, calculelo según el modelo estimado e interprételo.\nDespeje de la ecuación de regresión escrita por ud, el efecto (pendiente) del BMI para pertenecer y no al programa de ejercicio, calculelo según el modelo estimado e interprételo.\nEl siguiente grafico refuerza tiene coherencia frente al resultado calculado en el punto anterior (efecto de BMI sobre glucosa según pertenezca al programa)\n\n\nplot_predictions(mod2, by = c(\"BMI\", \"exercise\"))+\n  theme(axis.text = element_text(size = 20), axis.title = element_text(size = 20))",
    "crumbs": [
      "Regresión Lineal Multiple"
    ]
  },
  {
    "objectID": "rlg_multiple.html",
    "href": "rlg_multiple.html",
    "title": "Regresión Logistica Multiple",
    "section": "",
    "text": "Las diapositivas se puede descargar aca 👉 Descargar Regresión logistica multiple.pdf..",
    "crumbs": [
      "Regresión Logistica Multiple"
    ]
  },
  {
    "objectID": "rlg_multiple.html#diapositivas",
    "href": "rlg_multiple.html#diapositivas",
    "title": "Regresión Logistica Multiple",
    "section": "",
    "text": "Las diapositivas se puede descargar aca 👉 Descargar Regresión logistica multiple.pdf..",
    "crumbs": [
      "Regresión Logistica Multiple"
    ]
  },
  {
    "objectID": "rlg_multiple.html#taller-5-regresion-logistica-multiple-confusion-e-interacción",
    "href": "rlg_multiple.html#taller-5-regresion-logistica-multiple-confusion-e-interacción",
    "title": "Regresión Logistica Multiple",
    "section": "Taller 5: Regresion logistica multiple, confusion e interacción",
    "text": "Taller 5: Regresion logistica multiple, confusion e interacción\nEn grupos desarrollar el siguiente taller en clase, el cual se trabajara de manera directa online en el siguiente documento 👉 Documento de Trabajo.\nDatos utilizados en el presente taller corresponde a seguimiento de 3154 sujetos para evaluar la incidencia (probabilidad) de enfermedad coronaria. contiene 22 variables, sin embargo no todas seran usadas para este ejercicio pedagodico.\n\nglimpse(wcgs)\n\nRows: 3,154\nColumns: 22\n$ age      &lt;dbl&gt; 50, 51, 59, 51, 44, 47, 40, 41, 50, 43, 59, 54, 48, 39, 49, 5…\n$ arcus    &lt;dbl&gt; 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1…\n$ behpat   &lt;chr&gt; \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"A1\", \"…\n$ bmi      &lt;dbl&gt; 31.32101, 25.32858, 28.69388, 22.14871, 22.31303, 27.11768, 2…\n$ chd69    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0…\n$ chol     &lt;dbl&gt; 249, 194, 258, 173, 214, 206, 190, 212, 130, 233, 181, 214, 2…\n$ dbp      &lt;dbl&gt; 90, 74, 94, 80, 80, 76, 78, 84, 70, 80, 86, 76, 78, 74, 80, 7…\n$ dibpat   &lt;chr&gt; \"Type A\", \"Type A\", \"Type A\", \"Type A\", \"Type A\", \"Type A\", \"…\n$ height   &lt;dbl&gt; 67, 73, 70, 69, 71, 64, 70, 70, 71, 68, 72, 67, 71, 70, 73, 7…\n$ id       &lt;dbl&gt; 2343, 3656, 3526, 22057, 12927, 16029, 3894, 11389, 12681, 10…\n$ lnsbp    &lt;dbl&gt; 4.882802, 4.787492, 5.062595, 4.836282, 4.836282, 4.753590, 4…\n$ lnwght   &lt;dbl&gt; 5.298317, 5.257495, 5.298317, 5.010635, 5.075174, 5.062595, 5…\n$ ncigs    &lt;dbl&gt; 25, 25, 0, 0, 0, 80, 0, 25, 0, 25, 10, 0, 20, 0, 4, 0, 0, 20,…\n$ sbp      &lt;dbl&gt; 132, 120, 158, 126, 126, 116, 122, 130, 112, 120, 130, 118, 1…\n$ smoke    &lt;fct&gt; Yes, Yes, No, No, No, Yes, No, Yes, No, Yes, Yes, No, Yes, No…\n$ t1       &lt;dbl&gt; -1.6333529, -4.0633659, 0.6397287, 1.1217681, 2.4250107, -0.7…\n$ time169  &lt;dbl&gt; 1367, 2991, 2960, 3069, 3081, 2114, 2929, 3010, 3104, 2861, 2…\n$ typchd69 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0…\n$ uni      &lt;dbl&gt; 0.48607379, 0.18595429, 0.72779906, 0.62446356, 0.37897763, 0…\n$ weight   &lt;dbl&gt; 200, 192, 200, 150, 160, 158, 162, 160, 195, 187, 206, 152, 1…\n$ wghtcat  &lt;chr&gt; \"170-200\", \"170-200\", \"170-200\", \"140-170\", \"140-170\", \"140-1…\n$ agec     &lt;chr&gt; \"46-50\", \"51-55\", \"56-60\", \"51-55\", \"41-45\", \"46-50\", \"35-40\"…\n\n\n\nModelo propuesto para el estudio de enfermedad coronaria\n\nmod_base &lt;- glm(chd69 ~ age + chol + sbp + bmi + smoke,\ndata = wcgs, family = binomial)\n\n\nextract_eq(mod_base)\n\n\\[\n\\log\\left[ \\frac { P( \\operatorname{chd69} = \\operatorname{1} ) }{ 1 - P( \\operatorname{chd69} = \\operatorname{1} ) } \\right] = \\alpha + \\beta_{1}(\\operatorname{age}) + \\beta_{2}(\\operatorname{chol}) + \\beta_{3}(\\operatorname{sbp}) + \\beta_{4}(\\operatorname{bmi}) + \\beta_{5}(\\operatorname{smoke}_{\\operatorname{Yes}})\n\\]\n\n\nEl modelo estimado es el siguiente, asuma que el cumplimiento de criterios de validez como linealidad e independencia se cumplen.\n\nsummary(mod_base)\n\n\nCall:\nglm(formula = chd69 ~ age + chol + sbp + bmi + smoke, family = binomial, \n    data = wcgs)\n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -12.336305   0.975011 -12.652  &lt; 2e-16 ***\nage           0.064356   0.011905   5.406 6.45e-08 ***\nchol          0.010839   0.001491   7.267 3.67e-13 ***\nsbp           0.019305   0.004091   4.719 2.37e-06 ***\nbmi           0.057671   0.026350   2.189   0.0286 *  \nsmokeYes      0.632693   0.140079   4.517 6.28e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1779.2  on 3141  degrees of freedom\nResidual deviance: 1614.6  on 3136  degrees of freedom\n  (12 observations deleted due to missingness)\nAIC: 1626.6\n\nNumber of Fisher Scoring iterations: 6\n\n\n\nReescriba la ecuación del modelo ahora que ya se estimaron los coeficientes correspondientes:\nInterprete cada coeficiente de las variables smoke, age y chol como fue estimado sin transformaciones. Para cada uno realice contrate de hipotesis y concluya.\nConstruya una tabla de resultados con 2 columnas, en una nombre de la variable y la otra el OR, este ultimo se obtiene aplicando la función exponencial sobre los coeficiente estimados del modelo. Interprete cada uno.\nEn un modelo previo en el que no incluía edad (age), los OR fueron:\n\n\ntbl_regression(glm(chd69 ~ chol + sbp + bmi + smoke, data = wcgs, family = binomial),exponentiate = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nOR\n95% CI\np-value\n\n\n\n\nchol\n1.01\n1.01, 1.01\n&lt;0.001\n\n\nsbp\n1.02\n1.02, 1.03\n&lt;0.001\n\n\nbmi\n1.05\n1.00, 1.11\n0.057\n\n\nsmoke\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.82\n1.39, 2.39\n&lt;0.001\n\n\n\nAbbreviations: CI = Confidence Interval, OR = Odds Ratio\n\n\n\n\n\n\n\n\nAgregue estos resultados a la tabla que construyo en el punto 3. evalue si edad era un probable confusor para las demas efectos estimados.\n\n\n\n\n\n\nAyuda\n\n\n\ncalcula el porcentaje de cambio de cada uno y comenta.\n\n\n\n\nEvaluación de interacción\nProbaremos interacciones candidatas y seleccionaremos la más prometedora (por ejemplo, chol * bmi). Se ilustran dos vías: prueba de Wald (coeficiente) y LRT (comparación de modelos).\n\n# Candidata: interacción entre el colesterol y el IMC\n\nmod_int &lt;- glm(chd69 ~ age + chol + sbp + bmi + smoke + chol:bmi,\ndata = wcgs, family = binomial)\n\nsummary(mod_int)\n\n\nCall:\nglm(formula = chd69 ~ age + chol + sbp + bmi + smoke + chol:bmi, \n    family = binomial, data = wcgs)\n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept) -18.907862   3.030107  -6.240 4.38e-10 ***\nage           0.063522   0.011919   5.330 9.84e-08 ***\nchol          0.038311   0.012053   3.179  0.00148 ** \nsbp           0.019644   0.004094   4.798 1.60e-06 ***\nbmi           0.317604   0.115552   2.749  0.00599 ** \nsmokeYes      0.623352   0.139956   4.454 8.43e-06 ***\nchol:bmi     -0.001087   0.000471  -2.308  0.02100 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1779.2  on 3141  degrees of freedom\nResidual deviance: 1609.5  on 3135  degrees of freedom\n  (12 observations deleted due to missingness)\nAIC: 1623.5\n\nNumber of Fisher Scoring iterations: 6\n\n\n\nRealice un contraste bajo el test de wald asumiendo que el coeficiente asociado al termino de interacción chol*bmi se plantea la \\(H_o: \\beta_6=0\\). Interprete el resultado.\nAhora vamos a comparar el modelo base (sin interacción) y el modelo con interacción, para definir que este termino contribuye al modelo final. Pra esto realizamos el test de verosimilitud (LTR).\n\nCompara mod_base vs mod_int (chol:bmi) con LRT y con la p de Wald del término de interacción. ¿Mantienes la interacción?\n\n# Prueba LRT vs. modelo base\n\nanova(mod_base, mod_int, test = \"Chisq\")\n\nAnalysis of Deviance Table\n\nModel 1: chd69 ~ age + chol + sbp + bmi + smoke\nModel 2: chd69 ~ age + chol + sbp + bmi + smoke + chol:bmi\n  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  \n1      3136     1614.6                       \n2      3135     1609.5  1    5.071  0.02433 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nPendientes interpretables (Heterogeneidad de efectos)\n\nSi mantienes la interacción segun tu interpretación y conclusión del punto anterior, interpreta cómo varía el efecto de colesterol según el IMC (usa cambio de +20 mg/dL de chol en bmi = 22, 26, 30). (deje como evidencia sus calculos o despejes realizados para llegar a las respuestas)\nCon el R software con el modelo ajustado se lograron estimar los mismos efectos de interacción mostrados acontinuación:\n\n\n\n\n bmi Estimate Std. Error    z Pr(&gt;|z|)    S 2.5 % 97.5 %\n  22     1.32     0.0545 5.80   &lt;0.001 27.2  1.21   1.42\n  26     1.21     0.0338 6.18   &lt;0.001 30.5  1.14   1.27\n  30     1.11     0.0538 2.07   0.0382  4.7  1.01   1.22\n\nTerm: chol\nType:  response \nComparison: +20\n\n\nComparelos a los encontrados por usted de manera manual. Son iguales? si fue asi, interpretelos como un reporte en magnitudes de asociación (cuantitativamente y acompañe de intervalos y valores p) y que concluye de la interacción bmi y chol.\nNo fueron iguales?, revise su calculo y trate de encontrar su error. e interprete de nuevo.\n\n\nPredicciones\n\nbasados en el modelo ajustado con interaccion, para age=55, sbp=130, smoke=Fuma, la siguiente tabla muestra la diferencia de probabilidad (diferencia absoluta de riesgo) cuando cambia la probabilidad al subir chol de 180 a 260 (cambio en 80 mg/dl) para bmi de 22, 28 y 32.\n\n\ncomparisons(mod_int,\n  variable = list(\"chol\" = 80),newdata = datagrid(bmi = c(22,28,32)),comparison = \"difference\",hypothesis = 0)\n\n\n bmi Estimate Std. Error     z Pr(&gt;|z|)    S   2.5 % 97.5 %\n  22   0.0753     0.0178 4.218  &lt; 0.001 15.3  0.0403 0.1102\n  28   0.0464     0.0144 3.228  0.00125  9.6  0.0182 0.0745\n  32   0.0226     0.0242 0.934  0.35017  1.5 -0.0248 0.0701\n\nTerm: chol\nType:  response \nComparison: +80\n\n\nInterprete cuantitaviamente esas diferencias de riesgo para los cambios de colesterol a distintos valores de bmi.\nCon relación al punto 2 de la sección de interacción, aunque los cambios evalauados en chol fueron mayores y otros valores similares de bmi alos evaluados en este punto, ¿Cual cree usted que es mejor para comunicar el riesgo asociado a enfermedad cardiovascular a un publico cientifico? Explique su respuesta.\n\n\nAjuste de confusión por Propensity score\nLos datos corresponde a un seguimiento de pacientes en los cuales se prescribió un programa de ejercicio para la reduccion del indice de masa corporal (\\(kg/m^2\\)), sin embargo al no tener una asignación aleatoria al programa de ejercicios, y poder evaluar los efectos de manera equiparable entre los participantes de reviso las diferencias que podrian haber entre los que fueron y no asignados, los resultados fueron:\n\nEfecto de tratamiento, estimación cruda\n\n\n  tbl_regression(lm(BMI~exercise,data = hers))\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI\np-value\n\n\n\n\nexercise\n-1.9\n-2.3, -1.5\n&lt;0.001\n\n\n\nAbbreviation: CI = Confidence Interval\n\n\n\n\n\n\n\n\nla diferencia promedio estimada atribuible al ejericcio es un reducción de 1.9 \\(kg/m^2\\) en el indice de masa corporal para quienes recibieron el programa de ejercicio.\nLas variables relacionadas al ejericio se muestran a continuacion:\n\nhers %&gt;% \n  select(exercise,age,diabetes,SBP,glucose1,tchol1, statins) %&gt;% \n  tbl_summary(by = exercise, missing = \"no\") %&gt;% \n  add_p()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n0 N = 1,6951\n1 N = 1,0681\np-value2\n\n\n\n\nage\n67 (62, 72)\n67 (62, 72)\n0.5\n\n\ndiabetes\n504 (30%)\n227 (21%)\n&lt;0.001\n\n\nSBP\n135 (123, 148)\n131 (120, 144)\n&lt;0.001\n\n\nglucose1\n101 (92, 121)\n98 (90, 110)\n&lt;0.001\n\n\ntchol1\n215 (193, 243)\n213 (193, 240)\n0.4\n\n\nstatins\n593 (35%)\n411 (38%)\n0.063\n\n\n\n1 Median (Q1, Q3); n (%)\n\n\n2 Wilcoxon rank sum test; Pearson’s Chi-squared test\n\n\n\n\n\n\n\n\n\nQue variables podrían ser candidatas a estimar la probabilidad de haber recibido el tratamiento:\n\nSe ajusto el siguiente modelo de regresión logistica:\n\nps &lt;- glm(exercise~diabetes+SBP+glucose1+statins, data = hers, family = \"binomial\")\nsummary(ps)\n\n\nCall:\nglm(formula = exercise ~ diabetes + SBP + glucose1 + statins, \n    family = \"binomial\", data = hers)\n\nCoefficients:\n             Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  0.777903   0.319742   2.433 0.014978 *  \ndiabetes    -0.279763   0.125040  -2.237 0.025261 *  \nSBP         -0.007422   0.002184  -3.399 0.000678 ***\nglucose1    -0.001707   0.001282  -1.331 0.183222    \nstatins      0.115953   0.083396   1.390 0.164407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 3498.4  on 2612  degrees of freedom\nResidual deviance: 3460.2  on 2608  degrees of freedom\n  (150 observations deleted due to missingness)\nAIC: 3470.2\n\nNumber of Fisher Scoring iterations: 4\n\n\nSe estima la probabilidad y se calculan las ponderaciones:\n\nhers &lt;- hers %&gt;% \n  mutate(ps = 1/(1+exp(-0.777903+diabetes*0.279763+SBP*0.007422+glucose1*0.001707-statins*0.115953))) %&gt;% \n  mutate(pond = if_else(exercise == 1,1/ps,1/(1-ps)))\nhers %&gt;% \n  select(1:3,ps,pond) %&gt;% \n  head()\n\n               HT age           raceth        ps     pond\n1         placebo  70 African American 0.4277987 1.747637\n2         placebo  62 African American 0.4424958 1.793709\n3 hormone therapy  69            White 0.3399103 1.514946\n4         placebo  64            White 0.3754299 1.601101\n5         placebo  65            White 0.3367098 1.507636\n6 hormone therapy  68 African American 0.3296364 1.491728\n\n\nLa comparación entre los grupos de tratamiento re-ponderada es la siguiente:\n\nsurvey::svydesign(~1, data = hers %&gt;% \n                    filter(!is.na(pond)) %&gt;%\n                    select(exercise,age,diabetes,SBP,glucose1,tchol1, statins,pond), weights = ~pond) %&gt;% \n  tbl_svysummary(by = exercise, percent = \"row\") %&gt;% \n  add_p()\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n0 N = 2,6111\n1 N = 2,6181\np-value2\n\n\n\n\nage\n67 (62, 72)\n68 (62, 72)\n0.3\n\n\ndiabetes\n682 (50%)\n691 (50%)\n0.9\n\n\nSBP\n134 (121, 147)\n133 (122, 147)\n&gt;0.9\n\n\nglucose1\n100 (91, 116)\n99 (90, 115)\n0.14\n\n\ntchol1\n215 (193, 243)\n213 (193, 241)\n0.6\n\n\n    Unknown\n3\n0\n\n\n\n\nstatins\n960 (50%)\n955 (50%)\n0.9\n\n\npond\n1.67 (1.55, 1.76)\n2.48 (2.29, 2.87)\n&lt;0.001\n\n\n\n1 Median (Q1, Q3); n (%)\n\n\n2 Design-based KruskalWallis test; Pearson’s X^2: Rao & Scott adjustment\n\n\n\n\n\n\n\n\n\nComparativamente a esta misma tabla del punto 1, que diferencia hay? como puedes describir el efecto que se dio tras el uso de IPTW ?\nAhora estimamos de nuevo el efecto del tratamiento corregido por el IPTW:\n\n\n  tbl_regression(lm(BMI~exercise,data = hers, weights = pond))\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI\np-value\n\n\n\n\nexercise\n-1.6\n-2.0, -1.2\n&lt;0.001\n\n\n\nAbbreviation: CI = Confidence Interval\n\n\n\n\n\n\n\n\nSe corrigio la medida de efecto de tratamiento tras la aplicación de IPTW ?, cuanto cambio ? hacia donde estaba el sesgo introducido por las variables confusoras medidas en el estudio ?",
    "crumbs": [
      "Regresión Logistica Multiple"
    ]
  },
  {
    "objectID": "diapositivas/rlgm.html#conjunto-de-datos-stroke.rds",
    "href": "diapositivas/rlgm.html#conjunto-de-datos-stroke.rds",
    "title": "Regresión Logistica Multiple",
    "section": "Conjunto de datos: stroke.rds",
    "text": "Conjunto de datos: stroke.rds\n\nUsaremos el dataset stroke.rds en formato R. 👉 Descargar stroke.rds\n\nContiene 226 observaciones y 7 variables:\n\n\n\n\n\n\n\n\nVariable\nDescripción\n\n\n\n\nstatus\nEstado del paciente durante la hospitalización ( 0 vivo / 1 fallecido)\n\n\ngcs\nEscala de Glasgow al ingreso (3–15)\n\n\nstroke_type\nTipo de ictus (0 = isquémico; 1 = hemorrágico)\n\n\nsex\nSexo biológico (1 femenino / 0masculino)\n\n\ndm\nHistoria de diabetes (sí / no)\n\n\nsbp\nPresión arterial sistólica (mmHg)\n\n\nage\nEdad al ingreso (años)"
  },
  {
    "objectID": "diapositivas/rlgm.html#necesidad-bivariado-vs-multivariado",
    "href": "diapositivas/rlgm.html#necesidad-bivariado-vs-multivariado",
    "title": "Regresión Logistica Multiple",
    "section": "Necesidad: Bivariado vs Multivariado",
    "text": "Necesidad: Bivariado vs Multivariado\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n0 N = 1711\n1 N = 551\np-value2\n\n\n\n\nsex\n81 (47%)\n16 (29%)\n0.017\n\n\nStroke Haemorrhagic\n39 (23%)\n38 (69%)\n&lt;0.001\n\n\n\n1 n (%)\n\n\n2 Pearson’s Chi-squared test"
  },
  {
    "objectID": "diapositivas/rlgm.html#regresión-logistica-multiple",
    "href": "diapositivas/rlgm.html#regresión-logistica-multiple",
    "title": "Regresión Logistica Multiple",
    "section": "Regresión Logistica Multiple",
    "text": "Regresión Logistica Multiple\n\nLa Regresión Logistica Mutiple modela la relación lineal entre:\n\nUna variable dependiente categorica (ej. Status).\n\ny dos o mas predictores (numéricos y categóricos).\n\n\nExpresión matemática\n\\[E(Y \\mid X_1,X_2,\\dots X_i) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\dots + \\beta_iX_i\\] \\(E(Y) = P(Y)\\) Recordar que \\(Y = [0,1]\\) si se asume asi los valores de \\(Y\\) estimados por el modelo lineal simple siempre los valores estimados de \\(Y\\) se salen de \\(0\\) o de \\(1\\)."
  },
  {
    "objectID": "diapositivas/rlgm.html#modelo-enlace-y-probabilidades",
    "href": "diapositivas/rlgm.html#modelo-enlace-y-probabilidades",
    "title": "Regresión Logistica Multiple",
    "section": "Modelo, enlace y probabilidades",
    "text": "Modelo, enlace y probabilidades\n\\[Odds = \\frac{P(Y/X_i)}{1-P(Y/X_i)}\\] el logaritmo de Odds \\(Log(odds)\\) si es lineal en terminos de una covariable, y se llama el logit.\n\\[\n\\log(\\frac{P(Y/X_i)}{1-P(Y/X_i)}) = \\beta_0 + \\beta_1X + \\dots +\\beta_iX_i\n\\]\n\\[\nP(Y/X_i)=\\frac{1}{1+e^{-\\left(\\beta_0 + \\beta_1X_1 + \\dots +\\beta_iX_i\\right)}}\n\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#estimación-por-máxima-verosimilitud",
    "href": "diapositivas/rlgm.html#estimación-por-máxima-verosimilitud",
    "title": "Regresión Logistica Multiple",
    "section": "Estimación por Máxima Verosimilitud",
    "text": "Estimación por Máxima Verosimilitud\n\nLa idea central es elegir los parámetros \\(\\beta_0, \\beta_1, \\dots \\beta_i\\) que maximizan la probabilidad de observar los datos.\n\n\\[\nL(P(\\beta_0,\\beta_1,\\dots,\\beta_i/Y,X_i))=\\sum_{i=1}^n\\Big[y_i(\\beta_0+\\beta_1 X_1+\\dots\\beta_i)-\\log\\!\\big(1+e^{\\beta_0+\\beta_1 X_1+\\dots +\\beta_iX_i}\\big)\\Big].\n\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke",
    "href": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke",
    "title": "Regresión Logistica Multiple",
    "section": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke",
    "text": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke\n\nAsumimos que la relación lineal en el \\(logit(P)\\) es decir \\(\\log(\\frac{P}{1-P})\\)\n\n\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -0.8362480  0.1917084 -4.362084 1.288295e-05\nsex         -0.7856124  0.3340625 -2.351693 1.868821e-02\n\n\nAhora ajustemos un nuevo modelo que incluya el efecto que pueda tener el tipo de stroke, el modelo seria:\n\\[\\log(odds) = \\beta_0 + \\beta_1sex + \\beta_2strokeType\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke-1",
    "href": "diapositivas/rlgm.html#modelo-probabilidad-de-muerte-en-funcion-del-sexo-y-tipo-de-stroke-1",
    "title": "Regresión Logistica Multiple",
    "section": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke",
    "text": "Modelo: Probabilidad de muerte en funcion del sexo y tipo de Stroke"
  },
  {
    "objectID": "diapositivas/rlgm.html#el-modelo-es-adecuado",
    "href": "diapositivas/rlgm.html#el-modelo-es-adecuado",
    "title": "Regresión Logistica Multiple",
    "section": "¿El modelo es adecuado?",
    "text": "¿El modelo es adecuado?\nPrueba chi-cuadrado\nminimizar la perdida de informacion Deviance residual comparada con la nula.\n\nresiduos_log_1 &lt;- modelo_mult$null.deviance - modelo_mult$deviance\n#Grados de Libertad.\ngrados_log_1 &lt;- modelo_mult$df.null - modelo_mult$df.residual\n#p-value.\npchisq(residuos_log_1, grados_log_1,lower.tail = F)\n\n[1] 4.940062e-10"
  },
  {
    "objectID": "diapositivas/rlgm.html#estimación-de-coeficientes",
    "href": "diapositivas/rlgm.html#estimación-de-coeficientes",
    "title": "Regresión Logistica Multiple",
    "section": "Estimación de coeficientes",
    "text": "Estimación de coeficientes\n\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept) -1.7565411  0.2837494 -6.190467 5.998629e-10\nsex         -0.7611076  0.3643847 -2.088748 3.673045e-02\nstroke_type  2.0141947  0.3483070  5.782815 7.346092e-09\n\n\nRecordar la \\(H_o: \\beta_i = 0\\)"
  },
  {
    "objectID": "diapositivas/rlgm.html#interpretación-de-coeficientes",
    "href": "diapositivas/rlgm.html#interpretación-de-coeficientes",
    "title": "Regresión Logistica Multiple",
    "section": "Interpretación de Coeficientes",
    "text": "Interpretación de Coeficientes\n\n\\(\\beta_0\\) es el valor medio que asumen la variable dependiente (\\(\\log(odds)\\)) cuando todas las covariables toman valor cero (Cuidado No aplica siempre o se refiere a una subpoblacion que no es de interes o de proposito)\n\n\\[\\log(odds) = -1.75 - 0.7611sex + 2.01strokeType\\]\nEn nuestro caso, las covariables cero son: Hombre(0), isquemico(0), entonces\n\\[\\log(odds) = -1.75\\] \\[e^{\\log(odds)} = e^{-1.75}\\] \\[odds = 0.173\\]\nConviertanlo en Probabilidad."
  },
  {
    "objectID": "diapositivas/rlgm.html#interpretación-de-coeficientes-1",
    "href": "diapositivas/rlgm.html#interpretación-de-coeficientes-1",
    "title": "Regresión Logistica Multiple",
    "section": "Interpretación de Coeficientes",
    "text": "Interpretación de Coeficientes\n\n\\(\\beta_1\\): para obtener interpretación de este coeficiente realizamos la siguiente comparación de resultados del modelo cuando sexo asume ser constante y la variable stroke_type es hemorragico(1) e isquemico(0)\n\n\n\\[e^{\\log(odds_{hem})} =odds_{hem} = e^{\\beta_0 + \\beta_1sex + \\beta_2(1)}\\]\n\n\n\\[\ne^{\\log(odds_{isq})} = odds_{isq} = e^{\\beta_0+\\beta_1sex+\\beta_2(0)}\n\\]\n\n\n\\[\\frac{odds_{hem}}{odds_{isq}} = \\frac{e^{\\beta_0 + \\beta_1sex+\\beta_2(1)}}{e^{\\beta_0 + \\beta_1sex+\\beta_2(0)}} = e^{\\beta_0 + \\beta_1sex+\\beta_2(1)}e^{-\\beta_0 - \\beta_1sex-\\beta_2(0)} = e^{\\beta_2}\\]\n\n\n¿Se concluye entonces qué?"
  },
  {
    "objectID": "diapositivas/rlgm.html#predicciones-con-el-modelo-para-probabilidades",
    "href": "diapositivas/rlgm.html#predicciones-con-el-modelo-para-probabilidades",
    "title": "Regresión Logistica Multiple",
    "section": "Predicciones con el modelo para probabilidades",
    "text": "Predicciones con el modelo para probabilidades\n\\[P(Y=1/X_i)= \\frac{1}{1 + e^{-(\\beta_0+\\beta_1+\\dots+\\beta_i)}}\\] \\[P(Y=1/sex,stroketype)= \\frac{1}{1 + e^{-(-1.75-0.76sex++2.01stroketype)}}\\]\n\nProbabilidad de fallecer siendo mujer y stroke hemorragico\n\n\npredict(modelo_mult,newdata = data.frame(sex = 1,stroke_type = 1),type = \"response\")\n\n        1 \n0.3767293 \n\n\n\nProbabilidad de fallecer siendo hombre y stroke hemorragico\n\n\npredict(modelo_mult,newdata = data.frame(sex = 0, stroke_type = 1), type = \"response\")\n\n        1 \n0.5640594"
  },
  {
    "objectID": "diapositivas/rlgm.html#inferencia-coeficientes-y-predicciones",
    "href": "diapositivas/rlgm.html#inferencia-coeficientes-y-predicciones",
    "title": "Regresión Logistica Multiple",
    "section": "Inferencia: Coeficientes y Predicciones",
    "text": "Inferencia: Coeficientes y Predicciones\n\nsummary(modelo_mult)$coefficients %&gt;% kable()\n\n\n\n\n\nEstimate\nStd. Error\nz value\nPr(&gt;|z|)\n\n\n\n\n(Intercept)\n-1.7565411\n0.2837494\n-6.190467\n0.0000000\n\n\nsex\n-0.7611076\n0.3643847\n-2.088748\n0.0367305\n\n\nstroke_type\n2.0141947\n0.3483070\n5.782815\n0.0000000\n\n\n\n\n\n\nexp(coefficients(modelo_mult))\n\n(Intercept)         sex stroke_type \n  0.1726410   0.4671487   7.4946893 \n\nexp(confint(modelo_mult)) %&gt;% kable()\n\n\n\n\n\n2.5 %\n97.5 %\n\n\n\n\n(Intercept)\n0.0956288\n0.2926718\n\n\nsex\n0.2238593\n0.9409725\n\n\nstroke_type\n3.8476842\n15.1571568"
  },
  {
    "objectID": "diapositivas/rlgm.html#diagnóstico-supuestos",
    "href": "diapositivas/rlgm.html#diagnóstico-supuestos",
    "title": "Regresión Logistica Multiple",
    "section": "Diagnóstico: Supuestos",
    "text": "Diagnóstico: Supuestos\nDeterminar si el modelo representa adecuadamente a los datos.\n\nL de Linealidad: Los valores de (Y) se pueden expresar como una función lineal de la variable (X).\nI de Independencia:Los valores de (Y) (o los errores/residuos) son independientes entre sí."
  },
  {
    "objectID": "diapositivas/rlgm.html#diagnostico-con-graficos-verificación-de-supuestos",
    "href": "diapositivas/rlgm.html#diagnostico-con-graficos-verificación-de-supuestos",
    "title": "Regresión Logistica Multiple",
    "section": "Diagnostico con graficos (Verificación de supuestos)",
    "text": "Diagnostico con graficos (Verificación de supuestos)"
  },
  {
    "objectID": "diapositivas/rlgm.html#incluyendo-mas-variables-ejemplo-numerica",
    "href": "diapositivas/rlgm.html#incluyendo-mas-variables-ejemplo-numerica",
    "title": "Regresión Logistica Multiple",
    "section": "Incluyendo mas variables (Ejemplo: numerica)",
    "text": "Incluyendo mas variables (Ejemplo: numerica)\n\nmodelo_new &lt;- glm(formula = status ~ sex + stroke_type + gcs, stroke, family = binomial(link = 'logit'))\nsummary(modelo_new)$coefficients\n\n              Estimate Std. Error   z value     Pr(&gt;|z|)\n(Intercept)  2.3012969 0.71127424  3.235457 1.214484e-03\nsex         -0.5124684 0.42794355 -1.197514 2.311062e-01\nstroke_type  1.1189027 0.41587007  2.690510 7.134284e-03\ngcs         -0.3286912 0.05456293 -6.024076 1.700784e-09\n\n\nDebemos evaluar si la inclusión de la variable glasglow aporta o no al modelo, No Olvidar principio de parsimonia en modelamiento."
  },
  {
    "objectID": "diapositivas/rlgm.html#prueba-chi2",
    "href": "diapositivas/rlgm.html#prueba-chi2",
    "title": "Regresión Logistica Multiple",
    "section": "Prueba \\(\\chi^2\\)",
    "text": "Prueba \\(\\chi^2\\)\ncompara las diferencias entre las deviance entre los modelos, la cual tiene una distribución \\(\\chi^2\\).\n\\(H_o: model_1 = model_2\\)\n\nanova(modelo_mult, modelo_new)\n\n  Analysis of Deviance Table\n  \n  Model 1: status ~ sex + stroke_type\n  Model 2: status ~ sex + stroke_type + gcs\n    Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    \n  1       223     207.97                          \n  2       222     162.72  1   45.254 1.731e-11 ***\n  ---\n  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "diapositivas/rlgm.html#aic",
    "href": "diapositivas/rlgm.html#aic",
    "title": "Regresión Logistica Multiple",
    "section": "AIC",
    "text": "AIC\n\nAIC(modelo_mult, modelo_new)\n\n              df      AIC\n  modelo_mult  3 213.9693\n  modelo_new   4 170.7152"
  },
  {
    "objectID": "diapositivas/rlgm.html#prueba-de-bondad-de-ajuste-o-test-de-hosmer-lemeshow",
    "href": "diapositivas/rlgm.html#prueba-de-bondad-de-ajuste-o-test-de-hosmer-lemeshow",
    "title": "Regresión Logistica Multiple",
    "section": "Prueba de bondad de ajuste o test de Hosmer-Lemeshow",
    "text": "Prueba de bondad de ajuste o test de Hosmer-Lemeshow\n\nCuando llegamos a este punto del análisis, estamos presuponiendo que el modelo contiene todas las variables importantes.\nAhora el siguiente paso es saber lo eficiente que es es modelo a la hora de predecir la variable respuesta. A esto se le llama bondad de ajuste.\nDiremos que un modelo ajusta bien si la diferencia entre los valores observados y los ajustados, es pequeña."
  },
  {
    "objectID": "diapositivas/rlgm.html#test-de-hosmer-y-lemeshow",
    "href": "diapositivas/rlgm.html#test-de-hosmer-y-lemeshow",
    "title": "Regresión Logistica Multiple",
    "section": "Test de Hosmer y Lemeshow",
    "text": "Test de Hosmer y Lemeshow\n\\(H_o\\): el modelo se ajusta bien a los datos.\n\\(H_1\\): el modelo no se ajusta bien (mal ajuste).\n👉 Si \\(p &gt; 0.05\\), no se rechaza \\(H_o\\), lo que sugiere un buen ajuste.\n👉 Si \\(p &lt; 0.05\\), se rechaza \\(H_o\\), indicando un posible mal ajuste.\n\nhoslem.test(stroke$status, fitted(modelo_new), g = 10)\n\n\n    Hosmer and Lemeshow goodness of fit (GOF) test\n\ndata:  stroke$status, fitted(modelo_new)\nX-squared = 5.911, df = 5, p-value = 0.315"
  },
  {
    "objectID": "diapositivas/rlgm.html#confusión",
    "href": "diapositivas/rlgm.html#confusión",
    "title": "Regresión Logistica Multiple",
    "section": "Confusión",
    "text": "Confusión\n\nRecordando: Es un efecto sesgado o no real entre una exposición y un desenlace, que ocurre como consecuencia de una variable o unas variables confusoras.\n\n\\[\\log(Odds) = \\beta_0 + \\beta_1X_1 + \\beta_2X_2\\]\nPara la exposición principal \\(X_1 = 1\\), veamos que sucede al estar \\(X_2\\) en el modelo:\n\\[\\log(Odds)= \\beta_0 + \\beta_1 + \\beta_2X_2\\]\n\nPara un valor constante de \\(X_2\\) ejemplo \\(1\\)\n\n\\[\\log(Odds)= \\beta_0 + \\beta_1 + \\beta_2\\]\n\nPara un valor constante de \\(X_2\\) ejemplo \\(0\\)\n\n\\[\\log(Odds)= \\beta_0 + \\beta_1\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#graficamente-pendientes-iguales",
    "href": "diapositivas/rlgm.html#graficamente-pendientes-iguales",
    "title": "Regresión Logistica Multiple",
    "section": "Graficamente (Pendientes iguales)",
    "text": "Graficamente (Pendientes iguales)"
  },
  {
    "objectID": "diapositivas/rlgm.html#interacción",
    "href": "diapositivas/rlgm.html#interacción",
    "title": "Regresión Logistica Multiple",
    "section": "Interacción",
    "text": "Interacción\n\nDefinición: El efecto de una exposición sobre el desenlace varia en función de otra covariable. (heterogeneidad de efectos o modificación de efectos).\n\n\n\n\\[\n\\log\\left[ \\frac { \\widehat{P( \\operatorname{status} = \\operatorname{1} )} }{ 1 - \\widehat{P( \\operatorname{status} = \\operatorname{1} )} } \\right] = 2.3 - 0.51(\\operatorname{sex}) + 1.12(\\operatorname{stroke\\_type}) - 0.33(\\operatorname{gcs})\n\\]\n\n\n\nCon interacción\n\n\n\n                  Estimate Std. Error    z value     Pr(&gt;|z|)\n(Intercept)      2.7422663 0.74532432  3.6792926 2.338818e-04\nsex             -1.9581832 0.84758859 -2.3102992 2.087160e-02\nstroke_type      0.4192474 0.50167231  0.8356996 4.033239e-01\ngcs             -0.3391453 0.05641262 -6.0118702 1.833952e-09\nsex:stroke_type  2.4216873 1.03907813  2.3306114 1.977386e-02\n\n\n\\[\n\\log\\left[ \\frac { \\widehat{P( \\operatorname{status} = \\operatorname{1} )} }{ 1 - \\widehat{P( \\operatorname{status} = \\operatorname{1} )} } \\right] = 2.74 - 1.96(\\operatorname{sex}) + 0.42(\\operatorname{stroke\\_type}) - 0.34(\\operatorname{gcs}) + 2.42(\\operatorname{sex} \\times \\operatorname{stroke\\_type})\n\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#section",
    "href": "diapositivas/rlgm.html#section",
    "title": "Regresión Logistica Multiple",
    "section": "",
    "text": "\\[\n\\log\\left[ \\frac { P( \\operatorname{status} = \\operatorname{1} ) }{ 1 - P( \\operatorname{status} = \\operatorname{1} ) } \\right] = \\alpha + \\beta_{1}(\\operatorname{sex}) + \\beta_{2}(\\operatorname{stroke\\_type}) + \\beta_{3}(\\operatorname{gcs}) + \\beta_{4}(\\operatorname{sex} \\times \\operatorname{stroke\\_type})\n\\]\n\\[\n\\log\\left[ \\frac { \\widehat{P( \\operatorname{status} = \\operatorname{1} )} }{ 1 - \\widehat{P( \\operatorname{status} = \\operatorname{1} )} } \\right] = 2.74 - 1.96(\\operatorname{sex}) + 0.42(\\operatorname{stroke\\_type}) - 0.34(\\operatorname{gcs}) + 2.42(\\operatorname{sex} \\times \\operatorname{stroke\\_type})\n\\]\nEstimemos efectos ajustados y su heterogeneidad\n\n\n\n\n\n\n\n\n\n\n\n\nsex\nstroke_type\ngcs\nEfecto\nOdds\nOR\nCoeficiente\n\n\n\n\n1\n0\n1+\n-1.958\n-0.4068\n0.14\n\\(\\beta_0 + \\beta_1sex - \\beta_3gcs\\)\n\n\n1\n1\n1+\n0.464\n0.0362\n1.59\n\\(\\beta_0+(\\beta_1+\\beta_4)sex+\\beta_2stroketype+\\beta_3gcs\\)\n\n\n\n\n\n\n sex stroke_type gcs Estimate Std. Error     z Pr(&gt;|z|)   S  2.5 % 97.5 %\n   1           0   3   -1.958      0.848 -2.31   0.0209 5.6 -3.619 -0.297\n   1           1   3    0.464      0.586  0.79   0.4293 1.2 -0.686  1.613\n\nTerm: sex\nType:  link \nComparison: 1 - 0"
  },
  {
    "objectID": "diapositivas/rlgm.html#graficamente-para-un-valor-medio-de-gcs",
    "href": "diapositivas/rlgm.html#graficamente-para-un-valor-medio-de-gcs",
    "title": "Regresión Logistica Multiple",
    "section": "Graficamente: Para un valor medio de GCS",
    "text": "Graficamente: Para un valor medio de GCS"
  },
  {
    "objectID": "diapositivas/rlgm.html#estimando-rr-or-dr-desde-la-regresión-logistica",
    "href": "diapositivas/rlgm.html#estimando-rr-or-dr-desde-la-regresión-logistica",
    "title": "Regresión Logistica Multiple",
    "section": "Estimando RR, OR, DR desde la regresión logistica",
    "text": "Estimando RR, OR, DR desde la regresión logistica\n\\[P(status=1/sex,stroke_type,gcs)=\\frac{1}{1+e^{-\\left(\\beta_0+\\beta_1sex+\\beta_2stroke_type+\\beta_3gcs+\\beta_4sexstroke\\right)}}\n\\]"
  },
  {
    "objectID": "diapositivas/rlgm.html#problema-central",
    "href": "diapositivas/rlgm.html#problema-central",
    "title": "Regresión Logistica Multiple",
    "section": "Problema central",
    "text": "Problema central\n\nEnsayos Clínicos: Evidencia mas alta en cuanto a evaluar el efecto de un tratamiento.\nAsignación de tratamientos equiparable, incluso para variables no medidas.\nProbabilidad de asignación de tratamiento es: 50%.\n\n\n\n\n\n\n\n\n\n\nAsgnación aleatoria\n\n\n\n\n\n\n\nAsignación no aleatoria"
  },
  {
    "objectID": "diapositivas/rlgm.html#una-solución-estimando-la-probabilidad-de-asignación-de-exposicióntratamiento",
    "href": "diapositivas/rlgm.html#una-solución-estimando-la-probabilidad-de-asignación-de-exposicióntratamiento",
    "title": "Regresión Logistica Multiple",
    "section": "Una solución: Estimando la probabilidad de asignación de exposición/tratamiento",
    "text": "Una solución: Estimando la probabilidad de asignación de exposición/tratamiento"
  },
  {
    "objectID": "diapositivas/rlgm.html#propensity-score-probabilidad-de-tratamiento-asignado",
    "href": "diapositivas/rlgm.html#propensity-score-probabilidad-de-tratamiento-asignado",
    "title": "Regresión Logistica Multiple",
    "section": "Propensity Score: Probabilidad de tratamiento asignado",
    "text": "Propensity Score: Probabilidad de tratamiento asignado\n\nUn modelo de regresión logistica ayudaria:\n\n\\[P(T = 1/X_1,X_2,X_3\\dots ,X_i) = \\beta_0+\\beta_1X_1+\\beta_2X_2+\\dots+\\beta_iX_i\\]\ndonde, \\(X_i\\) son Confusores\nFormas de usarlo:\n\nParear (Matching) por propensity score los sujetos de la muestra.\nEstratificar por rangos (percentiles) usando propensity score.\nCrear un modelo para desenlace colocando como covariable el propensity score\nAplicar re-ponderación muestral IPTW (Inverse Probability Treatment Weight)"
  },
  {
    "objectID": "diapositivas/rlgm.html#pareo-matching-por-propensity-score",
    "href": "diapositivas/rlgm.html#pareo-matching-por-propensity-score",
    "title": "Regresión Logistica Multiple",
    "section": "Pareo (Matching) por propensity score",
    "text": "Pareo (Matching) por propensity score\n\n\n\n\n\n\n\n\n\n\n\n\n\nVentaja: calculo de medidas de asociacion o efecto no cambian\nDesventaja: Grado de tolerancia en el match por el propensity"
  },
  {
    "objectID": "diapositivas/rlgm.html#estratificación-por-propensity-score",
    "href": "diapositivas/rlgm.html#estratificación-por-propensity-score",
    "title": "Regresión Logistica Multiple",
    "section": "Estratificación por Propensity score",
    "text": "Estratificación por Propensity score\n\n\n\n\nFalleció\nSobrevivió\nTotal\n\n\n\n\nBPMEDS1 = 1\n91\n48\n139\n\n\nBPMEDS1 = 0\n627\n606\n1233\n\n\n\n\n\n\n\n\n\n\n\n\n\nVariable\nMedicados\nNo medicados\n\n\n\n\nEdad media\n56.3\n53.6\n\n\nColesterol\n257\n246\n\n\nSBP\n165\n154\n\n\nDiabetes (%)\n6\n4\n\n\nCHD (%)\n14\n7\n\n\nHombres (%)\n30\n47\n\n\n\n\n\n\n\n\nRango de PS\nBPMEDS=1\nBPMEDS=0\n\n\n\n\n0.00–0.05\n8.6%\n19.0%\n\n\n0.05–0.10\n30.9%\n46.6%\n\n\n0.10–0.15\n26.6%\n21.6%\n\n\n0.15–0.20\n14.4%\n6.6%\n\n\n0.20–0.25\n6.5%\n2.6%\n\n\n0.25–0.30\n5.8%\n2.3%\n\n\n&gt;0.30\n7.2%\n1.4%\n\n\n\n\n\n\n\n\nNo es sorprendente que el 33,81 % de los participantes que toman medicación para la hipertensión pertenezcan a los últimos cuatro estratos, en comparación con solo el 12,90 % de los participantes que no toman medicación."
  },
  {
    "objectID": "diapositivas/rlgm.html#section-1",
    "href": "diapositivas/rlgm.html#section-1",
    "title": "Regresión Logistica Multiple",
    "section": "",
    "text": "Variable\nCrudo: Meds\nCrudo: No Meds\nPS-ajustado: Meds\nPS-ajustado: No Meds\n\n\n\n\nEdad\n56.3\n53.6\n53.9\n53.8\n\n\nColesterol\n257\n246\n245.8\n247.4\n\n\nSBP\n165\n154\n153.9\n155.4\n\n\nDiabetes (%)\n6\n4\n4\n5\n\n\nCHD (%)\n14\n7\n9\n8\n\n\n\nLa medida de efecto es calculada para cada estrato y la medida total es un promedio ponderado. (OR y RR por el metodo de Mantel-Haenszel)"
  },
  {
    "objectID": "diapositivas/rlgm.html#recordar-metodo-de-mantel-haenszel",
    "href": "diapositivas/rlgm.html#recordar-metodo-de-mantel-haenszel",
    "title": "Regresión Logistica Multiple",
    "section": "Recordar: Metodo de Mantel-Haenszel",
    "text": "Recordar: Metodo de Mantel-Haenszel\nPara \\(g\\) tabla de cada estrato:\n\n\n\n\nFalleció\nSobrevivió\nTotal\n\n\n\n\nBPMEDS1 = 1\na\nb\na + b\n\n\nBPMEDS1 = 0\nc\nd\nc + d\n\n\nTotal\na + c\nb + d\nn\n\n\n\n\\[OR_{MH} = \\frac{\\sum_{i=1,g}(a_id_i/T_i)}{\\sum_{i=1,g}(b_ic_i/T_i)}\\] Donde \\(T_i\\) es el numero total de observaciones en cada tabla.\n\\(OR_{c} = 1.83\\)\n\\(OR_{a} = 1.37\\)"
  },
  {
    "objectID": "diapositivas/rlgm.html#section-2",
    "href": "diapositivas/rlgm.html#section-2",
    "title": "Regresión Logistica Multiple",
    "section": "",
    "text": "Incluir como covariable de ajuste el propensity en el modelo:\n\nVentajas: Reduce la cantidad de parámetros en el modelo.\nDesventaja: No permite evaluar heterogeneidad de efectos (incluir varibales para intereacción).\n\nWeighting IPTW\n\nSe crea un ponderador que corresponde al inverso de la probabilidad de tratamiento asigando, similar a encuestas con muestreo complejo.\n\nPara grupo tratado: \\(\\frac{1}{PS}\\)\nPara grupo no tratado: \\(\\frac{1}{1-PS}\\)\n\\(PS\\) = Propensity Score\nResultado: Expansión de la muestra con grupos asigandos creando una pseudo-población.\nveamos como \\(\\dots\\)"
  },
  {
    "objectID": "diapositivas/rlgm.html#demostrando-como-actua-iptw",
    "href": "diapositivas/rlgm.html#demostrando-como-actua-iptw",
    "title": "Regresión Logistica Multiple",
    "section": "Demostrando como actua IPTW",
    "text": "Demostrando como actua IPTW\nQueremos evaluar el efecto de un tratamiento (T=1) sobre un desenlace, sabiendo que los grupos son desiguales.\n\n\n\nID\nTratamiento (T)\nEdad (X)\nPS = P(T=1\n\n\n\n\n1\n1\n70\n0.80\n\n\n2\n1\n60\n0.40\n\n\n3\n0\n55\n0.40\n\n\n4\n0\n40\n0.30\n\n\n5\n0\n30\n0.20\n\n\n6\n0\n25\n0.10\n\n\n\nSolo 2 tratados y 3 no tratados → grupos desbalanceados."
  },
  {
    "objectID": "diapositivas/rlgm.html#cálculo-de-pesos-iptw",
    "href": "diapositivas/rlgm.html#cálculo-de-pesos-iptw",
    "title": "Regresión Logistica Multiple",
    "section": "Cálculo de pesos IPTW",
    "text": "Cálculo de pesos IPTW\n\\[\nw_i = \\begin{cases}\n1/PS_i, & \\text{si } T_i=1 \\\\\\\\\n1/(1-PS_i), & \\text{si } T_i=0\n\\end{cases}\n\\]\n\n\n\nID\nT\nPS\nFórmula peso\nPeso (wᵢ)\nEventos\n\n\n\n\n1\nA\n0.80\n1 / 0.70\n1.42\n1\n\n\n2\nA\n0.60\n1 / 0.40\n2.5\n0\n\n\n3\nB\n0.40\n1 / (1–0.40)\n1.67\n1\n\n\n4\nB\n0.30\n1 / (1–0.30)\n1.43\n1\n\n\n5\nB\n0.20\n1 / (1–0.20)\n1.25\n0\n\n\n\n\\(T=A\\): 1/2 = 0.5\n\\(T=B\\): 2/3 = 0.66"
  },
  {
    "objectID": "diapositivas/rlgm.html#muestra-expandida",
    "href": "diapositivas/rlgm.html#muestra-expandida",
    "title": "Regresión Logistica Multiple",
    "section": "Muestra expandida",
    "text": "Muestra expandida\n\n\n\n\n\n\n\n\n\nGrupo\nn real\nΣ w (pesos)\nEventos\n\n\n\n\nTratados\n2\n1.42 + 2.25 = 3.65\n1.42\n\n\nNo tratados\n4\n1.67 + 1.43 + 1.25 = 4.35\n1.67+1.43 = 3.1\n\n\n\n\\(T=A\\): 1.42/3.65 = 0.39\n\\(T=B\\): 3.1/4.35 = 0.71"
  }
]