{
  "hash": "62ec2a5f86b6c05afc76fa49a164ca42",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Regresion Lineal Simple\"\nauthor: \"Jorge Mario Estrada Alvarez PhD. MSc. FETP\"\nfooter:  \"Bioestadistica III\"\n#logo: \"images/imagen-cursoR.png\"\neditor: source\nformat: \n  revealjs: \n    theme: slides.scss\n    transition: fade\n    slide-number: true\n    chalkboard: true\nexecute:\n  echo: true\n  output: asis\n  freeze: auto\ncache: false\n---\n\n\n\n\n\n## Objetivos de aprendizaje\n\nDespu√©s de este modulo, se espera que los estudiantes sean capaces de:\n\n-   Entender el concepto de **regresi√≥n lineal simple** y **regresi√≥n lineal m√∫ltiple**\n-   Realizar un an√°lisis de regresi√≥n lineal simple (ajustar el modelo)\n-   Realizar regresi√≥n lineal m√∫ltiple (ajuste con m√°s de un predictor)\n-   Evaluar el **ajuste del modelo** de regresi√≥n lineal (diagn√≥sticos, $R^2$, residuos, supuestos)\n-   Presentar e interpretar los resultados del an√°lisis de regresi√≥n lineal (coeficientes, intervalos, significado)\n\n## Conjunto de datos: *coronary.rds* {.smaller}\n\n-   Usaremos el dataset **coronary.rds** en formato `R`.¬†üëâ [Descargar coronary.rds](datasets/coronary.rds)\\\n-   Corresponde a un **ensayo cl√≠nico hipot√©tico** con informaci√≥n de caracter√≠sticas individuales, niveles de colesterol total y grupos de intervenci√≥n.\\\n-   Contiene **200 observaciones** y **9 variables**:\n\n| Variable | Descripci√≥n |\n|----|----|\n| **id** | Identificaci√≥n del sujeto |\n| **cad** | Estado de enfermedad coronaria (categ√≥rica: *sin CAD*, *con CAD*) |\n| **sbp** | Presi√≥n arterial sist√≥lica (mmHg, num√©rica) |\n| **dbp** | Presi√≥n arterial diast√≥lica (mmHg, num√©rica) |\n| **chol** | Colesterol total (mmol/L, num√©rica) |\n| **age** | Edad en a√±os (num√©rica) |\n| **bmi** | √çndice de masa corporal (num√©rica) |\n| **race** | Raza (categ√≥rica: malayo, chino, indio) |\n| **gender** | Sexo (categ√≥rica: mujer, hombre) |\n\n## Introducci√≥n a la Regresi√≥n Lineal\n\n-   La regresi√≥n lineal es uno de los **an√°lisis estad√≠sticos m√°s comunes** en las ciencias de la salud.\n\n-   Modela la relaci√≥n lineal (recta) entre una variable resultado **num√©rica** (por ejemplo colesterol, presi√≥n arterial, IMC) y predictores que pueden ser num√©ricos o categ√≥ricos.\n\n-   En t√©rminos ‚Äúcoloquiales‚Äù, podr√≠amos estar interesados en saber c√≥mo var√≠a (distribuci√≥n) el nivel de colesterol en terminos de distintas variables.\n\n-   La regresi√≥n lineal es un caso particular del **Modelo Lineal Generalizado (GLM)**; los modelos que veremos m√°s adelante (log√≠stico).\n\n# Distribuci√≥n de Colesterol\n\n\n\n\n```{.r .cell-code}\nggplot2::ggplot(coronary, aes(x = chol))+\n  geom_histogram(color = \"white\")+\n  theme_classic()+\n  labs(x = \"mg/dl\")\n```\n\n![](RLSM_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n\n\n\n# Distribuci√≥n por una variable\n\n::::: columns\n::: {.column width=\"50%\"}\n\n\n\n```{.r .cell-code}\nggplot2::ggplot(coronary)+\n  geom_histogram(aes(x = chol, group = as.factor(cad),fill = as.factor(cad)))+\n  theme_classic()+\n  theme(text = element_text(size = 25))+\n  labs(x = \"mg/dl\")\n```\n\n![](RLSM_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n\n```{.r .cell-code}\nggplot2::ggplot(coronary, aes(x = chol, y =sbp))+\n  geom_point(size = 2)+\n  theme_classic()+\n  theme(text = element_text(size = 25))+\n  labs(x = \"Colestero mg/dl\", y = \"Presion sistolica (mmHg)\")\n```\n\n![](RLSM_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n\n\n:::\n:::::\n\n# Relaci√≥n lineal\n\n\n\n\n```{.r .cell-code}\nggplot2::ggplot(coronary, aes(x = chol, y =sbp))+\n  geom_point(size = 2)+\n  theme_classic()+\n  theme(text = element_text(size = 25))+\n  labs(x = \"Colestero mg/dl\", y = \"Presion sistolica (mmHg)\")\n```\n\n![](RLSM_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n\n\n\n# Relaci√≥n lineal\n\n\n\n\n```{.r .cell-code}\nggplot2::ggplot(coronary, aes(x = chol, y =sbp))+\n  geom_point(size = 2)+\n  theme_classic()+\n  theme(text = element_text(size = 25))+\n  labs(x = \"Colestero mg/dl\", y = \"Presion sistolica (mmHg)\")+\n  geom_smooth(method = lm)\n```\n\n![](RLSM_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n\n\n\n## Regresi√≥n Lineal Simple {.smaller}\n\n-   La **Regresi√≥n Lineal Simple (RLS)** modela la relaci√≥n lineal entre:\n    -   Una **variable dependiente num√©rica** (ej. colesterol).\\\n    -   **Un √∫nico predictor** (num√©rico o categ√≥rico).\n-   Cuando el predictor es categ√≥rico, se puede interpretar como un **ANOVA de una v√≠a**.\n\n### Expresi√≥n matem√°tica\n\n$$\nE(Y \\mid X) = \\beta_0 + \\beta_1 X\n$$\n\nDonde:\\\n- $E(Y \\mid X)$: valor esperado (predicho) (promedio) de la variable dependiente dado $X$.\\\n- $\\beta_0$: intercepto.\\\n- $\\beta_1$: coeficiente del predictor $X$.\n\n# Estimaci√≥n de los parametros del modelo\n\n## Estimaci√≥n por M√°xima Verosimilitud (caso 1 covariable)\n\n-   La idea central es elegir los par√°metros $\\beta_0, \\beta_1$ que **maximizan la probabilidad** de observar los datos.\n\n### Supuestos b√°sicos\n\n-   Los errores $\\varepsilon_i$ se asumen **independientes** y distribuidos:\\\n    $\\varepsilon_i \\sim N(0, \\sigma^2)$\n\n-   Entonces:\\\n    $$\n    Y_i \\sim N(\\beta_0 + \\beta_1 X_i, \\, \\sigma^2)\n    $$\n\n## Funci√≥n de verosimilitud {.smaller}\n\n$$\nL(\\beta_0, \\beta_1, \\sigma^2 \\mid Y) \n= \\prod_{i=1}^n \n\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp \\left( -\\frac{(Y_i - \\beta_0 - \\beta_1 X_i)^2}{2\\sigma^2} \\right)\n$$\n\n### Estimadores MLE\n\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^n (X_i - \\bar{X})^2}\n$$\n\n$$\n\\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X}\n$$\n\n::::: columns\n::: {.column width=\"50%\"}\n$\\widehat{\\sigma}^2 = \\frac{1}{n-2} \\sum_{i=1}^n \\left( Y_i - \\hat{Y}_i \\right)^2$\n:::\n\n::: {.column width=\"50%\"}\n$SE(\\hat{\\beta}_1) = \\sqrt{ \\frac{\\widehat{\\sigma}^2}{\\sum_{i=1}^n (X_i - \\bar{X})^2} }$\n\n$SE(\\hat{\\beta}_0) = \\sqrt{ \\widehat{\\sigma}^2 \\left( \\frac{1}{n} + \\frac{\\bar{X}^2}{\\sum_{i=1}^n (X_i - \\bar{X})^2} \\right) }$\n:::\n:::::\n\n## Modelo: Colesterol en funcion de la Presi√≥n arterial sistolica\n\n**Objetivo:** Se requiere predecir los valores de colesterol de pacientes cuando se conoce su presion arterial sistolica.\n\n-   Asumimos que la relaci√≥n entre las variables es lineal $r = 0.39$\n\n-   Segun el modelo lineal planteado seria:\n\n$$\\mu_{chol} = \\beta_0 + \\beta_1 \\times sbp$$\n\nQue valores asumen $\\beta_0$ y $\\beta_1$\n\n## Ajuste del modelo\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_simple <- lm(data = coronary, formula = chol~sbp)\nsummary(modelo_simple)\n```\n:::\n\n\n\n![](rsl.png){width=\"150\"}\n\n## ¬øel modelo es adecuado? {.smaller}\n\n### Prueba F\n\n`F-statistic: 36.52 on 1 and 198 DF,  p-value: 7.377e-09`: el modelo es significativo, con la `sbp` se permite explicar el `chol`.\n\n### Error estandar residual\n\n`Residual standard error: 19.6` para saber que tan grande es: Tasa de error de predicci√≥n:\n\n\n\n\n```{.r .cell-code}\nsummary(modelo_simple)$sigma/mean(coronary$chol)*100\n```\n\n[1] 17.58923\n\n\n\nUna tasas de error de 17.6%\n\n### Coeficiente de determinacion $R^2$\n\n\n\n\n```{.r .cell-code}\nsummary(modelo_simple)$r.squared\n```\n\n[1] 0.1557222\n\n\n\nEl ajuste es regular, se explica el 15.5% de la variabilidad del Colesterol\n\n## Estimaci√≥n de coeficientes {.smaller}\n\n\n\n\n```{.r .cell-code}\nmodelo_simple <- lm(data = coronary, formula = chol~1)\n\nsummary(modelo_simple)$coefficients\n```\n\n            Estimate Std. Error  t value      Pr(>|t|)\n(Intercept) 111.5737   1.506458 74.06359 8.021754e-147\n\n\n```{.r .cell-code}\nmean(coronary$chol)\n```\n\n[1] 111.5737\n\n\n\n### con covariable\n\n\n\n\n```{.r .cell-code}\nmodelo_simple <- lm(data = coronary, formula = chol~sbp)\nsummary(modelo_simple)$coefficients %>% kable()\n```\n\n\n\n|            |   Estimate| Std. Error|  t value| Pr(>&#124;t&#124;)|\n|:-----------|----------:|----------:|--------:|------------------:|\n|(Intercept) | 56.3342138|  9.2455346| 6.093127|                  0|\n|sbp         |  0.4243314|  0.0702166| 6.043176|                  0|\n\n\n\nModelo completo: $\\mu_{chol} = 56.33 + 0.42 \\times sbp$\n\n## Interpretaci√≥n de Coeficientes\n\n-   $\\beta_0$ es el valor medio que asumen la variable dependiente cuando la covariable toma valor cero. (unidades de la variable dependiente)\n\n-   $\\beta_1$: Es el cambio en promedio que tiene la variable dependiente por unidad de cambio de la covariable.\n\n$$\\mu_{chol} = 56.33 + 0.42 \\times sbp$$\n\nEl colesterol cambia en promedio en 0.42 mg/dl por cada mmHg de presi√≥n arterial sistolica.\n\n**Ahora si estariamos en capacidad de predecir cual es el valor medio del colesterol para un sujeto que tiene 120 mmHg de presion arterial sistolica.**\n\n## Predicciones con el modelo\n\n\n\n\n```{.r .cell-code}\npredict(modelo_simple,newdata = data.frame(sbp = 120))\n```\n\n      1 \n107.254 \n\n\n```{.r .cell-code}\npredict(modelo_simple,newdata = data.frame(sbp = 180))\n```\n\n       1 \n132.7139 \n\n\n\n## Inferencia: Coeficientes y Predicciones\n\n### Contrastes de hip√≥tesis\n\n-   $H_0: \\beta_j = 0$\n\n-   $H_a: \\beta_j \\neq 0$ para $j=0,1$\n\n-   Estad√≠stico de prueba:\\\n    $$t = \\frac{\\hat{\\beta}_j}{SE(\\hat{\\beta}_j)} \\sim t_{n-p-1}$$\n\n### Intervalos de confianza\n\n-   A un nivel de confianza $1-\\alpha$:\\\n    $$\n    IC_{1-\\alpha}(\\beta_j) = \\hat{\\beta}_j \\;\\pm\\; t_{\\alpha/2, \\, n-p-1} \\times SE(\\hat{\\beta}_j)\n    $$\n\n## Inferencia: Coeficientes y Predicciones\n\n\n\n\n```{.r .cell-code}\nsummary(modelo_simple)$coefficients %>% kable()\n```\n\n\n\n|            |   Estimate| Std. Error|  t value| Pr(>&#124;t&#124;)|\n|:-----------|----------:|----------:|--------:|------------------:|\n|(Intercept) | 56.3342138|  9.2455346| 6.093127|                  0|\n|sbp         |  0.4243314|  0.0702166| 6.043176|                  0|\n\n\n```{.r .cell-code}\nconfint(modelo_simple) %>% kable()\n```\n\n\n\n|            |     2.5 %|     97.5 %|\n|:-----------|---------:|----------:|\n|(Intercept) | 38.101858| 74.5665696|\n|sbp         |  0.285863|  0.5627998|\n\n\n\n## Inferencia en predicciones\n\n\n\n\n```{.r .cell-code}\npredictions(modelo_simple, newdata = data.frame(sbp = c(120,180))) %>% \n  select(2:9) %>% \n  kable(digits = 2,align = \"c\",\"html\")\n```\n\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> estimate </th>\n   <th style=\"text-align:center;\"> std.error </th>\n   <th style=\"text-align:center;\"> statistic </th>\n   <th style=\"text-align:center;\"> p.value </th>\n   <th style=\"text-align:center;\"> s.value </th>\n   <th style=\"text-align:center;\"> conf.low </th>\n   <th style=\"text-align:center;\"> conf.high </th>\n   <th style=\"text-align:center;\"> sbp </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 107.25 </td>\n   <td style=\"text-align:center;\"> 1.56 </td>\n   <td style=\"text-align:center;\"> 68.71 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> Inf </td>\n   <td style=\"text-align:center;\"> 104.19 </td>\n   <td style=\"text-align:center;\"> 110.31 </td>\n   <td style=\"text-align:center;\"> 120 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 132.71 </td>\n   <td style=\"text-align:center;\"> 3.76 </td>\n   <td style=\"text-align:center;\"> 35.26 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 902.53 </td>\n   <td style=\"text-align:center;\"> 125.34 </td>\n   <td style=\"text-align:center;\"> 140.09 </td>\n   <td style=\"text-align:center;\"> 180 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n\n```{.r .cell-code}\navg_comparisons(modelo_simple,variables = list(sbp = c(120, 180))) %>%\n  select(3:9) %>% \n  kable(digits = 2,align = \"c\",\"html\")\n```\n\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> estimate </th>\n   <th style=\"text-align:center;\"> std.error </th>\n   <th style=\"text-align:center;\"> statistic </th>\n   <th style=\"text-align:center;\"> p.value </th>\n   <th style=\"text-align:center;\"> s.value </th>\n   <th style=\"text-align:center;\"> conf.low </th>\n   <th style=\"text-align:center;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 25.46 </td>\n   <td style=\"text-align:center;\"> 4.21 </td>\n   <td style=\"text-align:center;\"> 6.04 </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 29.3 </td>\n   <td style=\"text-align:center;\"> 17.2 </td>\n   <td style=\"text-align:center;\"> 33.72 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n\n\n## Diagn√≥stico: Supuestos\n\nDeterminar si el modelo representa adecuadamente a los datos.\n\n-   Supuestos b√°sicos (acr√≥nimo **LINE**):\n\n-   **L de Linealidad**: Los valores de (Y) se pueden expresar como una funci√≥n lineal de la variable (X).\n\n-   **I de Independencia**:Los valores de (Y) (o los errores/residuos) son independientes entre s√≠.\n\n-   **N de Normalidad**:Para cualquier valor fijo de (X), los valores de (Y) (o los errores/residuos) se distribuyen normalmente.\n\n-   **E de Equitatividad (Homoscedasticidad)**: La variaci√≥n de los valores de (Y) (o los errores/residuos) alrededor de la l√≠nea de regresi√≥n es constante.\n\n## Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n::::: columns\n::: {.column width=\"50%\"}\n![](d1.png){width=\"500\"}\n:::\n\n::: {.column width=\"50%\"}\n![](d11.png){width=\"500\"}\n:::\n:::::\n\nLinealidad y homocedasticidad: sin patrones Causas: modelo no lineal, falta de variables explicativas, interacci√≥n.\n\n## Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n::::: columns\n::: {.column width=\"50%\"}\n![](d2.png){width=\"500\"}\n:::\n\n::: {.column width=\"50%\"}\n![](d22.png){width=\"500\"}\n:::\n:::::\n\nFalta de Normalidad: Otro modelos lineales generalizados\n\n## Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n::::: columns\n::: {.column width=\"50%\"}\n![](d3.png){width=\"500\"}\n:::\n\n::: {.column width=\"50%\"}\n![](d33.png){width=\"500\"}\n:::\n:::::\n\nHomogeneidad de la varianza: Transformaciones\n\n## Diagnostico con graficos (Verificaci√≥n de supuestos)\n\n::::: columns\n::: {.column width=\"50%\"}\n![](d4.png){width=\"500\"}\n:::\n\n::: {.column width=\"50%\"}\n![](d44.png){width=\"500\"}\n:::\n:::::\n\nIdentificar valores inusuales e influyentes: Transformaciones.\n\n## Modelo de regresi√≥n lineal simple con una covariable/predictor categorico\n\n$$E(Y \\mid X) = \\beta_0 + \\beta_1 X$$\n\n$X$ = En el caso que sea binaria, el modelo asume codificaci√≥n ($1=$ Presencia, $0=$ Ausencia)\n\n$E(Y \\mid X) = \\beta_0 + \\beta_1 \\times (1)$ indicar√≠a el cambio en la variable dependiente ante la presencia de la condici√≥n que fue codificada como $1$.\n\n$E(Y \\mid X) = \\beta_0 + \\beta_1 \\times (0)$\n\n$E(Y \\mid X) = \\beta_0$ indicar√≠a el cambio en la variable dependiente ante la ausencia de la condici√≥n que fue codificada como $0$\n\n## Modelo lineal con covariable categorica\n\n\n\n\n```{.r .cell-code}\nmodelo_cat <- lm(formula = chol ~ cad, coronary)\n```\n\n\n\n![](rsl2.png){width=\"150\"}\n\n## modelo Estimado\n\n$$E(Y \\mid X) = 109.855 + 9.9 \\times cad$$\n\nDonde $cad = 0,1$\n\n$\\beta_1$ es el cambio o diferencia promedio que hay en los niveles de colesterol entre pacientes con y sin enfermedad cardiovascular.\n\n-   Realicemos predicci√≥n de la media de colesterol para pacientes con enfermedad\n-   Realicemos predicci√≥n de la media de colesterol para pacientes sin enfermedad\n\n## Variable categorica politomica\n\n-   Se debe representar cada categoria de la variable en el modelo, dejando como 1 la presencial de la categoria y 0 las demas (variable dummy)\n\n| $X=$ Malayo | $X=$ Chino | $X =$ Hindu |\n|:-----------:|:----------:|:-----------:|\n|      1      |     0      |      0      |\n|      0      |     1      |      0      |\n|      0      |     0      |      1      |\n\n## modelo con variable categorica politomica\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_cat2 <- lm(formula = chol ~ race, coronary)\nsummary(modelo_cat2)\n```\n:::\n\n\n\n![](rsl3.png){width=\"150\"}\n\n# Gracias\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}